-- MySQL dump 10.13  Distrib 8.0.30, for Linux (x86_64)
--
-- Host: localhost    Database: mastercdn
-- ------------------------------------------------------
-- Server version	8.0.30

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!50503 SET NAMES utf8mb4 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Dumping data for table `admin_logs`
--

LOCK TABLES `admin_logs` WRITE;
/*!40000 ALTER TABLE `admin_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `admin_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `admin_menu_users`
--

LOCK TABLES `admin_menu_users` WRITE;
/*!40000 ALTER TABLE `admin_menu_users` DISABLE KEYS */;
/*!40000 ALTER TABLE `admin_menu_users` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `admin_messages`
--

LOCK TABLES `admin_messages` WRITE;
/*!40000 ALTER TABLE `admin_messages` DISABLE KEYS */;
/*!40000 ALTER TABLE `admin_messages` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `admin_users`
--

LOCK TABLES `admin_users` WRITE;
/*!40000 ALTER TABLE `admin_users` DISABLE KEYS */;
INSERT INTO `admin_users` VALUES (1,NOW(),NOW(),'admin',0,'$2y$10$xbH/SYBlJsMVS4Sb9mk9jObtgqmjwP0FM0LLRrI9Fl.7NkY3DB31e','','','admin@qq.com','','',1,'','47.236.118.19',NOW(),0,'',0);
/*!40000 ALTER TABLE `admin_users` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `agent_users`
--

LOCK TABLES `agent_users` WRITE;
/*!40000 ALTER TABLE `agent_users` DISABLE KEYS */;
/*!40000 ALTER TABLE `agent_users` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `announcement_reads`
--

LOCK TABLES `announcement_reads` WRITE;
/*!40000 ALTER TABLE `announcement_reads` DISABLE KEYS */;
/*!40000 ALTER TABLE `announcement_reads` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `announcements`
--

LOCK TABLES `announcements` WRITE;
/*!40000 ALTER TABLE `announcements` DISABLE KEYS */;
/*!40000 ALTER TABLE `announcements` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `cache_clear_logs`
--

LOCK TABLES `cache_clear_logs` WRITE;
/*!40000 ALTER TABLE `cache_clear_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `cache_clear_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `cache_clears`
--

LOCK TABLES `cache_clears` WRITE;
/*!40000 ALTER TABLE `cache_clears` DISABLE KEYS */;
/*!40000 ALTER TABLE `cache_clears` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `cache_do_logs`
--

LOCK TABLES `cache_do_logs` WRITE;
/*!40000 ALTER TABLE `cache_do_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `cache_do_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `caches`
--

LOCK TABLES `caches` WRITE;
/*!40000 ALTER TABLE `caches` DISABLE KEYS */;
/*!40000 ALTER TABLE `caches` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `client_configs`
--

LOCK TABLES `client_configs` WRITE;
/*!40000 ALTER TABLE `client_configs` DISABLE KEYS */;
INSERT INTO `client_configs`
(`create_time`, `update_time`, `config_key`, `remark`, `config_value`)
VALUES 
(NOW(),NOW(),'aliyun_oss','','rN/DGoCvVq5+8JN3SKz//y+TccyLv50Vzb2wa/+wEcEH75VbZ4EiT4dH0ckSEPOwp5ckqop5YhL5DYVXJx9s+q9ZkyZJDIgfTQwqhxaGdjpoWqJ22c4g681tyM2ktct9'),
(NOW(),NOW(),'sun_agency','','KcvI2j28c8BXlIJ6fAFblhRAsHuGhN+NLOLTVtdHc0gatgjpmNanIv5Q1vYlQ1PV'),
(NOW(),NOW(),'tawl.to','','YO9AnnGZZQbNHYmJ4TXk/9kDa2XyKyEr6oOQn7O840pIpJHk53u/I07WOFPoo1lO'),
(NOW(),NOW(),'ali_verify','','cuzfuw72YTksWmGpH0B1FZrQ/2hzZ6MkTiGt7SjUAhWbniiyW8ooaYYvWEFbbWk1FcYqKGmbIiV4R8bm4UL5rZYZeJNDQeNR7VuG1nDKNKbSeg0eL5F0vGowuw8MYMHh'),
(NOW(),NOW(),'google_recaptcha_verify','','Iediz6ULuOEM/ip0mBl7c2S3k1ZuaI8FGNIOlKGGWU5iz90Ey6sBj4mQWjigilCbkBSG7++XssnFljjyTW9N1g=='),
(NOW(),NOW(),'ajcaptcha_verify','','SnhO3uBDgq/lMkuajk59QAdRphDEG5xd0B5VruzAAMU='),
(NOW(),NOW(),'third_pay_account','','4nKFiM9fEStM1FSuibvZ9k1u9xl6NPwRnQb5UG9V7sKboAiPW6YltRmhBhIJcmaR7dGhUjvJHpsT5IZrz0h2hhrQOiCyx5kka/Z5qclwn3grGuLsv1if9YiEqrdPHTRTUvh9nHbpmU13LKt8kbksgA=='),
(NOW(),NOW(),'email','','c0EMzPkZUr1I99qh0YSaUVbFhssH8TYvpEJBryB3ig1zri+jZpuKW+lw1sOYn3UeAevlB3tpIaKLEuNRmdF+MENVMDQWSLxJkarbqroSmaHWkBRTnfbqL95SIOYvmsFeNNHz/UEZ2BaTEgqJJ4zvlZjr8sz+U46xRgqwaRUXkAfOoQzbLeOvKjQ+NBKirbMabcpAOb08ZOlABLvuCN2vFQ=='),
(NOW(),NOW(),'man_machine','','C28jxa1tEMjUNp9qyV8VeB2UH6PB+muAE4U7V3uUzcQ1jm5MauwVXNwukX2OHecjeMRc9yESHqNtHz0kDM2q5EelgJZmcK1LHLn+XpF78D7dNAh6xSmj2ZWCY88pf3Ef20ucLZ1BjEO0B6z2/BK3wciZU1XBBrXd/oWNw3+Mmo3j3TGZwLpq/iZfYng2gipUbSe3QBoPvX8ReSg6ab8YpNFZJNicFdub9BGF/Wl14u0='),
(NOW(),NOW(),'basic','','b7PycySTNDwqkvdceuh5YuzW27NELU8pNESRBJgUsoukfsyELuv/XJaJTabJo8FW7reuSOwi7znVmqAQriH3aIPyk0qeso9kmbKer6XylBu6ANe9ee0U9pP4JkI1sGt9NrLj1FNtcKG7/rZlAXJco9B5F0qf5MOm+Im/qQdKlSb0gVFbe8RJc5GOSF84Du9ixGY/Se/p06xRDZhOlAVtiBb2HP+cidKI8iFKk0PqvzKujT2E3R977S97Kg4QFlPolz6hvSqAePxHl9hioBjBHdkyOtnxV0AM+7u/hvWWY9B6O1HMWl3DgG9lrPi7XNjLpKQ5czzWt++MFRh/RwTqgXX7GyxkVlMOaUTxW4lvO3zNO0qeIpIQNr2VhjRoyi3LqiT6N4P3ohZtO9wq0/JxcTdFYGQGDJGL1RUvFxnGChmRj3raVgXSrsNzjzd9CTflhrS5HieZ3n/0BaxmDP/ln3myBdYLRDK7EwKcJ8wdaIsWR1r5yRYO4/YqhNU88s1m9E+DdLYf0oua41FDCTi3DLSFrgZ62R/8x8Z4Fq/O9qwYBHHPy+PeWCq3y36teX4f0MxIHTPXpxPCgiC4woc1aZXeQlssZUESwdHUBNHxlcUTyKXS+oo4BLX94U4SE+pAhKHP/7P/Z1+DOgjWXgZmfOPtyrWbEBhdXvMJvFWxxYiIpkmTi30dtiP61/97b78qeEQJH9nC0qISJ4eZf6qoSYz2ZWsjv14g9phx+uQN6Hh+R7oCRmHVqki0ziftd0K71zovCYnO1fky1fHDbr8gpAyRaNCbQF2ehO8juIqhpeseVXBngCLBR4vCoGN/1S4egppeV3JTkA7w3yDSoRDyW0pjxds/Iu637qNQKUENXs0O1GiFlqUYYXY5k/ZPmKKino9CHbgsaqeqyKrV9XDE85PgUtyqu6vKt8YXXiDq7DPMMCQoZMU57JjB8KN9ZfFa23w/5CTKHUQiCNCo8uAxOfPy9UbfzNG8rz9psf+fht+7qP0KF+yRkzE8+Cw0gKTopwt87ttuYlBMq67oLQCaA+Ga2v4UobhnnK1ya00VfMcjEmFk6f0tN+0hYpPHKjRIPmE0RIIjCpzkIAIcN3MvOA=='),
(NOW(),NOW(),'alipay','pay','/w60UuUe8HAy6rcAWgZFnK46JFO7ORTbsVdpXqo6CDGKvcr96QnMMsQZl8uzjaPrWD8ALQ1xgLFtblQfE3eAu6x29NNuEttxkKSpPkiuYPDCf87UDNY/kyPEgMxdVeJ83yoOJNZ93YheYDSY9F9Hms5WWG0VNZ9sK5/3XGNOa3k='),
(NOW(),NOW(),'weixinpay','','/w60UuUe8HAy6rcAWgZFnJqbQDrCNfJXVwOhp2XojVmp+10iJwCplJPkY1aHPT+mF8h+tJKVgWDFiWjbr+f1JUn4pxFXr7J/nK1WyaR2a6Cp+7OldF7cDgzF8kG1hxZ6oCBUb+J4COR1IylpMANZiQ=='),
(NOW(),NOW(),'deduct_set','',''),
(NOW(),NOW(),'paypal','pay','un+1IpdJ1815mqcpNyzaQs998hySeaHZjLkXGd2WypYR+ZNyhSK+uFQmZ6FHVq9c'),
(NOW(),NOW(),'dns','','l7cxWnfC0YWAke2htSHcR2/GQZejRrTbMzfORPDG/8DUNUiYo1Pl+n9lTCNLjjiezKb6yXV4GICSmILNRoO2SBHIx2VdVrKxV9Qpiz43HZscVdDaotv9W7D+BGfuF/V3GwjKE/7WTjKkQdgewa325tnG3U+oOoGvAxtpXnAo9cM9nEmAUDzXmi0fRYp9unA1ongvHO6hduCg/HCp4HQCuP5iTzJhq9lDkpyEIMKrzy0='),
(NOW(),NOW(),'monitoring_key','','tFFqHmjgslRhmFq8bva1B4+pqo79JgUWBeygp3WwemYWxVcNj4ElOBkBxv8SGNlI'),
(NOW(),NOW(),'baiduAnalytics','','YuM1aoX45svmz+P140FanloSWhAW/G0oJak54zYk5xM='),
(NOW(),NOW(),'googleAnalytics','','YuM1aoX45svmz+P140FanloSWhAW/G0oJak54zYk5xM='),
(NOW(),NOW(),'aliyun_sms','','rN/DGoCvVq5+8JN3SKz//y+TccyLv50Vzb2wa/+wEcEoqPZK2HqzAc8RrnniU9530tQTmAvSzrOJTNLmgaptxk/JXjdVTDF90cD75KVnbj5p+NO6kuGghKsi/rY6wdyu5iLlC/5kwrTGOCXjp9vV7v8qijgFMp7qMFJ7EaHkElg='),
(NOW(),NOW(),'ip_library','','TSmKMQXNkqW50o+YCo15mYEsv7Jmi7hWUI9FZ09X7AQ='),
(NOW(),NOW(),'usdt_pay','','+xdSLMygoBkPcawqFJJrKD7DuovOEBWQj52bbaYX35Z2QXAAfG9C2iP81A+XYlJSDTRCD+GnFiidUZslVnqiqcK2FiG/F5YUdyqhujadncKn58x0aMOGenXV0+TtEepchBJNzAxzxgSxMDqnA79yVA=='),
(NOW(),NOW(),'proxy_iproyal','proxy','6XrtOVp7Lx3nnrFUVftlwKKOJdwf+TkUxEnRIpkYqD4+tFEoS9qclK9zii8/HyNlyHYVXOzr18CkFlDP9LICvTFPCIU4LU4ZOiUHKXST+k8zVqNDaNr4kEsSuoJJaNvP'),
(NOW(),NOW(),'proxy_taiyang','proxy','6XrtOVp7Lx3nnrFUVftlwIL0s+b3WuA70ymX9GMlBEExl783iLnIbyj78TCITN8RyPin3gAaMu3EXHr4OE+bddKxRM7r0MG9oD143K3Un8x9gFbsVyMzaBSowSnCUQLPOcT/5lGhDNzvqkiDpdN9NQ=='),
(NOW(),NOW(),'proxy_netnut','proxy','6XrtOVp7Lx3nnrFUVftlwIL0s+b3WuA70ymX9GMlBEGL/rOgPAuNLlVVGUH7FwA+1uIUqSQNcASufwGSjGKw2Q=='),
(NOW(),NOW(),'proxy_ipidea','proxy','6XrtOVp7Lx3nnrFUVftlwIL0s+b3WuA70ymX9GMlBEEewYS1tvICn8yzYLlKQwDQuG7ScaCzFxiAeS3hAa0i8CBPZL2jjluv/znKbk1d4aU/XpFf73p4X9WHsOmKDXKJzyfxIoxOHcIwEYHqkrXEXw=='),
(NOW(),NOW(),'proxy_aliboce','proxy','6XrtOVp7Lx3nnrFUVftlwIL0s+b3WuA70ymX9GMlBEE/z4/AMl2zIpTIr2NvtE6J'),
(NOW(),NOW(),'ddos','','uTnEJ8I8qm0AGGbNtxdYe3ddrkSZPuMtnCZ3xTVITjj8bfq6utmmfc4oVxpXOvMjbg+OaSTKCOIlUMZmAFBqFeZmpBP3gVQfZJ9lY83spZ9snX+EmPH0rSR8rq+Cf+gFUlDyg6vtTTMyy2QHc33AwtCwqqfXEypjaaWLQfzQ2vqvS50SOjIa1R5MLPSz3hbdDIobKk8wC97gNHWTiNZuarsCxPWStYJVWq/1kWgk4UY='),
(NOW(),NOW(),'repatriate','','vSqaIafNQu8iYFKgNXBiJ/JriJ8S7BuJCv9oDuNB9mjWglRclbyVtHwCyfcwIm8sLEJHnzCqnBbjB/S+UNy0HiOKQ0jR0mnENcIlywMmEdewMU5mVVgHhDq1yMgGTpDFAYBoIcoNLTyvNvzhpVepCFZ0YLM08BdJ45s80YimLNo='),
(NOW(),NOW(),'waf_node_alarm','','Zbi/Ta0W673R7hbotyD/vRcp9A2kTQMptQBeJAWkp/j+8Yh0MQ3pa+cyrDWsJ22MX7o8c6F5/M0YIjPXh5H9aOUnJ76PnpWSp2s0PbIMrRY='),
(NOW(),NOW(),'waf_malicious_traffic_email','','atmDBhAgoDKZC2MXjZXn4YPpDgDAU8VP2Obr72PUEJg='),
(NOW(),NOW(),'waf_domain_remote_authorizations','','qVZeTF0uai9euKbVhx5CUQ=='),
(NOW(),NOW(),'waf_node_cache_config','','S3Gpw7BX7v80GT071GqDLcbqR2GRNwz2ybaup0QXQXmprdiq9BqIlgRY4v2ficNwwT5ppAOiSBF1KB/0uplebIC+1qxoam0x6tuzZWSzxoRRkW4ed9yfstW7L8wMj35dli43TTBDfa71LYtDg5c+m5tspDQX47nRzm3GGT7V0mM7S/mtQdj51Ox6scfb0rzAiYMwARN8B0X56H0HztUaGUs/X4+9/FDwltkYpY+Pv3iiWJR6fs7FyrDfrpSf7mh8rNdAboxRTMi0M+0m52K4ZDnBTaOkjaNoDPycg5xdWh+qSrqCkrjr60LwAakWNLpsx7PnVW/JW/z44/RWCYmBUSWS+4tbDITTEMiYcLKpAUduKsjlmd7jnRPm71rhx+H4u4mIzQhHZ98D1qzMnDtgBezoeH2citLGDgxgB/aEQnQS5sd8dHIdiOF0Tf4iCVx9O6AAbFRqyj+s+a1c2PYVbGG94JwD0jWniO+vQO5zKZc9D+MhOP35ALzaOtITbZiuPyEnfyCtPVkpPuxoi8+iolJBKhQpYEu0QVI3Gfsl40fXK82kCxHfOoQ8JcPdG5rPRl31AvWLTJ4dNe0L4kWGrBDCKkjZLNOEunAzColkDBVcyUKgMC9Xauyw0xpufsW+'),
(NOW(),NOW(),'auto_cc_switch','','EtGWLlx+wLHbofUpNBfK/yCmzSFpeJ9tGxUEg8YSdaObiNtMH+vLYQOopwwPJLYJIAdc/nRh7jZUKqCU7HnzoIbDQ4f1k0MdHdWsGxogBus='),
(NOW(),NOW(),'telegram','','3Ylt6g8w8qlqvWJUnTKw0wCDZ7QAqSJf4SexefFdFSEznOUoVOjjjtP83JsFdebKON7iyiNdekNqc0VpJjY8sg=='),
(NOW(),NOW(),'cache','',''),
(NOW(),NOW(),'certificate','',''),
(NOW(),NOW(),'stripe_pay','','qlE186c9rP2jZl6OZBAVfqL+D/uRwrwUQmlqAxbveJJItjzL/SxnFequQI+ls1PNruUt6KhARiUwjTLr2FmjAND+vyGfmTNuUI+w2NtuIjE='),
(NOW(),NOW(),'domain','','/bCIQ4H02UpSNNc1vjnV2GbGeyH0o6qQlB91c3HrWC/IQzRLIk8bP8TojeGXnd24');
/*!40000 ALTER TABLE `client_configs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `contacts`
--

LOCK TABLES `contacts` WRITE;
/*!40000 ALTER TABLE `contacts` DISABLE KEYS */;
/*!40000 ALTER TABLE `contacts` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `dns_set_logs`
--

LOCK TABLES `dns_set_logs` WRITE;
/*!40000 ALTER TABLE `dns_set_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `dns_set_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `domain_details`
--

LOCK TABLES `domain_details` WRITE;
/*!40000 ALTER TABLE `domain_details` DISABLE KEYS */;
/*!40000 ALTER TABLE `domain_details` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `domain_group_advances`
--

LOCK TABLES `domain_group_advances` WRITE;
/*!40000 ALTER TABLE `domain_group_advances` DISABLE KEYS */;
/*!40000 ALTER TABLE `domain_group_advances` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `domain_group_list_certs`
--

LOCK TABLES `domain_group_list_certs` WRITE;
/*!40000 ALTER TABLE `domain_group_list_certs` DISABLE KEYS */;
/*!40000 ALTER TABLE `domain_group_list_certs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `domain_group_listen_ports`
--

LOCK TABLES `domain_group_listen_ports` WRITE;
/*!40000 ALTER TABLE `domain_group_listen_ports` DISABLE KEYS */;
/*!40000 ALTER TABLE `domain_group_listen_ports` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `domain_group_lists`
--

LOCK TABLES `domain_group_lists` WRITE;
/*!40000 ALTER TABLE `domain_group_lists` DISABLE KEYS */;
/*!40000 ALTER TABLE `domain_group_lists` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `domain_group_logs`
--

LOCK TABLES `domain_group_logs` WRITE;
/*!40000 ALTER TABLE `domain_group_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `domain_group_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `domain_group_node_port2s`
--

LOCK TABLES `domain_group_node_port2s` WRITE;
/*!40000 ALTER TABLE `domain_group_node_port2s` DISABLE KEYS */;
/*!40000 ALTER TABLE `domain_group_node_port2s` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `domain_group_node_ports`
--

LOCK TABLES `domain_group_node_ports` WRITE;
/*!40000 ALTER TABLE `domain_group_node_ports` DISABLE KEYS */;
/*!40000 ALTER TABLE `domain_group_node_ports` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `domain_group_urls`
--

LOCK TABLES `domain_group_urls` WRITE;
/*!40000 ALTER TABLE `domain_group_urls` DISABLE KEYS */;
/*!40000 ALTER TABLE `domain_group_urls` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `domain_groups`
--

LOCK TABLES `domain_groups` WRITE;
/*!40000 ALTER TABLE `domain_groups` DISABLE KEYS */;
INSERT INTO `domain_groups` 
(`domain_group_id`, `user_id`, `agent_user_id`, `cname`, `dns`, `name`, `group_id`, `status`, `type`, `user_power_traffics_id`, `has_cdn`, `config_status`, `traffic_arr`, `use_dns`, `user_dns_api_id`, `port_type`, `created_time`, `updated_time`, `weight_enabled`)
VALUES
(1,0,0,'','','未分组','',0,0,0,1,0,'null','0',0,0,NOW(),NOW(),0);
/*!40000 ALTER TABLE `domain_groups` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `domain_node_dns`
--

LOCK TABLES `domain_node_dns` WRITE;
/*!40000 ALTER TABLE `domain_node_dns` DISABLE KEYS */;
/*!40000 ALTER TABLE `domain_node_dns` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `domain_node_to_dns`
--

LOCK TABLES `domain_node_to_dns` WRITE;
/*!40000 ALTER TABLE `domain_node_to_dns` DISABLE KEYS */;
/*!40000 ALTER TABLE `domain_node_to_dns` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `domains`
--

LOCK TABLES `domains` WRITE;
/*!40000 ALTER TABLE `domains` DISABLE KEYS */;
/*!40000 ALTER TABLE `domains` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `groups`
--

LOCK TABLES `groups` WRITE;
/*!40000 ALTER TABLE `groups` DISABLE KEYS */;
INSERT INTO `groups` VALUES (1,'2022-07-22 10:16:05','2022-07-22 10:16:05','系统消息','System message',2),(2,'2022-07-22 10:16:05','2022-07-30 17:37:06','基础CDN','Basic CDN',0),(3,'2022-07-22 10:16:05','2022-07-30 17:37:15','全球CDN','Global CDN',0),(4,'2022-07-22 10:16:05','2022-07-30 17:37:28','区域性CDN','Regional CDN',0),(5,'2022-07-22 10:16:05','2022-07-30 17:37:36','中国大陆CDN','In-China CDN',0),(6,'2022-07-22 10:16:05','2022-07-30 17:37:49','环中国CDN','Near-China CDN',0),(7,'2022-07-22 10:16:05','2022-07-30 17:38:46','自定义CDN','Custom CDN',0),(8,'2022-07-22 10:16:05','2022-07-30 17:38:56','技术支持','Support Package',0),(10,'2022-07-22 10:16:05','2022-07-22 10:16:05','自有证书','Own certificate',1),(11,'2023-04-25 16:12:57','2023-04-25 16:13:01','免费证书','free certificate',1),(16,'2022-09-26 14:48:53','2022-09-26 14:48:58','公告','Announcement',2),(17,'2023-12-18 15:54:16','2023-12-18 15:54:19','管理员通知','Administrator notification',2);
/*!40000 ALTER TABLE `groups` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `log_operations`
--

LOCK TABLES `log_operations` WRITE;
/*!40000 ALTER TABLE `log_operations` DISABLE KEYS */;
/*!40000 ALTER TABLE `log_operations` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `messages`
--

LOCK TABLES `messages` WRITE;
/*!40000 ALTER TABLE `messages` DISABLE KEYS */;
/*!40000 ALTER TABLE `messages` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `order_offline_pay_logs`
--

LOCK TABLES `order_offline_pay_logs` WRITE;
/*!40000 ALTER TABLE `order_offline_pay_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `order_offline_pay_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `order_price_logs`
--

LOCK TABLES `order_price_logs` WRITE;
/*!40000 ALTER TABLE `order_price_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `order_price_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `order_refund_logs`
--

LOCK TABLES `order_refund_logs` WRITE;
/*!40000 ALTER TABLE `order_refund_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `order_refund_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `orders`
--

LOCK TABLES `orders` WRITE;
/*!40000 ALTER TABLE `orders` DISABLE KEYS */;
/*!40000 ALTER TABLE `orders` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `partner_dns`
--

LOCK TABLES `partner_dns` WRITE;
/*!40000 ALTER TABLE `partner_dns` DISABLE KEYS */;
/*!40000 ALTER TABLE `partner_dns` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `partner_dns_domains`
--

LOCK TABLES `partner_dns_domains` WRITE;
/*!40000 ALTER TABLE `partner_dns_domains` DISABLE KEYS */;
/*!40000 ALTER TABLE `partner_dns_domains` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `pay_configs`
--

LOCK TABLES `pay_configs` WRITE;
/*!40000 ALTER TABLE `pay_configs` DISABLE KEYS */;
INSERT INTO `pay_configs` VALUES 
(1,NOW(),NOW(),'余额','balance','',1,'balance',0,0,''),
(2,NOW(),NOW(),'支付宝','Alipay','public/images/ali.png',0,'alipay',0,3,'AliPayEasy'),
(3,NOW(),NOW(),'线下付款','Offline payment','',0,'offline_payment',0,0,'offlinePayment'),
(4,NOW(),NOW(),'paypal','paypal','public/images/paypal.svg',0,'paypal',0,2,'PaypalApi'),
(5,NOW(),NOW(),'USDT','USDT','public/images/usdt.png',0,'usdt_pay',0,1,'HuoBiApi'),
(6,NOW(),NOW(),'Stripe','Stripe','public/images/stripe.png',0,'stripe_pay',1,2,'Stripe');
/*!40000 ALTER TABLE `pay_configs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `payment_intents`
--

LOCK TABLES `payment_intents` WRITE;
/*!40000 ALTER TABLE `payment_intents` DISABLE KEYS */;
/*!40000 ALTER TABLE `payment_intents` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `prom_traffic_flows`
--

LOCK TABLES `prom_traffic_flows` WRITE;
/*!40000 ALTER TABLE `prom_traffic_flows` DISABLE KEYS */;
/*!40000 ALTER TABLE `prom_traffic_flows` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `traffic_product_agents`
--

LOCK TABLES `traffic_product_agents` WRITE;
/*!40000 ALTER TABLE `traffic_product_agents` DISABLE KEYS */;
/*!40000 ALTER TABLE `traffic_product_agents` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `traffic_product_area_prices`
--

LOCK TABLES `traffic_product_area_prices` WRITE;
/*!40000 ALTER TABLE `traffic_product_area_prices` DISABLE KEYS */;
/*!40000 ALTER TABLE `traffic_product_area_prices` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `traffic_product_dns_domains`
--

LOCK TABLES `traffic_product_dns_domains` WRITE;
/*!40000 ALTER TABLE `traffic_product_dns_domains` DISABLE KEYS */;
/*!40000 ALTER TABLE `traffic_product_dns_domains` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `traffic_product_node_groups`
--

LOCK TABLES `traffic_product_node_groups` WRITE;
/*!40000 ALTER TABLE `traffic_product_node_groups` DISABLE KEYS */;
/*!40000 ALTER TABLE `traffic_product_node_groups` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `traffic_product_terms`
--

LOCK TABLES `traffic_product_terms` WRITE;
/*!40000 ALTER TABLE `traffic_product_terms` DISABLE KEYS */;
/*!40000 ALTER TABLE `traffic_product_terms` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `traffic_product_vips`
--

LOCK TABLES `traffic_product_vips` WRITE;
/*!40000 ALTER TABLE `traffic_product_vips` DISABLE KEYS */;
/*!40000 ALTER TABLE `traffic_product_vips` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `traffic_product_volumes`
--

LOCK TABLES `traffic_product_volumes` WRITE;
/*!40000 ALTER TABLE `traffic_product_volumes` DISABLE KEYS */;
/*!40000 ALTER TABLE `traffic_product_volumes` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `traffic_products`
--

LOCK TABLES `traffic_products` WRITE;
/*!40000 ALTER TABLE `traffic_products` DISABLE KEYS */;
/*!40000 ALTER TABLE `traffic_products` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `traffic_terms`
--

LOCK TABLES `traffic_terms` WRITE;
/*!40000 ALTER TABLE `traffic_terms` DISABLE KEYS */;
INSERT INTO `traffic_terms` VALUES (1,'7天','7 Day',0,7,0),(2,'6个月','6 Month',0,6,1),(3,'1年','1 Year',0,1,2),(4,'1天','1 Day',0,1,0),(5,'1月','1 Month',0,1,1),(6,'2年','2 Year',0,2,2),(7,'8天','8 Day',0,8,0),(8,'10天','10 Day',0,10,0),(9,'300天','300 Day',0,300,0);
/*!40000 ALTER TABLE `traffic_terms` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `traffic_volumes`
--

LOCK TABLES `traffic_volumes` WRITE;
/*!40000 ALTER TABLE `traffic_volumes` DISABLE KEYS */;
INSERT INTO `traffic_volumes` VALUES (1,'10GB',10,0,0),(2,'100GB',100,0,0),(3,'500GB',500,0,0),(4,'1TB',1000,0,0),(5,'5TB',5000,0,0),(6,'10TB',10000,0,0),(7,'50TB',50000,0,0),(8,'200TB',200000,0,0),(9,'1GB',1,0,0),(10,'7TB',7000,0,1),(11,'20TB',20000,0,1),(12,'3TB',3000,0,1),(13,'8TB',8000,0,1),(14,'1PB',1000000,0,1);
/*!40000 ALTER TABLE `traffic_volumes` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_certificates`
--

LOCK TABLES `user_certificates` WRITE;
/*!40000 ALTER TABLE `user_certificates` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_certificates` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_invoices`
--

LOCK TABLES `user_invoices` WRITE;
/*!40000 ALTER TABLE `user_invoices` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_invoices` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_levels`
--

LOCK TABLES `user_levels` WRITE;
/*!40000 ALTER TABLE `user_levels` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_levels` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_message_configs`
--

LOCK TABLES `user_message_configs` WRITE;
/*!40000 ALTER TABLE `user_message_configs` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_message_configs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_porfile_logs`
--

LOCK TABLES `user_porfile_logs` WRITE;
/*!40000 ALTER TABLE `user_porfile_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_porfile_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_porfiles`
--

LOCK TABLES `user_porfiles` WRITE;
/*!40000 ALTER TABLE `user_porfiles` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_porfiles` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_power_traffic_additionals`
--

LOCK TABLES `user_power_traffic_additionals` WRITE;
/*!40000 ALTER TABLE `user_power_traffic_additionals` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_power_traffic_additionals` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_power_traffic_count_logs`
--

LOCK TABLES `user_power_traffic_count_logs` WRITE;
/*!40000 ALTER TABLE `user_power_traffic_count_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_power_traffic_count_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_power_traffic_logs`
--

LOCK TABLES `user_power_traffic_logs` WRITE;
/*!40000 ALTER TABLE `user_power_traffic_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_power_traffic_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_power_traffic_message_logs`
--

LOCK TABLES `user_power_traffic_message_logs` WRITE;
/*!40000 ALTER TABLE `user_power_traffic_message_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_power_traffic_message_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_power_traffic_periods`
--

LOCK TABLES `user_power_traffic_periods` WRITE;
/*!40000 ALTER TABLE `user_power_traffic_periods` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_power_traffic_periods` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_power_traffics`
--

LOCK TABLES `user_power_traffics` WRITE;
/*!40000 ALTER TABLE `user_power_traffics` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_power_traffics` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_recharge_records`
--

LOCK TABLES `user_recharge_records` WRITE;
/*!40000 ALTER TABLE `user_recharge_records` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_recharge_records` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `user_waf_ids`
--

LOCK TABLES `user_waf_ids` WRITE;
/*!40000 ALTER TABLE `user_waf_ids` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_waf_ids` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `users`
--

LOCK TABLES `users` WRITE;
/*!40000 ALTER TABLE `users` DISABLE KEYS */;
/*!40000 ALTER TABLE `users` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_apks`
--

LOCK TABLES `waf_apks` WRITE;
/*!40000 ALTER TABLE `waf_apks` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_apks` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_apps`
--

LOCK TABLES `waf_apps` WRITE;
/*!40000 ALTER TABLE `waf_apps` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_apps` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_area_regions`
--

LOCK TABLES `waf_area_regions` WRITE;
/*!40000 ALTER TABLE `waf_area_regions` DISABLE KEYS */;
INSERT INTO `waf_area_regions` VALUES (1,237),(1,236),(1,108),(1,230),(1,105),(1,106),(1,82),(1,98),(1,107),(1,231),(1,114),(1,111),(1,113),(1,232),(1,228),(1,102),(1,109),(1,233),(1,110),(1,235),(1,241),(1,234),(1,112),(1,104),(2,70),(2,99),(2,76),(2,4),(2,11),(2,25),(2,5),(2,7),(2,22),(2,71),(2,85),(2,10),(2,78),(2,77),(2,67),(2,26),(2,103),(2,68),(2,66),(2,74),(2,244),(2,65),(2,23),(2,91),(2,69),(2,97),(2,95),(2,96),(2,93),(2,38),(2,6),(2,84),(2,20),(2,18),(2,75),(2,86),(2,88),(2,101),(2,83),(2,35),(2,64),(2,21),(2,24),(2,94),(2,72),(2,89),(2,19),(3,212),(3,242),(3,214),(3,192),(3,217),(3,201),(3,198),(3,208),(3,205),(3,183),(3,207),(3,227),(3,199),(3,191),(3,196),(3,200),(3,216),(3,194),(3,178),(3,221),(3,248),(3,211),(3,210),(3,184),(3,238),(3,215),(3,222),(3,190),(3,202),(3,209),(3,195),(3,243),(3,239),(3,204),(3,247),(3,213),(3,206),(3,203),(3,193),(4,146),(4,43),(4,100),(4,46),(4,172),(4,147),(4,160),(4,45),(4,155),(4,168),(4,245),(4,8),(4,42),(4,152),(4,159),(4,31),(4,154),(4,169),(4,34),(4,166),(4,165),(4,39),(4,157),(4,164),(4,170),(4,163),(4,167),(4,153),(4,158),(4,145),(4,48),(4,173),(4,161),(4,156),(4,33),(4,150),(4,149),(4,40),(4,133),(4,50),(4,36),(4,49),(4,41),(4,148),(4,73),(4,151),(4,119),(4,141),(4,47),(4,44),(4,162),(4,143),(4,171),(5,16),(5,15),(5,136),(5,179),(5,134),(5,127),(5,118),(5,13),(5,115),(5,120),(5,122),(5,130),(5,250),(5,60),(5,56),(5,2),(5,28),(5,14),(5,116),(5,132),(5,9),(5,29),(5,27),(5,117),(5,131),(5,17),(5,126),(5,174),(5,124),(5,137),(5,125),(5,32),(5,142),(5,58),(5,128),(5,57),(5,51),(5,59),(5,53),(5,121),(5,140),(5,3),(5,175),(5,12),(5,30),(5,62),(5,55),(5,129),(5,52),(5,123),(5,144),(5,54),(5,61),(5,63),(5,138),(6,186),(6,219),(6,220),(6,180),(6,218),(6,185),(6,187),(6,224),(6,181),(6,197),(6,225),(6,188),(6,226),(6,182),(6,223);
/*!40000 ALTER TABLE `waf_area_regions` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_areas`
--

LOCK TABLES `waf_areas` WRITE;
/*!40000 ALTER TABLE `waf_areas` DISABLE KEYS */;
INSERT INTO `waf_areas` VALUES (1,'大洋洲地区','Australia'),(2,'亚太地区(国内除外)','Asia Pacific (excluding Mainland China)'),(3,'北美洲','North America'),(4,'欧洲','Europe'),(5,'非洲','Africa'),(6,'拉丁美洲','Latin America');
/*!40000 ALTER TABLE `waf_areas` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_block_htmls`
--

LOCK TABLES `waf_block_htmls` WRITE;
/*!40000 ALTER TABLE `waf_block_htmls` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_block_htmls` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_blockade_cities`
--

LOCK TABLES `waf_blockade_cities` WRITE;
/*!40000 ALTER TABLE `waf_blockade_cities` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_blockade_cities` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_blockade_domains`
--

LOCK TABLES `waf_blockade_domains` WRITE;
/*!40000 ALTER TABLE `waf_blockade_domains` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_blockade_domains` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_blockades`
--

LOCK TABLES `waf_blockades` WRITE;
/*!40000 ALTER TABLE `waf_blockades` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_blockades` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_cc_filters`
--

LOCK TABLES `waf_cc_filters` WRITE;
/*!40000 ALTER TABLE `waf_cc_filters` DISABLE KEYS */;
INSERT INTO `waf_cc_filters` VALUES (23,0,'302跳转60-10','',2,60,10,0,1,1744426968,1744427183),(24,0,'5秒盾60-5','',1,60,5,0,1,1744426989,1744427167),(25,0,'JS验证60-10','',3,60,10,0,1,1744427234,1744427234),(26,0,'频率限制2-800','',0,2,800,300,1,1744427268,1744427268);
/*!40000 ALTER TABLE `waf_cc_filters` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_cc_matchers`
--

LOCK TABLES `waf_cc_matchers` WRITE;
/*!40000 ALTER TABLE `waf_cc_matchers` DISABLE KEYS */;
INSERT INTO `waf_cc_matchers` VALUES (12,0,'all','',1,'[{\"value\": [\".*\"], \"normal\": 1, \"symbol\": 7}]',1744427305,1744427305);
/*!40000 ALTER TABLE `waf_cc_matchers` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_cc_policies`
--

LOCK TABLES `waf_cc_policies` WRITE;
/*!40000 ALTER TABLE `waf_cc_policies` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_cc_policies` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_cc_policies_logs`
--

LOCK TABLES `waf_cc_policies_logs` WRITE;
/*!40000 ALTER TABLE `waf_cc_policies_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_cc_policies_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_cc_rule_group_users`
--

LOCK TABLES `waf_cc_rule_group_users` WRITE;
/*!40000 ALTER TABLE `waf_cc_rule_group_users` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_cc_rule_group_users` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_cc_rule_groups`
--

LOCK TABLES `waf_cc_rule_groups` WRITE;
/*!40000 ALTER TABLE `waf_cc_rule_groups` DISABLE KEYS */;
INSERT INTO `waf_cc_rule_groups` VALUES (28,0,'302跳转','',1,'1','0','1',1744427327,1744427327),(29,0,'5秒盾','',2,'1','0','1',1744427349,1744427349),(30,0,'JS验证','',3,'1','0','1',1744427368,1744427368),(31,0,'宽松','',4,'1','0','1',1744427392,1744427392);
/*!40000 ALTER TABLE `waf_cc_rule_groups` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_cc_rules`
--

LOCK TABLES `waf_cc_rules` WRITE;
/*!40000 ALTER TABLE `waf_cc_rules` DISABLE KEYS */;
INSERT INTO `waf_cc_rules` VALUES (103,28,12,23,0,0,'1',1800,1,2),(104,29,12,24,0,0,'1',1800,1,2),(105,30,12,25,0,0,'1',1800,1,2),(106,31,12,26,0,0,'1',1800,1,2);
/*!40000 ALTER TABLE `waf_cc_rules` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_cc_toggle_logs`
--

LOCK TABLES `waf_cc_toggle_logs` WRITE;
/*!40000 ALTER TABLE `waf_cc_toggle_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_cc_toggle_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_ip_blocks`
--

LOCK TABLES `waf_ip_blocks` WRITE;
/*!40000 ALTER TABLE `waf_ip_blocks` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_ip_blocks` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_ip_rule_ips`
--

LOCK TABLES `waf_ip_rule_ips` WRITE;
/*!40000 ALTER TABLE `waf_ip_rule_ips` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_ip_rule_ips` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_ip_rules`
--

LOCK TABLES `waf_ip_rules` WRITE;
/*!40000 ALTER TABLE `waf_ip_rules` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_ip_rules` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_ip_unseal_logs`
--

LOCK TABLES `waf_ip_unseal_logs` WRITE;
/*!40000 ALTER TABLE `waf_ip_unseal_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_ip_unseal_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_malicious_traffics`
--

LOCK TABLES `waf_malicious_traffics` WRITE;
/*!40000 ALTER TABLE `waf_malicious_traffics` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_malicious_traffics` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_node_certs`
--

LOCK TABLES `waf_node_certs` WRITE;
/*!40000 ALTER TABLE `waf_node_certs` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_node_certs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_node_groups`
--

LOCK TABLES `waf_node_groups` WRITE;
/*!40000 ALTER TABLE `waf_node_groups` DISABLE KEYS */;
INSERT INTO `waf_node_groups` VALUES (1,0,'空闲组',1,0,0);
/*!40000 ALTER TABLE `waf_node_groups` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_node_lines`
--

LOCK TABLES `waf_node_lines` WRITE;
/*!40000 ALTER TABLE `waf_node_lines` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_node_lines` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_node_logs`
--

LOCK TABLES `waf_node_logs` WRITE;
/*!40000 ALTER TABLE `waf_node_logs` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_node_logs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_node_monitor_to_childs`
--

LOCK TABLES `waf_node_monitor_to_childs` WRITE;
/*!40000 ALTER TABLE `waf_node_monitor_to_childs` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_node_monitor_to_childs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_node_toggles`
--

LOCK TABLES `waf_node_toggles` WRITE;
/*!40000 ALTER TABLE `waf_node_toggles` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_node_toggles` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_nodes`
--

LOCK TABLES `waf_nodes` WRITE;
/*!40000 ALTER TABLE `waf_nodes` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_nodes` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_rule_defaults`
--

LOCK TABLES `waf_rule_defaults` WRITE;
/*!40000 ALTER TABLE `waf_rule_defaults` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_rule_defaults` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_rule_ids`
--

LOCK TABLES `waf_rule_ids` WRITE;
/*!40000 ALTER TABLE `waf_rule_ids` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_rule_ids` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_rules`
--

LOCK TABLES `waf_rules` WRITE;
/*!40000 ALTER TABLE `waf_rules` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_rules` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_transmit_acls`
--

LOCK TABLES `waf_transmit_acls` WRITE;
/*!40000 ALTER TABLE `waf_transmit_acls` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_transmit_acls` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_transmit_node_ports`
--

LOCK TABLES `waf_transmit_node_ports` WRITE;
/*!40000 ALTER TABLE `waf_transmit_node_ports` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_transmit_node_ports` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_transmit_origins`
--

LOCK TABLES `waf_transmit_origins` WRITE;
/*!40000 ALTER TABLE `waf_transmit_origins` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_transmit_origins` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_transmit_ports`
--

LOCK TABLES `waf_transmit_ports` WRITE;
/*!40000 ALTER TABLE `waf_transmit_ports` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_transmit_ports` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `waf_transmits`
--

LOCK TABLES `waf_transmits` WRITE;
/*!40000 ALTER TABLE `waf_transmits` DISABLE KEYS */;
/*!40000 ALTER TABLE `waf_transmits` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping data for table `monitor_node_settings`
--

LOCK TABLES `monitor_node_settings` WRITE;
INSERT INTO `monitor_node_settings` (`frequency`, `timeout`, `alert_condition_node_count`, `alert_condition_continuous_count`, `alert_switch`, `task_switch`) VALUES 
(60, 5, 1, 3, 1, 1) ON DUPLICATE KEY UPDATE `id`=`id`;
UNLOCK TABLES;

--
-- Dumping data for table `waf_default_config`
--

LOCK TABLES `waf_default_config` WRITE;
INSERT INTO waf_default_config (`key`,value) VALUES
	 ('vuln_types','[{"id":1,"name":"None"},{"id":100,"name":"Sensitive Data Leakage"},{"id":200,"name":"SQL Injection"},{"id":210,"name":"Command Injection"},{"id":220,"name":"Code Injection"},{"id":230,"name":"LDAP Injection"},{"id":240,"name":"XPATH Injection"},{"id":300,"name":"Cross-site Scripting(XSS)"},{"id":400,"name":"Path Traversal"},{"id":410,"name":"Remote File Inclusion(RFI)"},{"id":420,"name":"Local File Inclusion(LFI)"},{"id":500,"name":"Web Shell"},{"id":510,"name":"Upload"},{"id":600,"name":"Crawler/Scanner"},{"id":700,"name":"Server-Side Request Forgery(SSRF)"},{"id":710,"name":"Client-Side Request Forgery(CSRF)"},{"id":800,"name":"Logic Vulnerability"},{"id":900,"name":"Open Source Vulnerability"},{"id":920,"name":"Broken Authentication"},{"id":930,"name":"Broken Access Control"},{"id":940,"name":"Misconfiguration"},{"id":950,"name":"Insecure Deserialization"},{"id":960,"name":"XML External Entity(XXE)"},{"id":999,"name":"Other"}]'),
	 ('config','{"sync_interval":30000000000,"search_engines_pattern":"(?i)(Google|Baidu|MicroMessenger|miniprogram|bing|sogou|Yisou|360spider|soso|duckduck|Yandex|Yahoo|AOL|teoma)","block_html":"<!DOCTYPE html>\\n\\t<html>\\n\\t<head>\\n\\t<title>403 Forbidden</title>\\n\\t</head>\\n\\t<style>\\n\\tbody {\\n\\t\\tfont-family: Arial, Helvetica, sans-serif;\\n\\t\\ttext-align: center;\\n\\t}\\n\\n\\t.text-logo {\\n\\t\\tdisplay: block;\\n\\t\\twidth: 260px;\\n\\t\\tfont-size: 48px;\\n\\t\\tbackground-color: #F9F9F9;\\n\\t\\tcolor: #f5f5f5;\\n\\t\\ttext-decoration: none;\\n\\t\\ttext-shadow: 2px 2px 4px #000000;\\n\\t\\tbox-shadow: 2px 2px 3px #D5D5D5;\\n\\t\\tpadding: 15px; \\n\\t\\tmargin: auto;\\n\\t}\\n\\n\\t.block_div {\\n\\t\\tpadding: 10px;\\n\\t\\twidth: 70%;\\n\\t\\tmargin: auto;\\n\\t}\\n\\n\\t</style>\\n\\t<body>\\n\\t<div class=\\"block_div\\">\\n\\t<h1 class=\\"text-logo\\">Gateway</h1>\\n\\t<hr>\\n\\tReason: {{.VulnName}}, Policy ID: {{.PolicyID}}, by Application Gateway\\n\\t</div>\\n\\t</body>\\n\\t</html>\\n\\t","cert":{"zerossl_api_key":"","google_key_file":"","renew_before":30},"global_cache_config":{"cache_max_size":250,"cache_max_unit":"mb","cache_min_size":100,"cache_min_unit":"byte","cache_life":45,"cache_extension":"[\\".html\\",\\".js\\",\\".css\\",\\".gif\\",\\".png\\",\\".bmp\\",\\".jpeg\\",\\".jpg\\",\\".webp\\",\\".ico\\",\\".pdf\\",\\".ttf\\",\\".eot\\",\\".tiff\\",\\".svg\\",\\".svgz\\",\\".eps\\",\\".woff\\",\\".otf\\",\\".woff2\\",\\".tif\\",\\".csv\\",\\".xls\\",\\".xlsx\\",\\".doc\\",\\".docx\\",\\".ppt\\",\\".pptx\\",\\".wav\\",\\".mp3\\",\\".mp4\\",\\".ogg\\",\\".mid\\",\\".midi\\"]"},"kafka_addrs":"","kafka_auth":null,"redis_config":null,"ServerConfig":{"read_timeout":10,"write_timeout":10,"read_header_timeout":60,"max_header_bytes":1048576,"mix_number":123456,"waf_domain_suffix":".your_domain.com","traffic_discount_rate":1.3},"elastic_config":null}');
UNLOCK TABLES;

-- 
-- Dumping data for table `waf_default_rules`
--

LOCK TABLES `waf_default_rules` WRITE;
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (941011,'ATTACK-XSS','ATTACK-XSS','emergency',0,0,100,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:941011,phase:1,pass,nolog,skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS"'),
	 (941012,'ATTACK-XSS','ATTACK-XSS','emergency',0,0,100,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:941012,phase:2,pass,nolog,skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS"'),
	 (941010,'ATTACK-XSS','ATTACK-XSS','emergency',0,0,100,1,400,true,0,1742288288,0,'SecRule REQUEST_FILENAME "!@validateByteRange 20, 45-47, 48-57, 65-90, 95, 97-122" "id:941010,phase:1,pass,t:none,nolog,ctl:ruleRemoveTargetById=941100-941999;REQUEST_FILENAME"'),
	 (941100,'XSS Attack Detected via libinjection','XSS Attack Detected via libinjection','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|ARGS_NAMES|ARGS|XML:/* "@detectXSS" "id:941100,phase:2,block,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''XSS Attack Detected via libinjection'',logdata:''Matched Data: XSS data found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941110,'XSS Filter - Category 1: Script Tag Vector','XSS Filter - Category 1: Script Tag Vector','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|XML:/* "@rx (?i)<script[^>]*>[\\s\\S]*?" "id:941110,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''XSS Filter - Category 1: Script Tag Vector'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941130,'XSS Filter - Category 3: Attribute Vector','XSS Filter - Category 3: Attribute Vector','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i).(?:\\b(?:x(?:link:href|html|mlns)|data:text/html|formaction|pattern\\b.*?=)|!ENTITY[\\s\\v]+(?:%[\\s\\v]+)?[^\\s\\v]+[\\s\\v]+(?:SYSTEM|PUBLIC)|@import|;base64)\\b" "id:941130,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''XSS Filter - Category 3: Attribute Vector'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941140,'XSS Filter - Category 4: Javascript URI Vector','XSS Filter - Category 4: Javascript URI Vector','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i)[a-z]+=(?:[^:=]+:.+;)*?[^:=]+:url\\(javascript" "id:941140,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,t:removeWhitespace,msg:''XSS Filter - Category 4: Javascript URI Vector'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941160,'NoScript XSS InjectionChecker: HTML Injection','NoScript XSS InjectionChecker: HTML Injection','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i)<[^0-9<>A-Z_a-z]*(?:[^\\s\\v\\"''<>]*:)?[^0-9<>A-Z_a-z]*[^0-9A-Z_a-z]*?(?:s[^0-9A-Z_a-z]*?(?:c[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?p[^0-9A-Z_a-z]*?t|t[^0-9A-Z_a-z]*?y[^0-9A-Z_a-z]*?l[^0-9A-Z_a-z]*?e|v[^0-9A-Z_a-z]*?g|e[^0-9A-Z_a-z]*?t[^0-9>A-Z_a-z])|f[^0-9A-Z_a-z]*?o[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?m|m[^0-9A-Z_a-z]*?(?:a[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?q[^0-9A-Z_a-z]*?u[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?e|e[^0-9A-Z_a-z]*?t[^0-9A-Z_a-z]*?a[^0-9>A-Z_a-z])|(?:l[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?n[^0-9A-Z_a-z]*?k|o[^0-9A-Z_a-z]*?b[^0-9A-Z_a-z]*?j[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?c[^0-9A-Z_a-z]*?t|e[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?b[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?d|a[^0-9A-Z_a-z]*?(?:p[^0-9A-Z_a-z]*?p[^0-9A-Z_a-z]*?l[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?t|u[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?o|n[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?t[^0-9A-Z_a-z]*?e)|p[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?m|i?[^0-9A-Z_a-z]*?f[^0-9A-Z_a-z]*?r[^0-9A-Z_a-z]*?a[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?e|b[^0-9A-Z_a-z]*?(?:a[^0-9A-Z_a-z]*?s[^0-9A-Z_a-z]*?e|o[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?y|i[^0-9A-Z_a-z]*?n[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?n[^0-9A-Z_a-z]*?g[^0-9A-Z_a-z]*?s)|i[^0-9A-Z_a-z]*?m[^0-9A-Z_a-z]*?a?[^0-9A-Z_a-z]*?g[^0-9A-Z_a-z]*?e?|v[^0-9A-Z_a-z]*?i[^0-9A-Z_a-z]*?d[^0-9A-Z_a-z]*?e[^0-9A-Z_a-z]*?o)[^0-9>A-Z_a-z])|(?:<[0-9A-Z_a-z].*[\\s\\v/]|[\\"''](?:.*[\\s\\v/])?)(?:background|formaction|lowsrc|on(?:a(?:bort|ctivate|d(?:apteradded|dtrack)|fter(?:print|(?:scriptexecu|upda)te)|lerting|n(?:imation(?:end|iteration|start)|tennastatechange)|ppcommand|udio(?:end|process|start))|b(?:e(?:fore(?:(?:(?:de)?activa|scriptexecu)te|c(?:opy|ut)|editfocus|p(?:aste|rint)|u(?:nload|pdate))|gin(?:Event)?)|l(?:ocked|ur)|oun(?:ce|dary)|roadcast|usy)|c(?:a(?:(?:ch|llschang)ed|nplay(?:through)?|rdstatechange)|(?:ell|fstate)change|h(?:a(?:rging(?:time)?cha)?nge|ecking)|l(?:ick|ose)|o(?:m(?:mand(?:update)?|p(?:lete|osition(?:end|start|update)))|n(?:nect(?:ed|ing)|t(?:extmenu|rolselect))|py)|u(?:echange|t))|d(?:ata(?:(?:availabl|chang)e|error|setc(?:hanged|omplete))|blclick|e(?:activate|livery(?:error|success)|vice(?:found|light|(?:mo|orienta)tion|proximity))|i(?:aling|s(?:abled|c(?:hargingtimechange|onnect(?:ed|ing))))|o(?:m(?:a(?:ctivate|ttrmodified)|(?:characterdata|subtree)modified|focus(?:in|out)|mousescroll|node(?:inserted(?:intodocument)?|removed(?:fromdocument)?))|wnloading)|r(?:ag(?:drop|e(?:n(?:d|ter)|xit)|(?:gestur|leav)e|over|start)|op)|urationchange)|e(?:mptied|n(?:abled|d(?:ed|Event)?|ter)|rror(?:update)?|xit)|f(?:ailed|i(?:lterchange|nish)|o(?:cus(?:in|out)?|rm(?:change|input)))|g(?:amepad(?:axismove|button(?:down|up)|(?:dis)?connected)|et)|h(?:ashchange|e(?:adphoneschange|l[dp])|olding)|i(?:cc(?:cardlockerror|infochange)|n(?:coming|put|valid))|key(?:down|press|up)|l(?:evelchange|o(?:ad(?:e(?:d(?:meta)?data|nd)|start)?|secapture)|y)|m(?:ark|essage|o(?:use(?:down|enter|(?:lea|mo)ve|o(?:ut|ver)|up|wheel)|ve(?:end|start)?|z(?:a(?:fterpaint|udioavailable)|(?:beforeresiz|orientationchang|t(?:apgestur|imechang))e|(?:edgeui(?:c(?:ancel|omplet)|start)e|network(?:down|up)loa)d|fullscreen(?:change|error)|m(?:agnifygesture(?:start|update)?|ouse(?:hittest|pixelscroll))|p(?:ointerlock(?:change|error)|resstapgesture)|rotategesture(?:start|update)?|s(?:crolledareachanged|wipegesture(?:end|start|update)?))))|no(?:match|update)|o(?:(?:bsolet|(?:ff|n)lin)e|pen|verflow(?:changed)?)|p(?:a(?:ge(?:hide|show)|int|(?:st|us)e)|lay(?:ing)?|op(?:state|up(?:hid(?:den|ing)|show(?:ing|n)))|ro(?:gress|pertychange))|r(?:atechange|e(?:adystatechange|ceived|movetrack|peat(?:Event)?|quest|s(?:et|ize|u(?:lt|m(?:e|ing)))|trieving)|ow(?:e(?:nter|xit)|s(?:delete|inserted)))|s(?:croll|e(?:ek(?:complete|ed|ing)|lect(?:start)?|n(?:ding|t)|t)|how|(?:ound|peech)(?:end|start)|t(?:a(?:lled|rt|t(?:echange|uschanged))|k(?:comma|sessione)nd|op)|u(?:bmit|ccess|spend)|vg(?:abort|error|(?:un)?load|resize|scroll|zoom))|t(?:ext|ime(?:out|update)|ouch(?:cancel|en(?:d|ter)|(?:lea|mo)ve|start)|ransition(?:cancel|end|run))|u(?:n(?:derflow|load)|p(?:dateready|gradeneeded)|s(?:erproximity|sdreceived))|v(?:ersion|o(?:ic|lum)e)change|w(?:a(?:it|rn)ing|heel)|zoom)|ping|s(?:rc|tyle))[\\x08-\\n\\f-\\r ]*?=" "id:941160,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''NoScript XSS InjectionChecker: HTML Injection'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941170,'NoScript XSS InjectionChecker: Attribute Injection','NoScript XSS InjectionChecker: Attribute Injection','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i)(?:\\W|^)(?:javascript:(?:[\\s\\S]+[=\\x5c\\(\\[\\.<]|[\\s\\S]*?(?:\\bname\\b|\\x5c[ux]\\d))|data:(?:(?:[a-z]\\w+/\\w[\\w+-]+\\w)?[;,]|[\\s\\S]*?;[\\s\\S]*?\\b(?:base64|charset=)|[\\s\\S]*?,[\\s\\S]*?<[\\s\\S]*?\\w[\\s\\S]*?>))|@\\W*?i\\W*?m\\W*?p\\W*?o\\W*?r\\W*?t\\W*?(?:/\\*[\\s\\S]*?)?(?:[\\"'']|\\W*?u\\W*?r\\W*?l[\\s\\S]*?\\()|[^-]*?-\\W*?m\\W*?o\\W*?z\\W*?-\\W*?b\\W*?i\\W*?n\\W*?d\\W*?i\\W*?n\\W*?g[^:]*?:\\W*?u\\W*?r\\W*?l[\\s\\S]*?\\(" "id:941170,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''NoScript XSS InjectionChecker: Attribute Injection'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941180,'Node-Validator Deny List Keywords','Node-Validator Deny List Keywords','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@pm document.cookie document.domain document.write .parentnode .innerhtml window.location -moz-binding <!-- <![cdata[" "id:941180,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''Node-Validator Deny List Keywords'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (951140,'EMC SQL Information Leakage','EMC SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i:\\[DM_QUERY_E_SYNTAX\\]|has occurred in the vicinity of:)" "id:951140,phase:4,block,capture,t:none,msg:''EMC SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-emc'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (941190,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i:<style.*?>.*?(?:@[i\\x5c]|(?:[:=]|&#x?0*(?:58|3A|61|3D);?).*?(?:[(\\x5c]|&#x?0*(?:40|28|92|5C);?)))" "id:941190,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941200,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i:<.*[:]?vmlframe.*?[\\s/+]*?src[\\s/+]*=)" "id:941200,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941210,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i:(?:j|&#x?0*(?:74|4A|106|6A);?)(?:\\t|\\n|\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:a|&#x?0*(?:65|41|97|61);?)(?:\\t|\\n|\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:v|&#x?0*(?:86|56|118|76);?)(?:\\t|\\n|\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:a|&#x?0*(?:65|41|97|61);?)(?:\\t|\\n|\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:s|&#x?0*(?:83|53|115|73);?)(?:\\t|\\n|\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:c|&#x?0*(?:67|43|99|63);?)(?:\\t|\\n|\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:r|&#x?0*(?:82|52|114|72);?)(?:\\t|\\n|\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:i|&#x?0*(?:73|49|105|69);?)(?:\\t|\\n|\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:p|&#x?0*(?:80|50|112|70);?)(?:\\t|\\n|\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:t|&#x?0*(?:84|54|116|74);?)(?:\\t|\\n|\\r|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?::|&(?:#x?0*(?:58|3A);?|colon;)).)" "id:941210,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941220,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i:(?:v|&#x?0*(?:86|56|118|76);?)(?:\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:b|&#x?0*(?:66|42|98|62);?)(?:\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:s|&#x?0*(?:83|53|115|73);?)(?:\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:c|&#x?0*(?:67|43|99|63);?)(?:\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:r|&#x?0*(?:82|52|114|72);?)(?:\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:i|&#x?0*(?:73|49|105|69);?)(?:\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:p|&#x?0*(?:80|50|112|70);?)(?:\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?:t|&#x?0*(?:84|54|116|74);?)(?:\\t|&(?:#x?0*(?:9|13|10|A|D);?|tab;|newline;))*(?::|&(?:#x?0*(?:58|3A);?|colon;)).)" "id:941220,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941230,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i)<EMBED[\\s/+].*?(?:src|type).*?=" "id:941230,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941240,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx <[?]?import[\\s/+\\S]*?implementation[\\s/+]*?=" "id:941240,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:lowercase,t:removeNulls,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941250,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i:<META[\\s/+].*?http-equiv[\\s/+]*=[\\s/+]*[\\"''`]?(?:(?:c|&#x?0*(?:67|43|99|63);?)|(?:r|&#x?0*(?:82|52|114|72);?)|(?:s|&#x?0*(?:83|53|115|73);?)))" "id:941250,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941260,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i:<META[\\s/+].*?charset[\\s/+]*=)" "id:941260,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941270,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i)<LINK[\\s/+].*?href[\\s/+]*=" "id:941270,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (941280,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i)<BASE[\\s/+].*?href[\\s/+]*=" "id:941280,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941290,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i)<APPLET[\\s/+>]" "id:941290,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941300,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i)<OBJECT[\\s/+].*?(?:type|codetype|classid|code|data)[\\s/+]*=" "id:941300,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941310,'US-ASCII Malformed Encoding XSS Filter - Attack Detected','US-ASCII Malformed Encoding XSS Filter - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx \\xbc[^\\xbe>]*[\\xbe>]|<[^\\xbe]*\\xbe" "id:941310,phase:2,block,capture,t:none,t:lowercase,t:urlDecode,t:htmlEntityDecode,t:jsDecode,msg:''US-ASCII Malformed Encoding XSS Filter - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-tomcat'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (941350,'UTF-7 Encoding IE XSS - Attack Detected','UTF-7 Encoding IE XSS - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx \\+ADw-.*(?:\\+AD4-|>)|<.*\\+AD4-" "id:941350,phase:2,block,capture,t:none,t:urlDecode,t:htmlEntityDecode,t:jsDecode,msg:''UTF-7 Encoding IE XSS - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-internet-explorer'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941360,'JSFuck / Hieroglyphy obfuscation detected','JSFuck / Hieroglyphy obfuscation detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx ![!+ ]\\[\\]" "id:941360,phase:2,block,capture,t:none,msg:''JSFuck / Hieroglyphy obfuscation detected'',logdata:''Matched Data: Suspicious payload found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242/63'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941370,'JavaScript global variable found','JavaScript global variable found','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?:self|document|this|top|window)\\s*(?:/\\*|[\\[)]).+?(?:\\]|\\*/)" "id:941370,phase:2,block,capture,t:none,t:urlDecodeUni,t:compressWhitespace,msg:''JavaScript global variable found'',logdata:''Matched Data: Suspicious JS global variable found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242/63'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941390,'Javascript method detected','Javascript method detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i)\\b(?:eval|set(?:timeout|interval)|new[\\s\\v]+Function|a(?:lert|tob)|btoa)[\\s\\v]*\\(" "id:941390,phase:2,block,capture,t:none,t:htmlEntityDecode,t:jsDecode,msg:''Javascript method detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941400,'XSS JavaScript function without parentheses','XSS JavaScript function without parentheses','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx ((?:\\[[^\\]]*\\][^.]*\\.)|Reflect[^.]*\\.).*(?:map|sort|apply)[^.]*\\..*call[^`]*`.*`" "id:941400,phase:2,block,capture,t:none,t:urlDecodeUni,t:compressWhitespace,msg:''XSS JavaScript function without parentheses'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''attack-xss'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (941013,'ATTACK-XSS','ATTACK-XSS','emergency',0,0,100,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:941013,phase:1,pass,nolog,skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (941014,'ATTACK-XSS','ATTACK-XSS','emergency',0,0,100,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:941014,phase:2,pass,nolog,skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS"'),
	 (941101,'XSS Attack Detected via libinjection','XSS Attack Detected via libinjection','critical',0,0,100,1,100,true,0,1742288288,0,'SecRule REQUEST_FILENAME|REQUEST_HEADERS:Referer "@detectXSS" "id:941101,phase:1,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''XSS Attack Detected via libinjection'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (941120,'XSS Filter - Category 2: Event Handler Vector','XSS Filter - Category 2: Event Handler Vector','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i)[\\s\\"''`;/0-9=\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]on[a-zA-Z]{3,25}[\\s\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]*?=[^=]" "id:941120,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''XSS Filter - Category 2: Event Handler Vector'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (941150,'XSS Filter - Category 5: Disallowed HTML Attributes','XSS Filter - Category 5: Disallowed HTML Attributes','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i)\\b(?:s(?:tyle|rc)|href)\\b[\\s\\S]*?=" "id:941150,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls,msg:''XSS Filter - Category 5: Disallowed HTML Attributes'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (941181,'Node-Validator Deny List Keywords','Node-Validator Deny List Keywords','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@contains -->" "id:941181,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:lowercase,t:removeNulls,msg:''Node-Validator Deny List Keywords'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (941320,'Possible XSS Attack Detected - HTML Tag Handler','Possible XSS Attack Detected - HTML Tag Handler','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx <(?:a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|hr|html|i|iframe|ilayer|img|input|ins|isindex|kdb|keygen|label|layer|legend|li|limittext|link|listing|map|marquee|menu|meta|multicol|nobr|noembed|noframes|noscript|nosmartquotes|object|ol|optgroup|option|p|param|plaintext|pre|q|rt|ruby|s|samp|script|select|server|shadow|sidebar|small|spacer|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|title|tr|tt|u|ul|var|wbr|xml|xmp)\\W" "id:941320,phase:2,block,capture,t:none,t:jsDecode,t:lowercase,msg:''Possible XSS Attack Detected - HTML Tag Handler'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''OWASP_CRS'',tag:''capec/1000/152/242/63'',tag:''PCI/6.5.1'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (949155,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 4" "id:949155,phase:1,pass,t:none,nolog,setvar:''tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}''"'),
	 (949059,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecAction "id:949059,phase:2,pass,t:none,nolog,setvar:''tx.blocking_inbound_anomaly_score=0''"'),
	 (941330,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i:[\\"''][ ]*(?:[^a-z0-9~_:'' ]|in).*?(?:(?:l|\\x5cu006C)(?:o|\\x5cu006F)(?:c|\\x5cu0063)(?:a|\\x5cu0061)(?:t|\\x5cu0074)(?:i|\\x5cu0069)(?:o|\\x5cu006F)(?:n|\\x5cu006E)|(?:n|\\x5cu006E)(?:a|\\x5cu0061)(?:m|\\x5cu006D)(?:e|\\x5cu0065)|(?:o|\\x5cu006F)(?:n|\\x5cu006E)(?:e|\\x5cu0065)(?:r|\\x5cu0072)(?:r|\\x5cu0072)(?:o|\\x5cu006F)(?:r|\\x5cu0072)|(?:v|\\x5cu0076)(?:a|\\x5cu0061)(?:l|\\x5cu006C)(?:u|\\x5cu0075)(?:e|\\x5cu0065)(?:O|\\x5cu004F)(?:f|\\x5cu0066)).*?=)" "id:941330,phase:2,block,capture,t:none,t:htmlEntityDecode,t:compressWhitespace,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',tag:''PCI/6.5.1'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (941340,'IE XSS Filters - Attack Detected','IE XSS Filters - Attack Detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i)[\\"\\''][ ]*(?:[^a-z0-9~_:\\'' ]|in).+?[.].+?=" "id:941340,phase:2,block,capture,t:none,t:htmlEntityDecode,t:compressWhitespace,msg:''IE XSS Filters - Attack Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-xss'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',tag:''PCI/6.5.1'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (941380,'AngularJS client side template injection detected','AngularJS client side template injection detected','critical',0,0,100,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx {{.*?}}" "id:941380,phase:2,block,capture,t:none,msg:''AngularJS client side template injection detected'',logdata:''Matched Data: Suspicious payload found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''attack-xss'',tag:''OWASP_CRS'',tag:''capec/1000/152/242/63'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.xss_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (941015,'ATTACK-XSS','ATTACK-XSS','emergency',0,0,100,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:941015,phase:1,pass,nolog,skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS"'),
	 (941016,'ATTACK-XSS','ATTACK-XSS','emergency',0,0,100,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:941016,phase:2,pass,nolog,skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS"'),
	 (941017,'ATTACK-XSS','ATTACK-XSS','emergency',0,0,100,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:941017,phase:1,pass,nolog,skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS"'),
	 (941018,'ATTACK-XSS','ATTACK-XSS','emergency',0,0,100,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:941018,phase:2,pass,nolog,skipAfter:END-REQUEST-941-APPLICATION-ATTACK-XSS"'),
	 (951011,'SQL inject ATTACK','SQL inject ATTACK','emergency',0,0,200,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:951011,phase:3,pass,nolog,skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL"'),
	 (951012,'SQL inject ATTACK','SQL inject ATTACK','emergency',0,0,200,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:951012,phase:4,pass,nolog,skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL"'),
	 (951100,'SQL inject ATTACK','SQL inject ATTACK','emergency',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "!@pmFromFile sql-errors.data" "id:951100,phase:4,pass,t:none,nolog,tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-disclosure'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',skipAfter:END-SQL-ERROR-MATCH-PL1"'),
	 (951110,'Microsoft Access SQL Information Leakage','Microsoft Access SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i:JET Database Engine|Access Database Engine|\\[Microsoft\\]\\[ODBC Microsoft Access Driver\\])" "id:951110,phase:4,block,capture,t:none,msg:''Microsoft Access SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-msaccess'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (951120,'Oracle SQL Information Leakage','Oracle SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i:ORA-[0-9][0-9][0-9][0-9]|java\\.sql\\.SQLException|Oracle error|Oracle.*Driver|Warning.*oci_.*|Warning.*ora_.*)" "id:951120,phase:4,block,capture,t:none,msg:''Oracle SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-oracle'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (951130,'DB2 SQL Information Leakage','DB2 SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i:DB2 SQL error:|\\[IBM\\]\\[CLI Driver\\]\\[DB2/6000\\]|CLI Driver.*DB2|DB2 SQL error|db2_\\w+\\()" "id:951130,phase:4,block,capture,t:none,msg:''DB2 SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-db2'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (920171,'GET or HEAD Request with Transfer-Encoding','GET or HEAD Request with Transfer-Encoding','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_METHOD "@rx ^(?:GET|HEAD)$" "id:920171,phase:1,block,t:none,msg:''GET or HEAD Request with Transfer-Encoding'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (951150,'firebird SQL Information Leakage','firebird SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i)Dynamic SQL Error" "id:951150,phase:4,block,capture,t:none,msg:''firebird SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-firebird'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (951160,'Frontbase SQL Information Leakage','Frontbase SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i)Exception (?:condition )?\\d+\\. Transaction rollback\\." "id:951160,phase:4,block,capture,t:none,msg:''Frontbase SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-frontbase'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (951170,'hsqldb SQL Information Leakage','hsqldb SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i)org\\.hsqldb\\.jdbc" "id:951170,phase:4,block,capture,t:none,msg:''hsqldb SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-hsqldb'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (951180,'informix SQL Information Leakage','informix SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i:An illegal character has been found in the statement|com\\.informix\\.jdbc|Exception.*Informix)" "id:951180,phase:4,block,capture,t:none,msg:''informix SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-informix'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (951190,'ingres SQL Information Leakage','ingres SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i:Warning.*ingres_|Ingres SQLSTATE|Ingres\\W.*Driver)" "id:951190,phase:4,block,capture,t:none,msg:''ingres SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-ingres'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (951200,'interbase SQL Information Leakage','interbase SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i:<b>Warning</b>: ibase_|Unexpected end of command in statement)" "id:951200,phase:4,block,capture,t:none,msg:''interbase SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-interbase'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (951210,'maxDB SQL Information Leakage','maxDB SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i:SQL error.*POS[0-9]+.*|Warning.*maxdb.*)" "id:951210,phase:4,block,capture,t:none,msg:''maxDB SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-maxdb'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (951220,'mssql SQL Information Leakage','mssql SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i)(?:System\\.Data\\.OleDb\\.OleDbException|\\[Microsoft\\]\\[ODBC SQL Server Driver\\]|\\[Macromedia\\]\\[SQLServer JDBC Driver\\]|\\[SqlException|System\\.Data\\.SqlClient\\.SqlException|Unclosed quotation mark after the character string|''80040e14''|mssql_query\\(\\)|Microsoft OLE DB Provider for ODBC Drivers|Microsoft OLE DB Provider for SQL Server|Incorrect syntax near|Sintaxis incorrecta cerca de|Syntax error in string in query expression|Procedure or function .* expects parameter|Unclosed quotation mark before the character string|Syntax error .* in query expression|Data type mismatch in criteria expression\\.|ADODB\\.Field \\(0x800A0BCD\\)|the used select statements have different number of columns|OLE DB.*SQL Server|Warning.*mssql_.*|Driver.*SQL[ _-]*Server|SQL Server.*Driver|SQL Server.*[0-9a-fA-F]{8}|Exception.*\\WSystem\\.Data\\.SqlClient\\.)" "id:951220,phase:4,block,capture,t:none,msg:''mssql SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-mssql'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (951230,'mysql SQL Information Leakage','mysql SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i)(?:supplied argument is not a valid |SQL syntax.*)MySQL|Column count doesn''t match(?: value count at row)?|mysql_fetch_array\\(\\)|on MySQL result index|You have an error in your SQL syntax(?:;| near)|MyS(?:QL server version for the right syntax to use|qlClient\\.)|\\[MySQL\\]\\[ODBC|(?:Table ''[^'']+'' doesn''t exis|valid MySQL resul)t|Warning.{1,10}mysql_(?:[\\(-\\)_a-z]{1,26})?|ERROR [0-9]{4} \\([0-9a-z]{5}\\):" "id:951230,phase:4,block,capture,t:none,msg:''mysql SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-mysql'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (949159,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecAction "id:949159,phase:2,pass,t:none,nolog,setvar:''tx.detection_inbound_anomaly_score=0''"'),
	 (951240,'postgres SQL Information Leakage','postgres SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i)P(?:ostgreSQL(?: query failed:|.{1,20}ERROR)|G::[a-z]*Error)|pg_(?:query|exec)\\(\\) \\[:|Warning.{1,20}\\bpg_.*|valid PostgreSQL result|Npgsql\\.|Supplied argument is not a valid PostgreSQL .*? resource|Unable to connect to PostgreSQL server" "id:951240,phase:4,block,capture,t:none,msg:''postgres SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-pgsql'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (951250,'sqlite SQL Information Leakage','sqlite SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i)(?:Warning.*sqlite_.*|Warning.*SQLite3::|SQLite/JDBCDriver|SQLite\\.Exception|System\\.Data\\.SQLite\\.SQLiteException)" "id:951250,phase:4,block,capture,t:none,msg:''sqlite SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-sqlite'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (951260,'Sybase SQL Information Leakage','Sybase SQL Information Leakage','critical',0,0,200,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i)(?:Sybase message:|Warning.{2,20}sybase|Sybase.*Server message.*)" "id:951260,phase:4,block,capture,t:none,msg:''Sybase SQL Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-sybase'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (951013,'SQL inject ATTACK','SQL inject ATTACK','emergency',0,0,200,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:951013,phase:3,pass,nolog,skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL"'),
	 (951014,'SQL inject ATTACK','SQL inject ATTACK','emergency',0,0,200,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:951014,phase:4,pass,nolog,skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL"'),
	 (951015,'SQL inject ATTACK','SQL inject ATTACK','emergency',0,0,200,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:951015,phase:3,pass,nolog,skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL"'),
	 (951016,'SQL inject ATTACK','SQL inject ATTACK','emergency',0,0,200,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:951016,phase:4,pass,nolog,skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL"'),
	 (951017,'SQL inject ATTACK','SQL inject ATTACK','emergency',0,0,200,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:951017,phase:3,pass,nolog,skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (951018,'SQL inject ATTACK','SQL inject ATTACK','emergency',0,0,200,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:951018,phase:4,pass,nolog,skipAfter:END-RESPONSE-951-DATA-LEAKAGES-SQL"'),
	 (942011,'SQL ATTACK','SQL ATTACK','emergency',0,0,200,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:942011,phase:1,pass,nolog,skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI"'),
	 (942012,'SQL ATTACK','SQL ATTACK','emergency',0,0,200,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:942012,phase:2,pass,nolog,skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI"'),
	 (942100,'SQL Injection Attack Detected via libinjection','SQL Injection Attack Detected via libinjection','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|XML:/* "@detectSQLi" "id:942100,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:removeNulls,msg:''SQL Injection Attack Detected via libinjection'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',multiMatch,setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}''"'),
	 (942140,'SQL Injection Attack: Common DB Names Detected','SQL Injection Attack: Common DB Names Detected','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\b(?:d(?:atabas|b_nam)e[^0-9A-Z_a-z]*\\(|(?:information_schema|m(?:aster\\.\\.sysdatabases|s(?:db|ys(?:ac(?:cess(?:objects|storage|xml)|es)|modules2?|(?:object|querie|relationship)s))|ysql\\.db)|northwind|pg_(?:catalog|toast)|tempdb)\\b|s(?:chema(?:_name\\b|[^0-9A-Z_a-z]*\\()|(?:qlite_(?:temp_)?master|ys(?:aux|\\.database_name))\\b))" "id:942140,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''SQL Injection Attack: Common DB Names Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942151,'SQL Injection Attack: SQL function name detected','SQL Injection Attack: SQL function name detected','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\b(?:a(?:dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:cii(?:str)?|in)|tan2?)|b(?:enchmark|i(?:n_to_num|t_(?:and|count|length|x?or)))|c(?:har(?:acter)?_length|iel(?:ing)?|o(?:alesce|ercibility|llation|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert(?:_tz)?)?)|t)|r32|ur(?:(?:dat|tim)e|rent_(?:date|time(?:stamp)?|user)))|d(?:a(?:t(?:abase|e(?:_(?:add|format|sub)|diff))|y(?:name|of(?:month|week|year)))|count|e(?:code|grees|s_(?:de|en)crypt)|ump)|e(?:lt|n(?:c(?:ode|rypt)|ds_?with)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:el|n)d_in_set|ound_rows|rom_(?:base64|days|unixtime))|g(?:e(?:ometrycollection|t_(?:format|lock))|(?:r(?:eates|oup_conca)|tid_subse)t)|hex(?:toraw)?|i(?:fnull|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull))|null))|json(?:_(?:a(?:gg|rray(?:_(?:elements(?:_text)?|length))?)|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|object(?:_(?:agg|keys))?|populate_record(?:set)?|strip_nulls|t(?:o_record(?:set)?|ypeof))|b(?:_(?:array(?:_(?:elements(?:_text)?|length))?|build_(?:array|object)|object(?:_(?:agg|keys))?|e(?:ac|xtract_pat)h(?:_text)?|insert|p(?:ath_(?:(?:exists|match)(?:_tz)?|query(?:_(?:(?:array|first)(?:_tz)?|tz))?)|opulate_record(?:set)?|retty)|s(?:et(?:_lax)?|trip_nulls)|t(?:o_record(?:set)?|ypeof)))?|path)?|l(?:ast_(?:day|inser_id)|case|e(?:as|f)t|i(?:kel(?:ihood|y)|nestring)|o(?:ad_file|ca(?:ltimestamp|te)|g(?:10|2)|wer)|pad|trim)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|d5|i(?:crosecon)?d|onthname|ulti(?:linestring|po(?:int|lygon)))|n(?:ame_const|ot_in|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:eriod_(?:add|diff)|g_(?:client_encoding|sleep)|o(?:(?:lyg|siti)on|w)|rocedure_analyse)|qu(?:arter|ote)|r(?:a(?:dians|nd|wtohex)|elease_lock|ow_(?:count|to_json)|pad|trim)|s(?:chema|e(?:c_to_time|ssion_user)|ha[1-2]?|in|oundex|pace|q(?:lite_(?:compileoption_(?:get|used)|source_id)|rt)|t(?:arts_?with|d(?:dev_(?:po|sam)p)?|r(?:_to_date|cmp))|ub(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|ys(?:date|tem_user))|t(?:ime(?:_(?:format|to_sec)|diff|stamp(?:add|diff)?)|o(?:_(?:base64|jsonb?)|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|i(?:str|x_timestamp)|likely)|(?:pdatexm|se_json_nul)l|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|var(?:_(?:po|sam)p|iance)|we(?:ek(?:day|ofyear)|ight_string)|xmltype|yearweek)[^0-9A-Z_a-z]*\\(" "id:942151,phase:2,block,capture,t:none,t:urlDecodeUni,t:lowercase,msg:''SQL Injection Attack: SQL function name detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942160,'Detects blind sqli tests using sleep() or benchmark()','Detects blind sqli tests using sleep() or benchmark()','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_BASENAME|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i:sleep\\(\\s*?\\d*?\\s*?\\)|benchmark\\(.*?\\,.*?\\))" "id:942160,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects blind sqli tests using sleep() or benchmark()'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942170,'Detects SQL benchmark and sleep injection attempts including conditional queries','Detects SQL benchmark and sleep injection attempts including conditional queries','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)(?:select|;)[\\s\\v]+(?:benchmark|if|sleep)[\\s\\v]*?\\([\\s\\v]*?\\(?[\\s\\v]*?[0-9A-Z_a-z]+" "id:942170,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects SQL benchmark and sleep injection attempts including conditional queries'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942190,'Detects MSSQL code execution and information gathering attempts','Detects MSSQL code execution and information gathering attempts','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)[\\"''`](?:[\\s\\v]*![\\s\\v]*[\\"''0-9A-Z_-z]|;?[\\s\\v]*(?:having|select|union\\b[\\s\\v]*(?:all|(?:distin|sele)ct))\\b[\\s\\v]*[^\\s\\v])|\\b(?:(?:(?:c(?:onnection_id|urrent_user)|database|schema|user)[\\s\\v]*?|select.*?[0-9A-Z_a-z]?user)\\(|exec(?:ute)?[\\s\\v]+master\\.|from[^0-9A-Z_a-z]+information_schema[^0-9A-Z_a-z]|into[\\s\\v\\+]+(?:dump|out)file[\\s\\v]*?[\\"''`]|union(?:[\\s\\v]select[\\s\\v]@|[\\s\\v\\(0-9A-Z_a-z]*?select))|[\\s\\v]*?exec(?:ute)?.*?[^0-9A-Z_a-z]xp_cmdshell|[^0-9A-Z_a-z]iif[\\s\\v]*?\\(" "id:942190,phase:2,block,capture,t:none,t:urlDecodeUni,t:removeCommentsChar,msg:''Detects MSSQL code execution and information gathering attempts'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942220,'Looking for integer overflow attacks, these are taken from skipfish, except 2.2.2250738585072011e-308 is the \\"magic number\\" crash','Looking for integer overflow attacks, these are taken from skipfish, except 2.2.2250738585072011e-308 is the \\"magic number\\" crash','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx ^(?i:-0000023456|4294967295|4294967296|2147483648|2147483647|0000012345|-2147483648|-2147483649|0000023456|2.2250738585072007e-308|2.2250738585072011e-308|1e309)$" "id:942220,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Looking for integer overflow attacks, these are taken from skipfish, except 2.2.2250738585072011e-308 is the \\"magic number\\" crash'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (942230,'Detects conditional SQL injection attempts','Detects conditional SQL injection attempts','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)[\\s\\v\\(-\\)]case[\\s\\v]+when.*?then|\\)[\\s\\v]*?like[\\s\\v]*?\\(|select.*?having[\\s\\v]*?[^\\s\\v]+[\\s\\v]*?[^\\s\\v0-9A-Z_a-z]|if[\\s\\v]?\\([0-9A-Z_a-z]+[\\s\\v]*?[<->~]" "id:942230,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects conditional SQL injection attempts'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942240,'Detects MySQL charset switch and MSSQL DoS attempts','Detects MySQL charset switch and MSSQL DoS attempts','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)alter[\\s\\v]*?[0-9A-Z_a-z]+.*?char(?:acter)?[\\s\\v]+set[\\s\\v]+[0-9A-Z_a-z]+|[\\"''`](?:;*?[\\s\\v]*?waitfor[\\s\\v]+(?:time|delay)[\\s\\v]+[\\"''`]|;.*?:[\\s\\v]*?goto)" "id:942240,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects MySQL charset switch and MSSQL DoS attempts'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942250,'Detects MATCH AGAINST, MERGE and EXECUTE IMMEDIATE injections','Detects MATCH AGAINST, MERGE and EXECUTE IMMEDIATE injections','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i:merge.*?using\\s*?\\(|execute\\s*?immediate\\s*?[\\"''`]|match\\s*?[\\w(),+-]+\\s*?against\\s*?\\()" "id:942250,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects MATCH AGAINST, MERGE and EXECUTE IMMEDIATE injections'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942270,'Looking for basic sql injection. Common attack string for mysql, oracle and others','Looking for basic sql injection. Common attack string for mysql, oracle and others','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)union.*?select.*?from" "id:942270,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Looking for basic sql injection. Common attack string for mysql, oracle and others'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (949060,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 1" "id:949060,phase:2,pass,t:none,nolog,setvar:''tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}''"'),
	 (942280,'Detects Postgres pg_sleep injection, waitfor delay attacks and database shutdown attempts','Detects Postgres pg_sleep injection, waitfor delay attacks and database shutdown attempts','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)select[\\s\\v]*?pg_sleep|waitfor[\\s\\v]*?delay[\\s\\v]?[\\"''`]+[\\s\\v]?[0-9]|;[\\s\\v]*?shutdown[\\s\\v]*?(?:[#;\\{]|/\\*|--)" "id:942280,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects Postgres pg_sleep injection, waitfor delay attacks and database shutdown attempts'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942290,'Finds basic MongoDB SQL injection attempts','Finds basic MongoDB SQL injection attempts','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\[?\\$(?:n(?:e|in?|o[rt])|e(?:q|xists|lemMatch)|l(?:te?|ike)|mod|a(?:ll|nd)|(?:s(?:iz|lic)|wher)e|t(?:ype|ext)|x?or|div|between|regex|jsonSchema)\\]?" "id:942290,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Finds basic MongoDB SQL injection attempts'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942320,'Detects MySQL and PostgreSQL stored procedure/function injections','Detects MySQL and PostgreSQL stored procedure/function injections','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)create[\\s\\v]+(?:function|procedure)[\\s\\v]*?[0-9A-Z_a-z]+[\\s\\v]*?\\([\\s\\v]*?\\)[\\s\\v]*?-|d(?:eclare[^0-9A-Z_a-z]+[#@][\\s\\v]*?[0-9A-Z_a-z]+|iv[\\s\\v]*?\\([\\+\\-]*[\\s\\v\\.0-9]+,[\\+\\-]*[\\s\\v\\.0-9]+\\))|exec[\\s\\v]*?\\([\\s\\v]*?@|(?:lo_(?:impor|ge)t|procedure[\\s\\v]+analyse)[\\s\\v]*?\\(|;[\\s\\v]*?(?:declare|open)[\\s\\v]+[\\-0-9A-Z_a-z]+|::(?:b(?:igint|ool)|double[\\s\\v]+precision|int(?:eger)?|numeric|oid|real|(?:tex|smallin)t)" "id:942320,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects MySQL and PostgreSQL stored procedure/function injections'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942350,'Detects MySQL UDF injection and other data/structure manipulation attempts','Detects MySQL UDF injection and other data/structure manipulation attempts','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)create[\\s\\v]+function[\\s\\v].+[\\s\\v]returns|;[\\s\\v]*?(?:alter|(?:(?:cre|trunc|upd)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)\\b[\\s\\v]*?[\\(\\[]?[0-9A-Z_a-z]{2,}" "id:942350,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects MySQL UDF injection and other data/structure manipulation attempts'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942360,'Detects concatenated basic SQL injection and SQLLFI attempts','Detects concatenated basic SQL injection and SQLLFI attempts','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\b(?:(?:alter|(?:(?:cre|trunc|upd)at|renam)e|de(?:lete|sc)|(?:inser|selec)t|load)[\\s\\v]+(?:char|group_concat|load_file)\\b[\\s\\v]*\\(?|end[\\s\\v]*?\\);)|[\\s\\v\\(]load_file[\\s\\v]*?\\(|[\\"''`][\\s\\v]+regexp[^0-9A-Z_a-z]|[\\"''0-9A-Z_-z][\\s\\v]+as\\b[\\s\\v]*[\\"''0-9A-Z_-z]+[\\s\\v]*\\bfrom|^[^A-Z_a-z]+[\\s\\v]*?(?:(?:(?:(?:cre|trunc)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)[\\s\\v]+[0-9A-Z_a-z]+|u(?:pdate[\\s\\v]+[0-9A-Z_a-z]+|nion[\\s\\v]*(?:all|(?:sele|distin)ct)\\b)|alter[\\s\\v]*(?:a(?:(?:ggregat|pplication[\\s\\v]*rol)e|s(?:sembl|ymmetric[\\s\\v]*ke)y|u(?:dit|thorization)|vailability[\\s\\v]*group)|b(?:roker[\\s\\v]*priority|ufferpool)|c(?:ertificate|luster|o(?:l(?:latio|um)|nversio)n|r(?:edential|yptographic[\\s\\v]*provider))|d(?:atabase|efault|i(?:mension|skgroup)|omain)|e(?:(?:ndpoi|ve)nt|xte(?:nsion|rnal))|f(?:lashback|oreign|u(?:lltext|nction))|hi(?:erarchy|stogram)|group|in(?:dex(?:type)?|memory|stance)|java|l(?:a(?:ngua|r)ge|ibrary|o(?:ckdown|g(?:file[\\s\\v]*group|in)))|m(?:a(?:s(?:k|ter[\\s\\v]*key)|terialized)|e(?:ssage[\\s\\v]*type|thod)|odule)|(?:nicknam|queu)e|o(?:perator|utline)|p(?:a(?:ckage|rtition)|ermission|ro(?:cedur|fil)e)|r(?:e(?:mot|sourc)e|o(?:l(?:e|lback)|ute))|s(?:chema|e(?:arch|curity|rv(?:er|ice)|quence|ssion)|y(?:mmetric[\\s\\v]*key|nonym)|togroup)|t(?:able(?:space)?|ext|hreshold|r(?:igger|usted)|ype)|us(?:age|er)|view|w(?:ork(?:load)?|rapper)|x(?:ml[\\s\\v]*schema|srobject))\\b)" "id:942360,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects concatenated basic SQL injection and SQLLFI attempts'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (942500,'MySQL in-line comment detected','MySQL in-line comment detected','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i:/\\*[!+](?:[\\w\\s=_\\-()]+)?\\*/)" "id:942500,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''MySQL in-line comment detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942540,'SQL Authentication bypass (split query)','SQL Authentication bypass (split query)','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx ^(?:[^'']*''|[^\\"]*\\"|[^`]*`)[\\s\\v]*;" "id:942540,phase:2,block,capture,t:none,t:urlDecodeUni,t:replaceComments,msg:''SQL Authentication bypass (split query)'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942550,'JSON-Based SQL Injection','JSON-Based SQL Injection','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_FILENAME|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx [\\"''`][\\[\\{].*[\\]\\}][\\"''`].*(::.*jsonb?)?.*(?:(?:@|->?)>|<@|\\?[&\\|]?|#>>?|[<>]|<-)|(?:(?:@|->?)>|<@|\\?[&\\|]?|#>>?|[<>]|<-)[\\"''`][\\[\\{].*[\\]\\}][\\"''`]|json_extract.*\\(.*\\)" "id:942550,phase:2,block,t:none,t:urlDecodeUni,t:lowercase,t:removeWhitespace,msg:''JSON-Based SQL Injection'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (942013,'SQL ATTACK','SQL ATTACK','emergency',0,0,200,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:942013,phase:1,pass,nolog,skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI"'),
	 (942014,'SQL ATTACK','SQL ATTACK','emergency',0,0,200,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:942014,phase:2,pass,nolog,skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI"'),
	 (942110,'SQL Injection Attack: Common Injection Testing Detected','SQL Injection Attack: Common Injection Testing Detected','warning',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@rx (?:^\\s*[\\"''`;]+|[\\"''`]+\\s*$)" "id:942110,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,msg:''SQL Injection Attack: Common Injection Testing Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.sql_injection_score=+%{tx.warning_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}''"'),
	 (942120,'SQL Injection Attack: SQL Operator Detected','SQL Injection Attack: SQL Operator Detected','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule ARGS_NAMES|ARGS|REQUEST_FILENAME|XML:/* "@rx (?i)!=|&&|\\|\\||>[=->]|<(?:<|=>?|>(?:[\\s\\v]+binary)?)|\\b(?:(?:xor|r(?:egexp|like)|i(?:snull|like)|notnull)\\b|collate(?:[^0-9A-Z_a-z]*?(?:U&)?[\\"''`]|[^0-9A-Z_a-z]+(?:(?:binary|nocase|rtrim)\\b|[0-9A-Z_a-z]*?_))|(?:likel(?:ihood|y)|unlikely)[\\s\\v]*\\()|r(?:egexp|like)[\\s\\v]+binary|not[\\s\\v]+between[\\s\\v]+(?:0[\\s\\v]+and|(?:''[^'']*''|\\"[^\\"]*\\")[\\s\\v]+and[\\s\\v]+(?:''[^'']*''|\\"[^\\"]*\\"))|is[\\s\\v]+null|like[\\s\\v]+(?:null|[0-9A-Z_a-z]+[\\s\\v]+escape\\b)|(?:^|[^0-9A-Z_a-z])in[\\s\\v\\+]*\\([\\s\\v\\"0-9]+[^\\(-\\)]*\\)|[!<->]{1,2}[\\s\\v]*all\\b" "id:942120,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,msg:''SQL Injection Attack: SQL Operator Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942130,'SQL Injection Attack: SQL Boolean-based attack detected','SQL Injection Attack: SQL Boolean-based attack detected','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule ARGS_NAMES|ARGS|XML:/* "@rx (?i)[\\s\\v\\"''-\\)`]*?\\b([0-9A-Z_a-z]+)\\b[\\s\\v\\"''-\\)`]*?(?:=|<=>|(?:sounds[\\s\\v]+)?like|glob|r(?:like|egexp))[\\s\\v\\"''-\\)`]*?\\b([0-9A-Z_a-z]+)\\b" "id:942130,phase:2,block,capture,t:none,t:urlDecodeUni,t:replaceComments,msg:''SQL Injection Attack: SQL Boolean-based attack detected'',logdata:''Matched Data: %{TX.0} found within %{TX.942130_MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.942130_lhs=%{TX.1}'',setvar:''tx.942130_matched_var_name=%{matched_var_name}'',chain"'),
	 (942131,'SQL Injection Attack: SQL Boolean-based attack detected','SQL Injection Attack: SQL Boolean-based attack detected','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule ARGS_NAMES|ARGS|XML:/* "@rx (?i)[\\s\\v\\"''-\\)`]*?\\b([0-9A-Z_a-z]+)\\b[\\s\\v\\"''-\\)`]*?(?:![<->]|<[=->]?|>=?|\\^|is[\\s\\v]+not|not[\\s\\v]+(?:like|r(?:like|egexp)))[\\s\\v\\"''-\\)`]*?\\b([0-9A-Z_a-z]+)\\b" "id:942131,phase:2,block,capture,t:none,t:urlDecodeUni,t:replaceComments,msg:''SQL Injection Attack: SQL Boolean-based attack detected'',logdata:''Matched Data: %{TX.0} found within %{TX.942131_MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',multiMatch,setvar:''tx.942131_lhs=%{TX.1}'',setvar:''tx.942131_matched_var_name=%{matched_var_name}'',chain"'),
	 (942150,'SQL Injection Attack: SQL function name detected','SQL Injection Attack: SQL function name detected','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\b(?:json(?:_[0-9A-Z_a-z]+)?|a(?:bs|(?:cos|sin)h?|tan[2h]?|vg)|c(?:eil(?:ing)?|h(?:a(?:nges|r(?:set)?)|r)|o(?:alesce|sh?|unt)|ast)|d(?:e(?:grees|fault)|a(?:te|y))|exp|f(?:loor(?:avg)?|ormat|ield)|g(?:lob|roup_concat)|h(?:ex|our)|i(?:f(?:null)?|if|n(?:str)?)|l(?:ast(?:_insert_rowid)?|ength|ike(?:l(?:ihood|y))?|n|o(?:ad_extension|g(?:10|2)?|wer(?:pi)?|cal)|trim)|m(?:ax|in(?:ute)?|o(?:d|nth))|n(?:ullif|ow)|p(?:i|ow(?:er)?|rintf|assword)|quote|r(?:a(?:dians|ndom(?:blob)?)|e(?:p(?:lace|eat)|verse)|ound|trim|ight)|s(?:i(?:gn|nh?)|oundex|q(?:lite_(?:compileoption_(?:get|used)|offset|source_id|version)|rt)|u(?:bstr(?:ing)?|m)|econd|leep)|t(?:anh?|otal(?:_changes)?|r(?:im|unc)|ypeof|ime)|u(?:n(?:icode|likely)|(?:pp|s)er)|zeroblob|bin|v(?:alues|ersion)|week|year)[^0-9A-Z_a-z]*\\(" "id:942150,phase:2,block,capture,t:none,t:urlDecodeUni,t:lowercase,msg:''SQL Injection Attack: SQL function name detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (942251,'Detects HAVING injections','Detects HAVING injections','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\W+\\d*?\\s*?\\bhaving\\b\\s*?[^\\s\\-]" "id:942251,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects HAVING injections'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (942180,'Detects basic SQL authentication bypass attempts 1/3','Detects basic SQL authentication bypass attempts 1/3','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)(?:/\\*)+[\\"''`]+[\\s\\v]?(?:--|[#\\{]|/\\*)?|[\\"''`](?:[\\s\\v]*(?:(?:x?or|and|div|like|between)[\\s\\v\\-0-9A-Z_a-z]+[\\(-\\)\\+-\\-<->][\\s\\v]*[\\"''0-9`]|[!=\\|](?:[\\s\\v -!\\+\\-0-9=]+.*?[\\"''-\\(`].*?|[\\s\\v -!0-9=]+.*?[0-9]+)$|(?:like|print)[^0-9A-Z_a-z]+[\\"''-\\(0-9A-Z_-z]|;)|(?:[<>~]+|[\\s\\v]*[^\\s\\v0-9A-Z_a-z]?=[\\s\\v]*|[^0-9A-Z_a-z]*?[\\+=]+[^0-9A-Z_a-z]*?)[\\"''`])|[0-9][\\"''`][\\s\\v]+[\\"''`][\\s\\v]+[0-9]|^admin[\\s\\v]*?[\\"''`]|[\\s\\v\\"''-\\(`][\\s\\v]*?glob[^0-9A-Z_a-z]+[\\"''-\\(0-9A-Z_-z]|[\\s\\v]is[\\s\\v]*?0[^0-9A-Z_a-z]|where[\\s\\v][\\s\\v,-\\.0-9A-Z_a-z]+[\\s\\v]=" "id:942180,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects basic SQL authentication bypass attempts 1/3'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942200,'Detects MySQL comment-/space-obfuscated injections and backtick termination','Detects MySQL comment-/space-obfuscated injections and backtick termination','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|XML:/* "@rx (?i),.*?[\\"''\\)0-9`-f][\\"''`](?:[\\"''`].*?[\\"''`]|(?:\\r?\\n)?\\z|[^\\"''`]+)|[^0-9A-Z_a-z]select.+[^0-9A-Z_a-z]*?from|(?:alter|(?:(?:cre|trunc|upd)at|renam)e|d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load)[\\s\\v]*?\\([\\s\\v]*?space[\\s\\v]*?\\(" "id:942200,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects MySQL comment-/space-obfuscated injections and backtick termination'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942210,'Detects chained SQL injection attempts 1/2','Detects chained SQL injection attempts 1/2','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)(?:&&|\\|\\||and|between|div|like|n(?:and|ot)|(?:xx?)?or)[\\s\\v\\(]+[0-9A-Z_a-z]+[\\s\\v\\)]*?[!\\+=]+[\\s\\v0-9]*?[\\"''-\\)=`]|[0-9](?:[\\s\\v]*?(?:and|between|div|like|x?or)[\\s\\v]*?[0-9]+[\\s\\v]*?[\\+\\-]|[\\s\\v]+group[\\s\\v]+by.+\\()|/[0-9A-Z_a-z]+;?[\\s\\v]+(?:and|between|div|having|like|x?or|select)[^0-9A-Z_a-z]|(?:[#;]|--)[\\s\\v]*?(?:alter|drop|(?:insert|update)[\\s\\v]*?[0-9A-Z_a-z]{2,})|@.+=[\\s\\v]*?\\([\\s\\v]*?select|[^0-9A-Z_a-z]SET[\\s\\v]*?@[0-9A-Z_a-z]+" "id:942210,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects chained SQL injection attempts 1/2'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942260,'Detects basic SQL authentication bypass attempts 2/3','Detects basic SQL authentication bypass attempts 2/3','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)[\\"''`][\\s\\v]*?(?:(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between|\\|\\||&&)[\\s\\v]+[\\s\\v0-9A-Z_a-z]+=[\\s\\v]*?[0-9A-Z_a-z]+[\\s\\v]*?having[\\s\\v]+|like[^0-9A-Z_a-z]*?[\\"''0-9`])|[0-9A-Z_a-z][\\s\\v]+like[\\s\\v]+[\\"''`]|like[\\s\\v]*?[\\"''`]%|select[\\s\\v]+?[\\s\\v\\"''-\\),-\\.0-9A-\\[\\]_-z]+from[\\s\\v]+" "id:942260,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects basic SQL authentication bypass attempts 2/3'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942300,'Detects MySQL comments, conditions and ch(a)r injections','Detects MySQL comments, conditions and ch(a)r injections','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\)[\\s\\v]*?when[\\s\\v]*?[0-9]+[\\s\\v]*?then|[\\"''`][\\s\\v]*?(?:[#\\{]|--)|/\\*![\\s\\v]?[0-9]+|\\b(?:b(?:inary[\\s\\v]*?\\([\\s\\v]*?[0-9]|etween[\\s\\v]+[\\s\\v]*?[0-9A-Z_a-z]+\\()|cha?r[\\s\\v]*?\\([\\s\\v]*?[0-9]|(?:and|n(?:and|ot)|(?:xx?)?or|div|like|r(?:egexp|like))[\\s\\v]+[\\s\\v]*?[0-9A-Z_a-z]+\\()|(?:\\|\\||&&)[\\s\\v]+[\\s\\v]*?[0-9A-Z_a-z]+\\(" "id:942300,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects MySQL comments, conditions and ch(a)r injections'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942310,'Detects chained SQL injection attempts 2/2','Detects chained SQL injection attempts 2/2','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)(?:\\([\\s\\v]*?select[\\s\\v]*?[0-9A-Z_a-z]+|coalesce|order[\\s\\v]+by[\\s\\v]+if[0-9A-Z_a-z]*?)[\\s\\v]*?\\(|\\*/from|\\+[\\s\\v]*?[0-9]+[\\s\\v]*?\\+[\\s\\v]*?@|[0-9A-Z_a-z][\\"''`][\\s\\v]*?(?:(?:[\\+\\-=@\\|]+[\\s\\v]+?)+|[\\+\\-=@\\|]+)[\\(0-9]|@@[0-9A-Z_a-z]+[\\s\\v]*?[^\\s\\v0-9A-Z_a-z]|[^0-9A-Z_a-z]!+[\\"''`][0-9A-Z_a-z]|[\\"''`](?:;[\\s\\v]*?(?:if|while|begin)|[\\s\\v0-9]+=[\\s\\v]*?[0-9])|[\\s\\v\\(]+case[0-9]*?[^0-9A-Z_a-z].+[tw]hen[\\s\\v\\(]" "id:942310,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects chained SQL injection attempts 2/2'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (901169,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:crs_validate_utf8_encoding "@eq 0" "id:901169,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.crs_validate_utf8_encoding=0''"'),
	 (949160,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 1" "id:949160,phase:2,pass,t:none,nolog,setvar:''tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}''"'),
	 (942330,'Detects classic SQL injection probings 1/3','Detects classic SQL injection probings 1/3','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)[\\"''`][\\s\\v]*?(?:x?or|div|like|between|and)[\\s\\v]*?[\\"''`]?[0-9]|\\x5cx(?:2[37]|3d)|^(?:.?[\\"''`]$|[\\"''\\x5c`]*?(?:[\\"''0-9`]+|[^\\"''`]+[\\"''`])[\\s\\v]*?(?:and|n(?:and|ot)|(?:xx?)?or|div|like|between|\\|\\||&&)[\\s\\v]*?[\\"''0-9A-Z_-z][!&\\(-\\)\\+-\\.@])|[^\\s\\v0-9A-Z_a-z][0-9A-Z_a-z]+[\\s\\v]*?[\\-\\|][\\s\\v]*?[\\"''`][\\s\\v]*?[0-9A-Z_a-z]|@(?:[0-9A-Z_a-z]+[\\s\\v]+(?:and|x?or|div|like|between)[\\s\\v]*?[\\"''0-9`]+|[\\-0-9A-Z_a-z]+[\\s\\v](?:and|x?or|div|like|between)[\\s\\v]*?[^\\s\\v0-9A-Z_a-z])|[^\\s\\v0-:A-Z_a-z][\\s\\v]*?[0-9][^0-9A-Z_a-z]+[^\\s\\v0-9A-Z_a-z][\\s\\v]*?[\\"''`].|[^0-9A-Z_a-z]information_schema|table_name[^0-9A-Z_a-z]" "id:942330,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects classic SQL injection probings 1/3'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (942340,'Detects basic SQL authentication bypass attempts 3/3','Detects basic SQL authentication bypass attempts 3/3','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)in[\\s\\v]*?\\(+[\\s\\v]*?select|(?:(?:(?i:N)?AND|(?i:X)?(?i:X)?OR|DIV|LIKE|BETWEEN|NOT)[\\s\\v]+|(?:\\|\\||&&)[\\s\\v]*)[\\s\\v\\+0-9A-Z_a-z]+(?:regexp[\\s\\v]*?\\(|sounds[\\s\\v]+like[\\s\\v]*?[\\"''`]|[0-9=]+x)|[\\"''`](?:[\\s\\v]*?(?:[0-9][\\s\\v]*?(?:--|#)|is[\\s\\v]*?(?:[0-9].+[\\"''`]?[0-9A-Z_a-z]|[\\.0-9]+[\\s\\v]*?[^0-9A-Z_a-z].*?[\\"''`]))|[%-&<->\\^]+[0-9][\\s\\v]*?(?:=|x?or|div|like|between|and)|(?:[^0-9A-Z_a-z]+[\\+\\-0-9A-Z_a-z]+[\\s\\v]*?=[\\s\\v]*?[0-9][^0-9A-Z_a-z]+|\\|?[\\-0-9A-Z_a-z]{3,}[^\\s\\v,\\.0-9A-Z_a-z]+)[\\"''`]|[\\s\\v]*(?:(?:(?i:N)?AND|(?i:X)?(?i:X)?OR|DIV|LIKE|BETWEEN|NOT)[\\s\\v]+|(?:\\|\\||&&)[\\s\\v]*)(?:array[\\s\\v]*\\[|[0-9A-Z_a-z]+(?:[\\s\\v]*!?~|[\\s\\v]+(?:not[\\s\\v]+)?similar[\\s\\v]+to[\\s\\v]+)|(?:tru|fals)e\\b))|\\bexcept[\\s\\v]+(?:select\\b|values[\\s\\v]*?\\()" "id:942340,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects basic SQL authentication bypass attempts 3/3'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942361,'Detects basic SQL injection based on keyword alter or union','Detects basic SQL injection based on keyword alter or union','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i:^[\\W\\d]+\\s*?(?:alter|union)\\b)" "id:942361,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects basic SQL injection based on keyword alter or union'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942362,'Detects concatenated basic SQL injection and SQLLFI attempts','Detects concatenated basic SQL injection and SQLLFI attempts','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)(?:alter|(?:(?:cre|trunc|upd)at|renam)e|de(?:lete|sc)|(?:inser|selec)t|load)[\\s\\v]+(?:char|group_concat|load_file)[\\s\\v]?\\(?|end[\\s\\v]*?\\);|[\\s\\v\\(]load_file[\\s\\v]*?\\(|[\\"''`][\\s\\v]+regexp[^0-9A-Z_a-z]|[^A-Z_a-z][\\s\\v]+as\\b[\\s\\v]*[\\"''0-9A-Z_-z]+[\\s\\v]*\\bfrom|^[^A-Z_a-z]+[\\s\\v]*?(?:create[\\s\\v]+[0-9A-Z_a-z]+|(?:d(?:e(?:lete|sc)|rop)|(?:inser|selec)t|load|(?:renam|truncat)e|u(?:pdate|nion[\\s\\v]*(?:all|(?:sele|distin)ct))|alter[\\s\\v]*(?:a(?:(?:ggregat|pplication[\\s\\v]*rol)e|s(?:sembl|ymmetric[\\s\\v]*ke)y|u(?:dit|thorization)|vailability[\\s\\v]*group)|b(?:roker[\\s\\v]*priority|ufferpool)|c(?:ertificate|luster|o(?:l(?:latio|um)|nversio)n|r(?:edential|yptographic[\\s\\v]*provider))|d(?:atabase|efault|i(?:mension|skgroup)|omain)|e(?:(?:ndpoi|ve)nt|xte(?:nsion|rnal))|f(?:lashback|oreign|u(?:lltext|nction))|hi(?:erarchy|stogram)|group|in(?:dex(?:type)?|memory|stance)|java|l(?:a(?:ngua|r)ge|ibrary|o(?:ckdown|g(?:file[\\s\\v]*group|in)))|m(?:a(?:s(?:k|ter[\\s\\v]*key)|terialized)|e(?:ssage[\\s\\v]*type|thod)|odule)|(?:nicknam|queu)e|o(?:perator|utline)|p(?:a(?:ckage|rtition)|ermission|ro(?:cedur|fil)e)|r(?:e(?:mot|sourc)e|o(?:l(?:e|lback)|ute))|s(?:chema|e(?:arch|curity|rv(?:er|ice)|quence|ssion)|y(?:mmetric[\\s\\v]*key|nonym)|togroup)|t(?:able(?:space)?|ext|hreshold|r(?:igger|usted)|ype)|us(?:age|er)|view|w(?:ork(?:load)?|rapper)|x(?:ml[\\s\\v]*schema|srobject)))\\b)" "id:942362,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects concatenated basic SQL injection and SQLLFI attempts'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942370,'Detects classic SQL injection probings 2/3','Detects classic SQL injection probings 2/3','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:Referer|REQUEST_HEADERS:User-Agent|ARGS_NAMES|ARGS|XML:/* "@rx (?i)[\\"''`](?:[\\s\\v]*?(?:(?:\\*.+(?:x?or|div|like|between|(?:an|i)d)[^0-9A-Z_a-z]*?[\\"''`]|(?:x?or|div|like|between|and)[\\s\\v][^0-9]+[\\-0-9A-Z_a-z]+.*?)[0-9]|[^\\s\\v0-9\\?A-Z_a-z]+[\\s\\v]*?[^\\s\\v0-9A-Z_a-z]+[\\s\\v]*?[\\"''`]|[^\\s\\v0-9A-Z_a-z]+[\\s\\v]*?[^A-Z_a-z].*?(?:#|--))|.*?\\*[\\s\\v]*?[0-9])|\\^[\\"''`]|[%\\(-\\+\\-<>][\\-0-9A-Z_a-z]+[^\\s\\v0-9A-Z_a-z]+[\\"''`][^,]" "id:942370,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects classic SQL injection probings 2/3'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942380,'SQL Injection Attack','SQL Injection Attack','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\b(?:having\\b(?:[\\s\\v]+(?:[0-9]{1,10}|''[^=]{1,10}'')[\\s\\v]*?[<->]| ?(?:[0-9]{1,10} ?[<->]+|[\\"''][^=]{1,10}[ \\"''<-\\?\\[]+))|ex(?:ecute(?:\\(|[\\s\\v]{1,5}[\\$\\.0-9A-Z_a-z]{1,5}[\\s\\v]{0,3})|ists[\\s\\v]*?\\([\\s\\v]*?select\\b)|(?:create[\\s\\v]+?table.{0,20}?|like[^0-9A-Z_a-z]*?char[^0-9A-Z_a-z]*?)\\()|select.*?case|from.*?limit|order[\\s\\v]by|exists[\\s\\v](?:[\\s\\v]select|s(?:elect[^\\s\\v](?:if(?:null)?[\\s\\v]\\(|top|concat)|ystem[\\s\\v]\\()|\\bhaving\\b[\\s\\v]+[0-9]{1,10}|''[^=]{1,10}'')" "id:942380,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''SQL Injection Attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942390,'SQL Injection Attack','SQL Injection Attack','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\b(?:or\\b(?:[\\s\\v]?(?:[0-9]{1,10}|[\\"''][^=]{1,10}[\\"''])[\\s\\v]?[<->]+|[\\s\\v]+(?:[0-9]{1,10}|''[^=]{1,10}'')(?:[\\s\\v]*?[<->])?)|xor\\b[\\s\\v]+(?:[0-9]{1,10}|''[^=]{1,10}'')(?:[\\s\\v]*?[<->])?)|''[\\s\\v]+x?or[\\s\\v]+.{1,20}[!\\+\\-<->]" "id:942390,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''SQL Injection Attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (913012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:913012,phase:2,pass,nolog,skipAfter:END-REQUEST-913-SCANNER-DETECTION"'),
	 (942400,'SQL Injection Attack','SQL Injection Attack','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\band\\b(?:[\\s\\v]+(?:[0-9]{1,10}[\\s\\v]*?[<->]|''[^=]{1,10}'')| ?(?:[0-9]{1,10}|[\\"''][^=]{1,10}[\\"'']) ?[<->]+)" "id:942400,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''SQL Injection Attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942410,'SQL Injection Attack','SQL Injection Attack','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\b(?:a(?:(?:b|co)s|dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:in|cii(?:str)?)|tan2?|vg)|b(?:enchmark|i(?:n(?:_to_num)?|t_(?:and|count|length|x?or)))|c(?:ast|h(?:ar(?:(?:acter)?_length|set)?|r)|iel(?:ing)?|o(?:alesce|ercibility|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert(?:_tz)?)?)|(?:un)?t)|r32|ur(?:(?:dat|tim)e|rent_(?:date|time(?:stamp)?|user)))|d(?:a(?:t(?:abase|e(?:_(?:add|format|sub)|diff)?)|y(?:name|of(?:month|week|year))?)|count|e(?:code|(?:faul|s_(?:de|en)cryp)t|grees)|ump)|e(?:lt|nc(?:ode|rypt)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:eld(?:_in_set)?|nd_in_set)|loor|o(?:rmat|und_rows)|rom_(?:base64|days|unixtime))|g(?:et_(?:format|lock)|r(?:eates|oup_conca)t)|h(?:ex(?:toraw)?|our)|i(?:f(?:null)?|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)?|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull))|null)?)|l(?:ast(?:_(?:day|insert_id))?|case|e(?:(?:as|f)t|ngth)|n|o(?:ad_file|ca(?:l(?:timestamp)?|te)|g(?:10|2)?|wer)|pad|trim)|m(?:a(?:ke(?:date|_set)|ster_pos_wait|x)|d5|i(?:(?:crosecon)?d|n(?:ute)?)|o(?:d|nth(?:name)?))|n(?:ame_const|o(?:t_in|w)|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:assword|eriod_(?:add|diff)|g_sleep|i|o(?:sition|w(?:er)?)|rocedure_analyse)|qu(?:arter|ote)|r(?:a(?:dians|nd|wto(?:hex|nhex(?:toraw)?))|e(?:lease_lock|p(?:eat|lace)|verse)|ight|o(?:und|w_count)|pad|trim)|s(?:chema|e(?:c(?:ond|_to_time)|ssion_user)|ha[1-2]?|ig?n|leep|oundex|pace|qrt|t(?:d(?:dev(?:_(?:po|sam)p)?)?|r(?:cmp|_to_date))|u(?:b(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|m)|ys(?:date|tem_user))|t(?:an|ime(?:diff|_(?:format|to_sec)|stamp(?:add|diff)?)?|o_(?:base64|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|ix_timestamp)|p(?:datexml|per)|ser|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|v(?:a(?:lues|r(?:iance|_(?:po|sam)p))|ersion)|we(?:ek(?:day|ofyear)?|ight_string)|xmltype|year(?:week)?)[^0-9A-Z_a-z]*?\\(" "id:942410,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''SQL Injection Attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942470,'SQL Injection Attack','SQL Injection Attack','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)autonomous_transaction|(?:current_use|n?varcha|tbcreato)r|db(?:a_users|ms_java)|open(?:owa_util|query|rowset)|s(?:p_(?:(?:addextendedpro|sqlexe)c|execute(?:sql)?|help|is_srvrolemember|makewebtask|oacreate|p(?:assword|repare)|replwritetovarbin)|ql_(?:longvarchar|variant))|utl_(?:file|http)|xp_(?:availablemedia|(?:cmdshel|servicecontro)l|dirtree|e(?:numdsn|xecresultset)|filelist|loginconfig|makecab|ntsec(?:_enumdomains)?|reg(?:addmultistring|delete(?:key|value)|enum(?:key|value)s|re(?:ad|movemultistring)|write)|terminate(?:_process)?)" "id:942470,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''SQL Injection Attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (942480,'SQL Injection Attack','SQL Injection Attack','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\b(?:(?:d(?:bms_[0-9A-Z_a-z]+\\.|elete\\b[^0-9A-Z_a-z]*?\\bfrom)|(?:group\\b.*?\\bby\\b.{1,100}?\\bhav|overlay\\b[^0-9A-Z_a-z]*?\\(.*?\\b[^0-9A-Z_a-z]*?plac)ing|in(?:ner\\b[^0-9A-Z_a-z]*?\\bjoin|sert\\b[^0-9A-Z_a-z]*?\\binto|to\\b[^0-9A-Z_a-z]*?\\b(?:dump|out)file)|load\\b[^0-9A-Z_a-z]*?\\bdata\\b.*?\\binfile|s(?:elect\\b.{1,100}?\\b(?:(?:.*?\\bdump\\b.*|(?:count|length)\\b.{1,100}?)\\bfrom|(?:data_typ|from\\b.{1,100}?\\bwher)e|instr|to(?:_(?:cha|numbe)r|p\\b.{1,100}?\\bfrom))|ys_context)|u(?:nion\\b.{1,100}?\\bselect|tl_inaddr))\\b|print\\b[^0-9A-Z_a-z]*?@@)|(?:collation[^0-9A-Z_a-z]*?\\(a|@@version|;[^0-9A-Z_a-z]*?\\b(?:drop|shutdown))\\b|''(?:dbo|msdasql|s(?:a|qloledb))''" "id:942480,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''SQL Injection Attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942430,'Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)','Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)','warning',0,0,200,2,100,true,0,1742288288,0,'SecRule ARGS_NAMES|ARGS|XML:/* "@rx ((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\"''´’‘`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\"''´’‘`<>]*?){12})" "id:942430,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)'',logdata:''Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.warning_anomaly_score}''"'),
	 (942440,'SQL Comment Sequence Detected','SQL Comment Sequence Detected','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx /\\*!?|\\*/|['';]--|--(?:[\\s\\v]|[^\\-]*?-)|[^&\\-]#.*?[\\s\\v]|;?\\x00" "id:942440,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''SQL Comment Sequence Detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (920180,'POST without Content-Length or Transfer-Encoding headers','POST without Content-Length or Transfer-Encoding headers','warning',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_PROTOCOL "!@within HTTP/2 HTTP/2.0" "id:920180,phase:1,block,t:none,msg:''POST without Content-Length or Transfer-Encoding headers'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',chain"'),
	 (942450,'SQL Hex Encoding Identified','SQL Hex Encoding Identified','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i:\\b0x[a-f\\d]{3,})" "id:942450,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''SQL Hex Encoding Identified'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942510,'SQLi bypass attempt by ticks or backticks detected','SQLi bypass attempt by ticks or backticks detected','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?:`(?:(?:[\\w\\s=_\\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)`)" "id:942510,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''SQLi bypass attempt by ticks or backticks detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942520,'Detects basic SQL authentication bypass attempts 4.0/4','Detects basic SQL authentication bypass attempts 4.0/4','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)[\\"''`][\\s\\v]*?(?:(?:is[\\s\\v]+not|not[\\s\\v]+(?:like|glob|(?:betwee|i)n|null|regexp|match)|mod|div|sounds[\\s\\v]+like)\\b|[%-&\\*-\\+\\-/<->\\^\\|])" "id:942520,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects basic SQL authentication bypass attempts 4.0/4'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942521,'Detects basic SQL authentication bypass attempts 4.1/4','Detects basic SQL authentication bypass attempts 4.1/4','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer|ARGS_NAMES|ARGS|XML:/* "@rx (?i)^(?:[^'']*?(?:''[^'']*?''[^'']*?)*?''|[^\\"]*?(?:\\"[^\\"]*?\\"[^\\"]*?)*?\\"|[^`]*?(?:`[^`]*?`[^`]*?)*?`)[\\s\\v]*([0-9A-Z_a-z]+)\\b" "id:942521,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects basic SQL authentication bypass attempts 4.1/4'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.942521_lhs=%{TX.1}'',chain"'),
	 (942522,'Detects basic SQL authentication bypass attempts 4.1/4','Detects basic SQL authentication bypass attempts 4.1/4','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule ARGS_NAMES|ARGS|XML:/* "@rx ^.*?\\x5c[''\\"`](?:.*?[''\\"`])?\\s*(?:and|or)\\b" "id:942522,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects basic SQL authentication bypass attempts 4.1/4'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942101,'SQL Injection Attack Detected via libinjection','SQL Injection Attack Detected via libinjection','critical',0,0,200,1,100,true,0,1742288288,0,'SecRule REQUEST_BASENAME|REQUEST_FILENAME "@detectSQLi" "id:942101,phase:1,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:removeNulls,msg:''SQL Injection Attack Detected via libinjection'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (942152,'SQL Injection Attack: SQL function name detected','SQL Injection Attack: SQL function name detected','critical',0,0,200,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Referer|REQUEST_HEADERS:User-Agent "@rx (?i)\\b(?:a(?:dd(?:dat|tim)e|es_(?:de|en)crypt|s(?:cii(?:str)?|in)|tan2?)|b(?:enchmark|i(?:n_to_num|t_(?:and|count|length|x?or)))|c(?:har(?:acter)?_length|iel(?:ing)?|o(?:alesce|ercibility|llation|(?:mpres)?s|n(?:cat(?:_ws)?|nection_id|v(?:ert(?:_tz)?)?)|t)|r32|ur(?:(?:dat|tim)e|rent_(?:date|time(?:stamp)?|user)))|d(?:a(?:t(?:abase|e(?:_(?:add|format|sub)|diff))|y(?:name|of(?:month|week|year)))|count|e(?:code|grees|s_(?:de|en)crypt)|ump)|e(?:lt|n(?:c(?:ode|rypt)|ds_?with)|x(?:p(?:ort_set)?|tract(?:value)?))|f(?:i(?:el|n)d_in_set|ound_rows|rom_(?:base64|days|unixtime))|g(?:e(?:ometrycollection|t_(?:format|lock))|(?:r(?:eates|oup_conca)|tid_subse)t)|hex(?:toraw)?|i(?:fnull|n(?:et6?_(?:aton|ntoa)|s(?:ert|tr)|terval)|s(?:_(?:(?:free|used)_lock|ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull))|null))|json(?:_(?:a(?:gg|rray(?:_(?:elements(?:_text)?|length))?)|build_(?:array|object)|e(?:ac|xtract_pat)h(?:_text)?|object(?:_(?:agg|keys))?|populate_record(?:set)?|strip_nulls|t(?:o_record(?:set)?|ypeof))|b(?:_(?:array(?:_(?:elements(?:_text)?|length))?|build_(?:array|object)|object(?:_(?:agg|keys))?|e(?:ac|xtract_pat)h(?:_text)?|insert|p(?:ath_(?:(?:exists|match)(?:_tz)?|query(?:_(?:(?:array|first)(?:_tz)?|tz))?)|opulate_record(?:set)?|retty)|s(?:et(?:_lax)?|trip_nulls)|t(?:o_record(?:set)?|ypeof)))?|path)?|l(?:ast_(?:day|inser_id)|case|e(?:as|f)t|i(?:kel(?:ihood|y)|nestring)|o(?:ad_file|ca(?:ltimestamp|te)|g(?:10|2)|wer)|pad|trim)|m(?:a(?:ke(?:_set|date)|ster_pos_wait)|d5|i(?:crosecon)?d|onthname|ulti(?:linestring|po(?:int|lygon)))|n(?:ame_const|ot_in|ullif)|o(?:ct(?:et_length)?|(?:ld_passwo)?rd)|p(?:eriod_(?:add|diff)|g_(?:client_encoding|sleep)|o(?:(?:lyg|siti)on|w)|rocedure_analyse)|qu(?:arter|ote)|r(?:a(?:dians|nd|wtohex)|elease_lock|ow_(?:count|to_json)|pad|trim)|s(?:chema|e(?:c_to_time|ssion_user)|ha[1-2]?|in|oundex|pace|q(?:lite_(?:compileoption_(?:get|used)|source_id)|rt)|t(?:arts_?with|d(?:dev_(?:po|sam)p)?|r(?:_to_date|cmp))|ub(?:(?:dat|tim)e|str(?:ing(?:_index)?)?)|ys(?:date|tem_user))|t(?:ime(?:_(?:format|to_sec)|diff|stamp(?:add|diff)?)|o(?:_(?:base64|jsonb?)|n?char|(?:day|second)s)|r(?:im|uncate))|u(?:case|n(?:compress(?:ed_length)?|hex|i(?:str|x_timestamp)|likely)|(?:pdatexm|se_json_nul)l|tc_(?:date|time(?:stamp)?)|uid(?:_short)?)|var(?:_(?:po|sam)p|iance)|we(?:ek(?:day|ofyear)|ight_string)|xmltype|yearweek)[^0-9A-Z_a-z]*\\(" "id:942152,phase:1,block,capture,t:none,t:urlDecodeUni,t:lowercase,msg:''SQL Injection Attack: SQL function name detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942321,'Detects MySQL and PostgreSQL stored procedure/function injections','Detects MySQL and PostgreSQL stored procedure/function injections','critical',0,0,200,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Referer|REQUEST_HEADERS:User-Agent "@rx (?i)create[\\s\\v]+(?:function|procedure)[\\s\\v]*?[0-9A-Z_a-z]+[\\s\\v]*?\\([\\s\\v]*?\\)[\\s\\v]*?-|d(?:eclare[^0-9A-Z_a-z]+[#@][\\s\\v]*?[0-9A-Z_a-z]+|iv[\\s\\v]*?\\([\\+\\-]*[\\s\\v\\.0-9]+,[\\+\\-]*[\\s\\v\\.0-9]+\\))|exec[\\s\\v]*?\\([\\s\\v]*?@|(?:lo_(?:impor|ge)t|procedure[\\s\\v]+analyse)[\\s\\v]*?\\(|;[\\s\\v]*?(?:declare|open)[\\s\\v]+[\\-0-9A-Z_a-z]+|::(?:b(?:igint|ool)|double[\\s\\v]+precision|int(?:eger)?|numeric|oid|real|(?:tex|smallin)t)" "id:942321,phase:1,block,capture,t:none,t:urlDecodeUni,msg:''Detects MySQL and PostgreSQL stored procedure/function injections'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (942015,'SQL ATTACK','SQL ATTACK','emergency',0,0,200,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:942015,phase:1,pass,nolog,skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI"'),
	 (942016,'SQL ATTACK','SQL ATTACK','emergency',0,0,200,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:942016,phase:2,pass,nolog,skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI"'),
	 (920181,'Content-Length and Transfer-Encoding headers present','Content-Length and Transfer-Encoding headers present','warning',0,0,300,1,100,true,0,1742288288,0,'SecRule &REQUEST_HEADERS:Transfer-Encoding "!@eq 0" "id:920181,phase:1,block,t:none,msg:''Content-Length and Transfer-Encoding headers present'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',chain"'),
	 (942490,'Detects classic SQL injection probings 3/3','Detects classic SQL injection probings 3/3','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx [\\"''`][\\s\\d]*?[^\\w\\s]\\W*?\\d\\W*?.*?[\\"''`\\d]" "id:942490,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Detects classic SQL injection probings 3/3'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (942420,'Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (8)','Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (8)','warning',0,0,200,1,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES "@rx ((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\"''´’‘`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\"''´’‘`<>]*?){8})" "id:942420,phase:1,block,capture,t:none,t:urlDecodeUni,msg:''Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (8)'',logdata:''Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.warning_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.warning_anomaly_score}''"'),
	 (942431,'Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)','Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)','warning',0,0,200,2,100,true,0,1742288288,0,'SecRule ARGS_NAMES|ARGS|XML:/* "@rx ((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\"''´’‘`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\"''´’‘`<>]*?){6})" "id:942431,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)'',logdata:''Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.warning_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.warning_anomaly_score}''"'),
	 (942460,'Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters','Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters','warning',0,0,200,2,100,true,0,1742288288,0,'SecRule ARGS "@rx \\W{4}" "id:942460,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.sql_injection_score=+%{tx.warning_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.warning_anomaly_score}''"'),
	 (942511,'SQLi bypass attempt by ticks detected','SQLi bypass attempt by ticks detected','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?:''(?:(?:[\\w\\s=_\\-+{}()<@]){2,29}|(?:[A-Za-z0-9+/]{4})+(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)'')" "id:942511,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''SQLi bypass attempt by ticks detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (942530,'SQLi query termination detected','SQLi query termination detected','critical',0,0,200,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx '';" "id:942530,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''SQLi query termination detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.sql_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (942017,'SQL ATTACK','SQL ATTACK','emergency',0,0,200,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:942017,phase:1,pass,nolog,skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI"'),
	 (942018,'SQL ATTACK','SQL ATTACK','emergency',0,0,200,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:942018,phase:2,pass,nolog,skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI"'),
	 (942421,'Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (3)','Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (3)','warning',0,0,200,1,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES "@rx ((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\"''´’‘`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\"''´’‘`<>]*?){3})" "id:942421,phase:1,block,capture,t:none,t:urlDecodeUni,msg:''Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (3)'',logdata:''Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/4'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.inbound_anomaly_score_pl4=+%{tx.warning_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.warning_anomaly_score}''"'),
	 (913100,'Found User-Agent associated with security scanner','Found User-Agent associated with security scanner','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:User-Agent "@pmFromFile scanners-user-agents.data" "id:913100,phase:1,block,capture,t:none,msg:''Found User-Agent associated with security scanner'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-reputation-scanner'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/224/541/310'',tag:''PCI/6.5.10'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (950022,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:950022,phase:4,pass,nolog,skipAfter:END-RESPONSE-950-DATA-LEAKAGES"'),
	 (942432,'Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)','Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)','warning',0,0,200,2,100,true,0,1742288288,0,'SecRule ARGS_NAMES|ARGS|XML:/* "@rx ((?:[~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\"''´’‘`<>][^~!@#\\$%\\^&\\*\\(\\)\\-\\+=\\{\\}\\[\\]\\|:;\\"''´’‘`<>]*?){2})" "id:942432,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)'',logdata:''Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-sqli'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/66'',tag:''PCI/6.5.2'',tag:''paranoia-level/4'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.inbound_anomaly_score_pl4=+%{tx.warning_anomaly_score}'',setvar:''tx.sql_injection_score=+%{tx.warning_anomaly_score}''"'),
	 (901001,'ModSecurity Core Rule Set is deployed without configuration! Please copy the crs-setup.conf.example template to crs-setup.conf, and include the crs-setup.conf file in your webserver configuration before including the CRS rules. See the INSTALL file in the ','ModSecurity Core Rule Set is deployed without configuration! Please copy the crs-setup.conf.example template to crs-setup.conf, and include the crs-setup.conf file in your webserver configuration before including the CRS rules. See the INSTALL file in the CRS directory for detailed instructions','critical',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:crs_setup_version "@eq 0" "id:901001,phase:1,deny,status:500,log,auditlog,msg:''ModSecurity Core Rule Set is deployed without configuration! Please copy the crs-setup.conf.example template to crs-setup.conf, and include the crs-setup.conf file in your webserver configuration before including the CRS rules. See the INSTALL file in the CRS directory for detailed instructions'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL''"'),
	 (901100,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:inbound_anomaly_score_threshold "@eq 0" "id:901100,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.inbound_anomaly_score_threshold=5''"'),
	 (901110,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:outbound_anomaly_score_threshold "@eq 0" "id:901110,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.outbound_anomaly_score_threshold=4''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (901111,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:reporting_level "@eq 0" "id:901111,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.reporting_level=4''"'),
	 (901115,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:early_blocking "@eq 0" "id:901115,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.early_blocking=0''"'),
	 (901120,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:blocking_paranoia_level "@eq 0" "id:901120,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.blocking_paranoia_level=1''"'),
	 (901125,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:detection_paranoia_level "@eq 0" "id:901125,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.detection_paranoia_level=%{TX.blocking_paranoia_level}''"'),
	 (901130,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:sampling_percentage "@eq 0" "id:901130,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.sampling_percentage=100''"'),
	 (901140,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:critical_anomaly_score "@eq 0" "id:901140,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.critical_anomaly_score=5''"'),
	 (901141,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:error_anomaly_score "@eq 0" "id:901141,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.error_anomaly_score=4''"'),
	 (901142,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:warning_anomaly_score "@eq 0" "id:901142,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.warning_anomaly_score=3''"'),
	 (901143,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:notice_anomaly_score "@eq 0" "id:901143,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.notice_anomaly_score=2''"'),
	 (901160,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:allowed_methods "@eq 0" "id:901160,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.allowed_methods=GET HEAD POST OPTIONS''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (901162,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:allowed_request_content_type "@eq 0" "id:901162,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.allowed_request_content_type=|application/x-www-form-urlencoded| |multipart/form-data| |multipart/related| |text/xml| |application/xml| |application/soap+xml| |application/json| |application/cloudevents+json| |application/cloudevents-batch+json|''"'),
	 (901168,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:allowed_request_content_type_charset "@eq 0" "id:901168,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.allowed_request_content_type_charset=|utf-8| |iso-8859-1| |iso-8859-15| |windows-1252|''"'),
	 (901163,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:allowed_http_versions "@eq 0" "id:901163,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.allowed_http_versions=HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0''"'),
	 (901164,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:restricted_extensions "@eq 0" "id:901164,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.restricted_extensions=.asa/ .asax/ .ascx/ .backup/ .bak/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .com/ .config/ .conf/ .cs/ .csproj/ .csr/ .dat/ .db/ .dbf/ .dll/ .dos/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .ini/ .key/ .licx/ .lnk/ .log/ .mdb/ .old/ .pass/ .pdb/ .pol/ .printer/ .pwd/ .rdb/ .resources/ .resx/ .sql/ .swp/ .sys/ .vb/ .vbs/ .vbproj/ .vsdisco/ .webinfo/ .xsd/ .xsx/''"'),
	 (901165,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:restricted_headers "@eq 0" "id:901165,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.restricted_headers=/accept-charset/ /content-encoding/ /proxy/ /lock-token/ /content-range/ /if/ /x-http-method-override/ /x-http-method/ /x-method-override/''"'),
	 (901167,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule &TX:enforce_bodyproc_urlencoded "@eq 0" "id:901167,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.enforce_bodyproc_urlencoded=0''"'),
	 (901200,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecAction "id:901200,phase:1,pass,t:none,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.blocking_inbound_anomaly_score=0'',setvar:''tx.detection_inbound_anomaly_score=0'',setvar:''tx.inbound_anomaly_score_pl1=0'',setvar:''tx.inbound_anomaly_score_pl2=0'',setvar:''tx.inbound_anomaly_score_pl3=0'',setvar:''tx.inbound_anomaly_score_pl4=0'',setvar:''tx.sql_injection_score=0'',setvar:''tx.xss_score=0'',setvar:''tx.rfi_score=0'',setvar:''tx.lfi_score=0'',setvar:''tx.rce_score=0'',setvar:''tx.php_injection_score=0'',setvar:''tx.http_violation_score=0'',setvar:''tx.session_fixation_score=0'',setvar:''tx.blocking_outbound_anomaly_score=0'',setvar:''tx.detection_outbound_anomaly_score=0'',setvar:''tx.outbound_anomaly_score_pl1=0'',setvar:''tx.outbound_anomaly_score_pl2=0'',setvar:''tx.outbound_anomaly_score_pl3=0'',setvar:''tx.outbound_anomaly_score_pl4=0'',setvar:''tx.anomaly_score=0''"'),
	 (901318,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule REQUEST_HEADERS:User-Agent "@rx ^.*$" "id:901318,phase:1,pass,t:none,t:sha1,t:hexEncode,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.ua_hash=%{MATCHED_VAR}''"'),
	 (901321,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecAction "id:901321,phase:1,pass,t:none,nolog,ver:''OWASP_CRS/4.0.0-rc1'',initcol:global=global,initcol:ip=%{remote_addr}_%{tx.ua_hash}"'),
	 (901340,'Enabling body inspection','Enabling body inspection','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule REQBODY_PROCESSOR "!@rx (?:URLENCODED|MULTIPART|XML|JSON)" "id:901340,phase:1,pass,nolog,noauditlog,msg:''Enabling body inspection'',ctl:forceRequestBodyVariable=On,ver:''OWASP_CRS/4.0.0-rc1''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (901350,'Enabling forced body inspection for ASCII content','Enabling forced body inspection for ASCII content','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:enforce_bodyproc_urlencoded "@eq 1" "id:901350,phase:1,pass,t:none,t:urlDecodeUni,nolog,noauditlog,msg:''Enabling forced body inspection for ASCII content'',ver:''OWASP_CRS/4.0.0-rc1'',chain"'),
	 (901400,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:sampling_percentage "@eq 100" "id:901400,phase:1,pass,nolog,ver:''OWASP_CRS/4.0.0-rc1'',skipAfter:END-SAMPLING"'),
	 (901410,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule UNIQUE_ID "@rx ^[a-f]*([0-9])[a-f]*([0-9])" "id:901410,phase:1,pass,capture,t:sha1,t:hexEncode,nolog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''TX.sampling_rnd100=%{TX.1}%{TX.2}''"'),
	 (901450,'Sampling: Disable the rule engine based on sampling_percentage %{TX.sampling_percentage} and random number %{TX.sampling_rnd100}','Sampling: Disable the rule engine based on sampling_percentage %{TX.sampling_percentage} and random number %{TX.sampling_rnd100}','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:sampling_rnd100 "!@lt %{tx.sampling_percentage}" "id:901450,phase:1,pass,log,noauditlog,msg:''Sampling: Disable the rule engine based on sampling_percentage %{TX.sampling_percentage} and random number %{TX.sampling_rnd100}'',ctl:ruleRemoveByTag=OWASP_CRS,ver:''OWASP_CRS/4.0.0-rc1''"'),
	 (901500,'Detection paranoia level configured is lower than the paranoia level itself. This is illegal. Blocking request. Aborting','Detection paranoia level configured is lower than the paranoia level itself. This is illegal. Blocking request. Aborting','emergency',0,0,300,1,200,true,0,1742288288,0,'SecRule TX:detection_paranoia_level "@lt %{tx.blocking_paranoia_level}" "id:901500,phase:1,deny,status:500,t:none,log,msg:''Detection paranoia level configured is lower than the paranoia level itself. This is illegal. Blocking request. Aborting'',ver:''OWASP_CRS/4.0.0-rc1''"'),
	 (905100,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule REQUEST_LINE "@streq GET /" "id:905100,phase:1,pass,t:none,nolog,tag:''application-multi'',tag:''language-multi'',tag:''platform-apache'',tag:''attack-generic'',ver:''OWASP_CRS/4.0.0-rc1'',chain"'),
	 (905110,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule REMOTE_ADDR "@ipMatch 127.0.0.1,::1" "id:905110,phase:1,pass,t:none,nolog,tag:''application-multi'',tag:''language-multi'',tag:''platform-apache'',tag:''attack-generic'',ver:''OWASP_CRS/4.0.0-rc1'',chain"'),
	 (911011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:911011,phase:1,pass,nolog,skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT"'),
	 (911012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:911012,phase:2,pass,nolog,skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT"'),
	 (911100,'Method is not allowed by policy','Method is not allowed by policy','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_METHOD "!@within %{tx.allowed_methods}" "id:911100,phase:1,block,msg:''Method is not allowed by policy'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-generic'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272/220/274'',tag:''PCI/12.1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (911013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:911013,phase:1,pass,nolog,skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT"'),
	 (911014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:911014,phase:2,pass,nolog,skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT"'),
	 (911015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:911015,phase:1,pass,nolog,skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT"'),
	 (911016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:911016,phase:2,pass,nolog,skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT"'),
	 (911017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:911017,phase:1,pass,nolog,skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT"'),
	 (911018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:911018,phase:2,pass,nolog,skipAfter:END-REQUEST-911-METHOD-ENFORCEMENT"'),
	 (913011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:913011,phase:1,pass,nolog,skipAfter:END-REQUEST-913-SCANNER-DETECTION"'),
	 (913110,'Found request header associated with security scanner','Found request header associated with security scanner','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS_NAMES|REQUEST_HEADERS "@pmFromFile scanners-headers.data" "id:913110,phase:1,block,capture,t:none,msg:''Found request header associated with security scanner'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-reputation-scanner'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/224/541/310'',tag:''PCI/6.5.10'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (913120,'Found request filename/argument associated with security scanner','Found request filename/argument associated with security scanner','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_FILENAME|ARGS "@pmFromFile scanners-urls.data" "id:913120,phase:2,block,capture,t:none,msg:''Found request filename/argument associated with security scanner'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-reputation-scanner'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/224/541/310'',tag:''PCI/6.5.10'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (913013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:913013,phase:1,pass,nolog,skipAfter:END-REQUEST-913-SCANNER-DETECTION"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (913014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:913014,phase:2,pass,nolog,skipAfter:END-REQUEST-913-SCANNER-DETECTION"'),
	 (913101,'Found User-Agent associated with scripting/generic HTTP client','Found User-Agent associated with scripting/generic HTTP client','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:User-Agent "@pmFromFile scripting-user-agents.data" "id:913101,phase:1,block,capture,t:none,msg:''Found User-Agent associated with scripting/generic HTTP client'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-reputation-scripting'',tag:''OWASP_CRS'',tag:''capec/1000/118/224/541/310'',tag:''PCI/6.5.10'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (913102,'Found User-Agent associated with web crawler/bot','Found User-Agent associated with web crawler/bot','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:User-Agent "@pmFromFile crawlers-user-agents.data" "id:913102,phase:1,block,capture,t:none,msg:''Found User-Agent associated with web crawler/bot'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-reputation-crawler'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/150'',tag:''PCI/6.5.10'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (913015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:913015,phase:1,pass,nolog,skipAfter:END-REQUEST-913-SCANNER-DETECTION"'),
	 (913016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:913016,phase:2,pass,nolog,skipAfter:END-REQUEST-913-SCANNER-DETECTION"'),
	 (913017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:913017,phase:1,pass,nolog,skipAfter:END-REQUEST-913-SCANNER-DETECTION"'),
	 (913018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:913018,phase:2,pass,nolog,skipAfter:END-REQUEST-913-SCANNER-DETECTION"'),
	 (920011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:920011,phase:1,pass,nolog,skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT"'),
	 (920012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:920012,phase:2,pass,nolog,skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT"'),
	 (920100,'Invalid HTTP Request Line','Invalid HTTP Request Line','warning',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_LINE "!@rx (?i)^(?:get /[^#\\?]*(?:\\?[^\\s\\v#]*)?(?:#[^\\s\\v]*)?|(?:connect (?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\.?(?::[0-9]+)?|[\\--9A-Z_a-z]+:[0-9]+)|options \\*|[a-z]{3,10}[\\s\\v]+(?:[0-9A-Z_a-z]{3,7}?://[\\--9A-Z_a-z]*(?::[0-9]+)?)?/[^#\\?]*(?:\\?[^\\s\\v#]*)?(?:#[^\\s\\v]*)?)[\\s\\v]+[\\.-9A-Z_a-z]+)$" "id:920100,phase:1,block,t:none,msg:''Invalid HTTP Request Line'',logdata:''%{request_line}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (920120,'Attempted multipart/form-data bypass','Attempted multipart/form-data bypass','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule FILES|FILES_NAMES "!@rx (?i)^(?:&(?:(?:[acegiln-or-suz]acut|[aeiou]grav|[ain-o]tild)e|[c-elnr-tz]caron|(?:[cgk-lnr-t]cedi|[aeiouy]um)l|[aceg-josuwy]circ|[au]ring|a(?:mp|pos)|nbsp|oslash);|[^\\"'';=])*$" "id:920120,phase:2,block,t:none,t:urlDecodeUni,msg:''Attempted multipart/form-data bypass'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (920160,'Content-Length HTTP header is not numeric','Content-Length HTTP header is not numeric','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Content-Length "!@rx ^\\d+$" "id:920160,phase:1,block,t:none,msg:''Content-Length HTTP header is not numeric'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (920170,'GET or HEAD Request with Body Content','GET or HEAD Request with Body Content','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_METHOD "@rx ^(?:GET|HEAD)$" "id:920170,phase:1,block,t:none,msg:''GET or HEAD Request with Body Content'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (920190,'Range: Invalid Last Byte Value','Range: Invalid Last Byte Value','warning',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Range|REQUEST_HEADERS:Request-Range "@rx (\\d+)-(\\d+)" "id:920190,phase:1,block,capture,t:none,msg:''Range: Invalid Last Byte Value'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',chain"'),
	 (920210,'Multiple/Conflicting Connection Header Data Found','Multiple/Conflicting Connection Header Data Found','warning',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Connection "@rx \\b(?:keep-alive|close),\\s?(?:keep-alive|close)\\b" "id:920210,phase:1,block,t:none,msg:''Multiple/Conflicting Connection Header Data Found'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}''"'),
	 (920220,'URL Encoding Abuse Attack Attempt','URL Encoding Abuse Attack Attempt','warning',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_URI "@rx \\x25" "id:920220,phase:1,block,t:none,msg:''URL Encoding Abuse Attack Attempt'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153/267/72'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',chain"'),
	 (920240,'URL Encoding Abuse Attack Attempt','URL Encoding Abuse Attack Attempt','warning',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Content-Type "@rx ^(?i)application/x-www-form-urlencoded" "id:920240,phase:2,block,t:none,msg:''URL Encoding Abuse Attack Attempt'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153/267/72'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',chain"'),
	 (920250,'UTF8 Encoding Abuse Attack Attempt','UTF8 Encoding Abuse Attack Attempt','warning',0,0,300,2,100,true,0,1742288288,0,'SecRule TX:CRS_VALIDATE_UTF8_ENCODING "@eq 1" "id:920250,phase:2,block,t:none,msg:''UTF8 Encoding Abuse Attack Attempt'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153/267'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',chain"'),
	 (920260,'Unicode Full/Half Width Abuse Attack Attempt','Unicode Full/Half Width Abuse Attack Attempt','warning',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_URI|REQUEST_BODY "@rx \\%u[fF]{2}[0-9a-fA-F]{2}" "id:920260,phase:2,block,t:none,msg:''Unicode Full/Half Width Abuse Attack Attempt'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-iis'',tag:''platform-windows'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153/267/72'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}''"'),
	 (920270,'Invalid character in request (null character)','Invalid character in request (null character)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_URI|REQUEST_HEADERS|ARGS|ARGS_NAMES "@validateByteRange 1-255" "id:920270,phase:2,block,t:none,t:urlDecodeUni,msg:''Invalid character in request (null character)'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (920280,'Request Missing a Host Header','Request Missing a Host Header','warning',0,0,300,1,400,true,0,1742288288,0,'SecRule &REQUEST_HEADERS:Host "@eq 0" "id:920280,phase:1,pass,t:none,msg:''Request Missing a Host Header'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''PCI/6.5.10'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}'',skipAfter:END-HOST-CHECK"'),
	 (920290,'Empty Host Header','Empty Host Header','warning',0,0,300,1,400,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Host "@rx ^$" "id:920290,phase:1,pass,t:none,msg:''Empty Host Header'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}''"'),
	 (920310,'Request Has an Empty Accept Header','Request Has an Empty Accept Header','notice',0,0,300,1,400,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Accept "@rx ^$" "id:920310,phase:1,pass,t:none,msg:''Request Has an Empty Accept Header'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''NOTICE'',chain"'),
	 (920311,'Request Has an Empty Accept Header','Request Has an Empty Accept Header','notice',0,0,300,1,400,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Accept "@rx ^$" "id:920311,phase:1,pass,t:none,msg:''Request Has an Empty Accept Header'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''NOTICE'',chain"'),
	 (920330,'Empty User Agent Header','Empty User Agent Header','notice',0,0,300,1,400,true,0,1742288288,0,'SecRule REQUEST_HEADERS:User-Agent "@rx ^$" "id:920330,phase:1,pass,t:none,msg:''Empty User Agent Header'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''NOTICE'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.notice_anomaly_score}''"'),
	 (920340,'Request Containing Content, but Missing Content-Type header','Request Containing Content, but Missing Content-Type header','notice',0,0,300,1,400,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Content-Length "!@rx ^0$" "id:920340,phase:1,pass,t:none,msg:''Request Containing Content, but Missing Content-Type header'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''NOTICE'',chain"'),
	 (920320,'Missing User Agent Header','Missing User Agent Header','notice',0,0,300,1,400,true,0,1742288288,0,'SecRule &REQUEST_HEADERS:User-Agent "@eq 0" "id:920320,phase:1,pass,t:none,msg:''Missing User Agent Header'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''PCI/6.5.10'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''NOTICE'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.notice_anomaly_score}''"'),
	 (920350,'Host header is a numeric IP address','Host header is a numeric IP address','warning',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Host "@rx (?:^([\\d.]+|\\[[\\da-f:]+\\]|[\\da-f:]+)(:[\\d]+)?$)" "id:920350,phase:1,block,t:none,msg:''Host header is a numeric IP address'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''PCI/6.5.10'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.warning_anomaly_score}''"'),
	 (920380,'Too many arguments in request','Too many arguments in request','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule &TX:MAX_NUM_ARGS "@eq 1" "id:920380,phase:2,block,t:none,msg:''Too many arguments in request'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (920360,'Argument name too long','Argument name too long','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule &TX:ARG_NAME_LENGTH "@eq 1" "id:920360,phase:2,block,t:none,msg:''Argument name too long'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (920370,'Argument value too long','Argument value too long','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule &TX:ARG_LENGTH "@eq 1" "id:920370,phase:2,block,t:none,msg:''Argument value too long'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (920390,'Total arguments size exceeded','Total arguments size exceeded','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule &TX:TOTAL_ARG_LENGTH "@eq 1" "id:920390,phase:2,block,t:none,msg:''Total arguments size exceeded'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (920400,'Uploaded file size too large','Uploaded file size too large','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule &TX:MAX_FILE_SIZE "@eq 1" "id:920400,phase:1,block,t:none,msg:''Uploaded file size too large'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (920410,'Total uploaded files size too large','Total uploaded files size too large','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule &TX:COMBINED_FILE_SIZES "@eq 1" "id:920410,phase:2,block,t:none,msg:''Total uploaded files size too large'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (920470,'Illegal Content-Type header','Illegal Content-Type header','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Content-Type "!@rx ^[\\w/.+*-]+(?:\\s?;\\s?(?:action|boundary|charset|component|start(?:-info)?|type|version)\\s?=\\s?[''\\"\\w.()+,/:=?<>@#*-]+)*$" "id:920470,phase:1,block,t:none,t:lowercase,msg:''Illegal Content-Type header'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153'',tag:''PCI/12.1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (920420,'Request content type is not allowed by policy','Request content type is not allowed by policy','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Content-Type "@rx ^[^;\\s]+" "id:920420,phase:1,block,capture,t:none,msg:''Request content type is not allowed by policy'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153'',tag:''PCI/12.1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.content_type=|%{tx.0}|'',chain"'),
	 (920480,'Request content type charset is not allowed by policy','Request content type charset is not allowed by policy','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Content-Type "@rx charset\\s*=\\s*[\\"'']?([^;\\"''\\s]+)" "id:920480,phase:1,block,capture,t:none,msg:''Request content type charset is not allowed by policy'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153'',tag:''PCI/12.1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.content_type_charset=|%{tx.1}|'',chain"'),
	 (920530,'Multiple charsets detected in content type header','Multiple charsets detected in content type header','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Content-Type "@rx charset.*?charset" "id:920530,phase:1,block,t:none,t:lowercase,msg:''Multiple charsets detected in content type header'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153'',tag:''PCI/12.1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (920430,'HTTP protocol version is not allowed by policy','HTTP protocol version is not allowed by policy','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_PROTOCOL "!@within %{tx.allowed_http_versions}" "id:920430,phase:1,block,t:none,msg:''HTTP protocol version is not allowed by policy'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''PCI/6.5.10'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (920440,'URL file extension is restricted by policy','URL file extension is restricted by policy','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_BASENAME "@rx \\.([^.]+)$" "id:920440,phase:1,block,capture,t:none,msg:''URL file extension is restricted by policy'',logdata:''%{TX.0}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''PCI/6.5.10'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.extension=.%{tx.1}/'',chain"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (921018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:921018,phase:2,pass,nolog,skipAfter:END-REQUEST-921-PROTOCOL-ATTACK"'),
	 (920500,'Attempt to access a backup or working file','Attempt to access a backup or working file','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_FILENAME "@rx \\.[^.~]+~(?:/.*|)$" "id:920500,phase:1,block,t:none,t:urlDecodeUni,msg:''Attempt to access a backup or working file'',logdata:''%{TX.0}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''PCI/6.5.10'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (920450,'HTTP header is restricted by policy (%{MATCHED_VAR})','HTTP header is restricted by policy (%{MATCHED_VAR})','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS_NAMES "@rx ^.*$" "id:920450,phase:1,block,capture,t:none,t:lowercase,msg:''HTTP header is restricted by policy (%{MATCHED_VAR})'',logdata:''Restricted header detected: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''PCI/12.1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.header_name_%{tx.0}=/%{tx.0}/'',chain"'),
	 (920520,'Accept-Encoding header exceeded sensible length','Accept-Encoding header exceeded sensible length','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Accept-Encoding "@gt 50" "id:920520,phase:1,block,t:none,t:lowercase,t:length,msg:''Accept-Encoding header exceeded sensible length'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153'',tag:''PCI/12.1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (920600,'Illegal Accept header: charset parameter','Illegal Accept header: charset parameter','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Accept "!@rx ^(?:(?:\\*|[^!-\\"\\(-\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!-\\"\\(-\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\v]*;[\\s\\v]*(?:charset[\\s\\v]*=[\\s\\v]*\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\"?|(?:[^\\s\\v -\\"\\(-\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]e\\{\\}]|e[^!-\\"\\(-\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!-\\"\\(-\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\v]*=[\\s\\v]*[^!\\(-\\),/:-\\?\\[-\\]\\{\\}]+);?)*(?:[\\s\\v]*,[\\s\\v]*(?:(?:\\*|[^!-\\"\\(-\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!-\\"\\(-\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\v]*;[\\s\\v]*(?:charset[\\s\\v]*=[\\s\\v]*\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\"?|(?:[^\\s\\v -\\"\\(-\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]e\\{\\}]|e[^!-\\"\\(-\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!-\\"\\(-\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\v]*=[\\s\\v]*[^!\\(-\\),/:-\\?\\[-\\]\\{\\}]+);?)*)*$" "id:920600,phase:1,block,t:none,t:lowercase,msg:''Illegal Accept header: charset parameter'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (920540,'Possible Unicode character bypass detected','Possible Unicode character bypass detected','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQBODY_PROCESSOR "!@streq JSON" "id:920540,phase:2,block,t:none,msg:''Possible Unicode character bypass detected'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153/267/72'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (920610,'Raw (unencoded) fragment in request URI','Raw (unencoded) fragment in request URI','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_URI_RAW "@contains #" "id:920610,phase:1,block,t:none,msg:''Raw (unencoded) fragment in request URI'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (920013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:920013,phase:1,pass,nolog,skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT"'),
	 (920014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:920014,phase:2,pass,nolog,skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT"'),
	 (920200,'Range: Too many fields (6 or more)','Range: Too many fields (6 or more)','warning',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Range|REQUEST_HEADERS:Request-Range "@rx ^bytes=(?:(?:\\d+)?-(?:\\d+)?\\s*,?\\s*){6}" "id:920200,phase:1,block,t:none,msg:''Range: Too many fields (6 or more)'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',chain"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (920201,'Range: Too many fields for pdf request (63 or more)','Range: Too many fields for pdf request (63 or more)','warning',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_BASENAME "@endsWith .pdf" "id:920201,phase:1,block,t:none,msg:''Range: Too many fields for pdf request (63 or more)'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',chain"'),
	 (920230,'Multiple URL Encoding Detected','Multiple URL Encoding Detected','warning',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS "@rx %[0-9a-fA-F]{2}" "id:920230,phase:2,block,t:none,msg:''Multiple URL Encoding Detected'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/255/153/267/120'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.warning_anomaly_score}''"'),
	 (920271,'Invalid character in request (non printable characters)','Invalid character in request (non printable characters)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_URI|REQUEST_HEADERS|ARGS|ARGS_NAMES "@validateByteRange 9,10,13,32-126,128-255" "id:920271,phase:2,block,t:none,t:urlDecodeUni,msg:''Invalid character in request (non printable characters)'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (949061,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 2" "id:949061,phase:2,pass,t:none,nolog,setvar:''tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}''"'),
	 (920121,'Attempted multipart/form-data bypass','Attempted multipart/form-data bypass','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule FILES_NAMES|FILES "@rx [''\\";=]" "id:920121,phase:2,block,t:none,t:urlDecodeUni,msg:''Attempted multipart/form-data bypass'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (920341,'Request Containing Content Requires Content-Type header','Request Containing Content Requires Content-Type header','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Content-Length "!@rx ^0$" "id:920341,phase:1,block,t:none,msg:''Request Containing Content Requires Content-Type header'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (920015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:920015,phase:1,pass,nolog,skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT"'),
	 (920016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:920016,phase:2,pass,nolog,skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT"'),
	 (920272,'Invalid character in request (outside of printable chars below ascii 127)','Invalid character in request (outside of printable chars below ascii 127)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_URI|REQUEST_HEADERS|ARGS|ARGS_NAMES|REQUEST_BODY "@validateByteRange 32-36,38-126" "id:920272,phase:2,block,t:none,t:urlDecodeUni,msg:''Invalid character in request (outside of printable chars below ascii 127)'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (920300,'Request Missing an Accept Header','Request Missing an Accept Header','notice',0,0,300,1,400,true,0,1742288288,0,'SecRule &REQUEST_HEADERS:Accept "@eq 0" "id:920300,phase:1,pass,t:none,msg:''Request Missing an Accept Header'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''PCI/6.5.10'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''NOTICE'',chain"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (920490,'Request header x-up-devcap-post-charset detected in combination with prefix \\''UP\\'' to User-Agent','Request header x-up-devcap-post-charset detected in combination with prefix \\''UP\\'' to User-Agent','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule &REQUEST_HEADERS:x-up-devcap-post-charset "@ge 1" "id:920490,phase:1,block,t:none,msg:''Request header x-up-devcap-post-charset detected in combination with prefix \\''UP\\'' to User-Agent'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''language-aspnet'',tag:''platform-windows'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (920510,'Invalid Cache-Control request header','Invalid Cache-Control request header','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule &REQUEST_HEADERS:Cache-Control "@gt 0" "id:920510,phase:1,block,t:none,msg:''Invalid Cache-Control request header'',logdata:''Invalid Cache-Control value in request found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''header-allowlist'',tag:''paranoia-level/3'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (920521,'Illegal Accept-Encoding header','Illegal Accept-Encoding header','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Accept-Encoding "!@rx br|compress|deflate|(?:pack200-)?gzip|identity|\\*|^$|aes128gcm|exi|zstd|x-(?:compress|gzip)" "id:920521,phase:1,block,t:none,t:lowercase,msg:''Illegal Accept-Encoding header'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/3'',tag:''OWASP_CRS'',tag:''capec/1000/255/153'',tag:''PCI/12.1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (920017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:920017,phase:1,pass,nolog,skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT"'),
	 (920018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:920018,phase:2,pass,nolog,skipAfter:END-REQUEST-920-PROTOCOL-ENFORCEMENT"'),
	 (920202,'Range: Too many fields for pdf request (6 or more)','Range: Too many fields for pdf request (6 or more)','warning',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_BASENAME "@endsWith .pdf" "id:920202,phase:1,block,t:none,msg:''Range: Too many fields for pdf request (6 or more)'',logdata:''%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''paranoia-level/4'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''WARNING'',chain"'),
	 (920273,'Invalid character in request (outside of very strict set)','Invalid character in request (outside of very strict set)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS|ARGS_NAMES|REQUEST_BODY "@validateByteRange 38,44-46,48-58,61,65-90,95,97-122" "id:920273,phase:2,block,t:none,t:urlDecodeUni,msg:''Invalid character in request (outside of very strict set)'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''paranoia-level/4'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}''"'),
	 (920274,'Invalid character in request headers (outside of very strict set)','Invalid character in request headers (outside of very strict set)','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS|!REQUEST_HEADERS:User-Agent|!REQUEST_HEADERS:Referer|!REQUEST_HEADERS:Cookie|!REQUEST_HEADERS:Sec-Fetch-User|!REQUEST_HEADERS:Sec-CH-UA|!REQUEST_HEADERS:Sec-CH-UA-Mobile "@validateByteRange 32,34,38,42-59,61,65-90,95,97-122" "id:920274,phase:1,block,t:none,t:urlDecodeUni,msg:''Invalid character in request headers (outside of very strict set)'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''paranoia-level/4'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}''"'),
	 (920275,'Invalid character in request headers (outside of very strict set)','Invalid character in request headers (outside of very strict set)','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Sec-Fetch-User|REQUEST_HEADERS:Sec-CH-UA-Mobile "!@rx ^(?:\\?[01])?$" "id:920275,phase:1,block,t:none,t:urlDecodeUni,msg:''Invalid character in request headers (outside of very strict set)'',logdata:''%{MATCHED_VAR_NAME}=%{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/210/272'',tag:''paranoia-level/4'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}''"'),
	 (920460,'Abnormal character escapes in request','Abnormal character escapes in request','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_URI|REQUEST_HEADERS|ARGS|ARGS_NAMES "@rx (?:^|[^\\x5c])\\x5c[cdeghijklmpqwxyz123456789]" "id:920460,phase:2,block,capture,t:none,t:htmlEntityDecode,t:lowercase,msg:''Abnormal character escapes in request'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/4'',tag:''OWASP_CRS'',tag:''capec/1000/153/267'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.http_violation_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (921011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:921011,phase:1,pass,nolog,skipAfter:END-REQUEST-921-PROTOCOL-ATTACK"'),
	 (921012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:921012,phase:2,pass,nolog,skipAfter:END-REQUEST-921-PROTOCOL-ATTACK"'),
	 (921110,'HTTP Request Smuggling Attack','HTTP Request Smuggling Attack','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS_NAMES|ARGS|REQUEST_BODY|XML:/* "@rx (?:get|post|head|options|connect|put|delete|trace|track|patch|propfind|propatch|mkcol|copy|move|lock|unlock)\\s+[^\\s]+\\s+http/\\d" "id:921110,phase:2,block,capture,t:none,t:htmlEntityDecode,t:lowercase,msg:''HTTP Request Smuggling Attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272/220/33'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.http_violation_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (921120,'HTTP Response Splitting Attack','HTTP Response Splitting Attack','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx [\\r\\n]\\W*?(?:content-(?:type|length)|set-cookie|location):\\s*\\w" "id:921120,phase:2,block,capture,t:none,t:lowercase,msg:''HTTP Response Splitting Attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272/220/34'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.http_violation_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (921130,'HTTP Response Splitting Attack','HTTP Response Splitting Attack','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?:\\bhttp/\\d|<(?:html|meta)\\b)" "id:921130,phase:2,block,capture,t:none,t:htmlEntityDecode,t:lowercase,msg:''HTTP Response Splitting Attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272/220/34'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.http_violation_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (921140,'HTTP Header Injection Attack via headers','HTTP Header Injection Attack via headers','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS_NAMES|REQUEST_HEADERS "@rx [\\n\\r]" "id:921140,phase:1,block,capture,t:none,t:htmlEntityDecode,msg:''HTTP Header Injection Attack via headers'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272/220/273'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.http_violation_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (921150,'HTTP Header Injection Attack via payload (CR/LF detected)','HTTP Header Injection Attack via payload (CR/LF detected)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS_NAMES "@rx [\\n\\r]" "id:921150,phase:2,block,capture,t:none,t:htmlEntityDecode,msg:''HTTP Header Injection Attack via payload (CR/LF detected)'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272/220/33'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.http_violation_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (921160,'HTTP Header Injection Attack via payload (CR/LF and header-name detected)','HTTP Header Injection Attack via payload (CR/LF and header-name detected)','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule ARGS_GET_NAMES|ARGS_GET "@rx [\\n\\r]+(?:\\s|location|refresh|(?:set-)?cookie|(?:x-)?(?:forwarded-(?:for|host|server)|host|via|remote-ip|remote-addr|originating-IP))\\s*:" "id:921160,phase:1,block,capture,t:none,t:htmlEntityDecode,t:lowercase,msg:''HTTP Header Injection Attack via payload (CR/LF and header-name detected)'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272/220/33'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.http_violation_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (921190,'HTTP Splitting (CR/LF in request filename detected)','HTTP Splitting (CR/LF in request filename detected)','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_FILENAME "@rx [\\n\\r]" "id:921190,phase:1,block,t:none,t:urlDecodeUni,msg:''HTTP Splitting (CR/LF in request filename detected)'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272/220/34'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.http_violation_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (921200,'LDAP Injection Attack','LDAP Injection Attack','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx ^[^:\\(\\)\\&\\|\\!\\<\\>\\~]*\\)\\s*(?:\\((?:[^,\\(\\)\\=\\&\\|\\!\\<\\>\\~]+[><~]?=|\\s*[&!|]\\s*(?:\\)|\\()?\\s*)|\\)\\s*\\(\\s*[\\&\\|\\!]\\s*|[&!|]\\s*\\([^\\(\\)\\=\\&\\|\\!\\<\\>\\~]+[><~]?=[^:\\(\\)\\&\\|\\!\\<\\>\\~]*)" "id:921200,phase:2,block,capture,t:none,t:htmlEntityDecode,msg:''LDAP Injection Attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-ldap'',tag:''platform-multi'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/136'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (921421,'Content-Type header: Dangerous content type outside the mime type declaration','Content-Type header: Dangerous content type outside the mime type declaration','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Content-Type "@rx ^[^\\s\\v,;]+[\\s\\v,;].*?(?:application/(?:.+\\+)?json|(?:application/(?:soap\\+)?|text/)xml)" "id:921421,phase:1,block,capture,t:none,t:lowercase,msg:''Content-Type header: Dangerous content type outside the mime type declaration'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153'',tag:''PCI/12.1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (921240,'mod_proxy attack attempt detected','mod_proxy attack attempt detected','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_URI "@rx unix:[^|]*\\|" "id:921240,phase:1,block,capture,t:none,t:lowercase,msg:''mod_proxy attack attempt detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-apache'',tag:''attack-protocol'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/210/272/220/33'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (921013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:921013,phase:1,pass,nolog,skipAfter:END-REQUEST-921-PROTOCOL-ATTACK"'),
	 (921014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:921014,phase:2,pass,nolog,skipAfter:END-REQUEST-921-PROTOCOL-ATTACK"'),
	 (921151,'HTTP Header Injection Attack via payload (CR/LF detected)','HTTP Header Injection Attack via payload (CR/LF detected)','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule ARGS_GET "@rx [\\n\\r]" "id:921151,phase:1,block,capture,t:none,t:urlDecodeUni,t:htmlEntityDecode,msg:''HTTP Header Injection Attack via payload (CR/LF detected)'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/210/272/220/33'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.http_violation_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (921422,'Content-Type header: Dangerous content type outside the mime type declaration','Content-Type header: Dangerous content type outside the mime type declaration','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Content-Type "@rx ^[^\\s\\v,;]+[\\s\\v,;].*?\\b(?:((?:tex|multipar)t|application)|((?:audi|vide)o|image|cs[sv]|(?:vn|relate)d|p(?:df|lain)|json|(?:soa|cs)p|x(?:ml|-www-form-urlencoded)|form-data|x-amf|(?:octe|repor)t|stream)|([\\+/]))\\b" "id:921422,phase:1,block,capture,t:none,t:lowercase,msg:''Content-Type header: Dangerous content type outside the mime type declaration'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/255/153'',tag:''PCI/12.1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (921015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:921015,phase:1,pass,nolog,skipAfter:END-REQUEST-921-PROTOCOL-ATTACK"'),
	 (921016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:921016,phase:2,pass,nolog,skipAfter:END-REQUEST-921-PROTOCOL-ATTACK"'),
	 (921230,'HTTP Range Header detected','HTTP Range Header detected','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule &REQUEST_HEADERS:Range "@gt 0" "id:921230,phase:1,block,t:none,msg:''HTTP Range Header detected'',logdata:''Matched Data: Header %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''paranoia-level/3'',tag:''OWASP_CRS'',tag:''capec/1000/210/272/220'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (921170,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule ARGS_NAMES "@rx ." "id:921170,phase:2,pass,nolog,tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/152/137/15/460'',ver:''OWASP_CRS/4.0.0-rc1'',setvar:''TX.paramcounter_%{MATCHED_VAR_NAME}=+1''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (921180,'HTTP Parameter Pollution (%{TX.1})','HTTP Parameter Pollution (%{TX.1})','critical',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:/paramcounter_.*/ "@gt 1" "id:921180,phase:2,pass,msg:''HTTP Parameter Pollution (%{TX.1})'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/152/137/15/460'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (921210,'HTTP Parameter Pollution after detecting bogus char after parameter array','HTTP Parameter Pollution after detecting bogus char after parameter array','critical',0,0,300,2,400,true,0,1742288288,0,'SecRule ARGS_NAMES "@rx (][^\\]]+$|][^\\]]+\\[)" "id:921210,phase:2,pass,log,msg:''HTTP Parameter Pollution after detecting bogus char after parameter array'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/152/137/15/460'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.http_violation_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (921017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:921017,phase:1,pass,nolog,skipAfter:END-REQUEST-921-PROTOCOL-ATTACK"'),
	 (921220,'HTTP Parameter Pollution possible via array notation','HTTP Parameter Pollution possible via array notation','critical',0,0,300,2,400,true,0,1742288288,0,'SecRule ARGS_NAMES "@rx \\[" "id:921220,phase:2,pass,log,msg:''HTTP Parameter Pollution possible via array notation'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/1000/152/137/15/460'',tag:''paranoia-level/4'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.http_violation_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}''"'),
	 (922100,'Multipart content type global _charset_ definition is not allowed by policy','Multipart content type global _charset_ definition is not allowed by policy','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule &MULTIPART_PART_HEADERS:_charset_ "!@eq 0" "id:922100,phase:2,block,t:none,msg:''Multipart content type global _charset_ definition is not allowed by policy'',logdata:''Matched Data: %{ARGS._charset_}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-multipart-header'',tag:''OWASP_CRS'',tag:''capec/1000/255/153'',tag:''paranoia-level/1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (922110,'Illegal MIME Multipart Header content-type: charset parameter','Illegal MIME Multipart Header content-type: charset parameter','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule MULTIPART_PART_HEADERS "@rx ^content-type\\s*:\\s*(.*)$" "id:922110,phase:2,block,capture,t:none,t:lowercase,msg:''Illegal MIME Multipart Header content-type: charset parameter'',logdata:''Matched Data: %{TX.1} found within Content-Type multipart form'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-protocol'',tag:''OWASP_CRS'',tag:''capec/272/220'',tag:''paranoia-level/1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (922120,'Content-Transfer-Encoding was deprecated by rfc7578 in 2015 and should not be used','Content-Transfer-Encoding was deprecated by rfc7578 in 2015 and should not be used','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule MULTIPART_PART_HEADERS "@rx content-transfer-encoding:(.*)" "id:922120,phase:2,block,capture,t:none,t:lowercase,msg:''Content-Transfer-Encoding was deprecated by rfc7578 in 2015 and should not be used'',logdata:''Matched Data: %{TX.0}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-deprecated-header'',tag:''OWASP_CRS'',tag:''capec/272/220'',tag:''paranoia-level/1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (930011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:930011,phase:1,pass,nolog,skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI"'),
	 (930012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:930012,phase:2,pass,nolog,skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI"'),
	 (930100,'Path Traversal Attack (/../) or (/.../)','Path Traversal Attack (/../) or (/.../)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_URI_RAW|ARGS|REQUEST_HEADERS|!REQUEST_HEADERS:Referer|FILES|XML:/* "@rx (?i)(?:[/\\x5c]|%(?:2(?:f|5(?:2f|5c|c(?:1%259c|0%25af))|%46)|5c|c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|(?:bg%q|(?:e|f(?:8%8)?0%8)0%80%a)f|u(?:221[5-6]|EFC8|F025|002f)|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|1u)|0x(?:2f|5c))(?:\\.(?:%0[0-1]|\\?)?|\\?\\.?|%(?:2(?:(?:5(?:2|c0%25a))?e|%45)|c0(?:\\.|%[25-6ae-f]e)|u(?:(?:ff0|002)e|2024)|%32(?:%(?:%6|4)5|E)|(?:e|f(?:(?:8|c%80)%8)?0%8)0%80%ae)|0x2e){2,3}(?:[/\\x5c]|%(?:2(?:f|5(?:2f|5c|c(?:1%259c|0%25af))|%46)|5c|c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|(?:bg%q|(?:e|f(?:8%8)?0%8)0%80%a)f|u(?:221[5-6]|EFC8|F025|002f)|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|1u)|0x(?:2f|5c))" "id:930100,phase:2,block,capture,t:none,msg:''Path Traversal Attack (/../) or (/.../)'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-lfi'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153/126'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.lfi_score=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (930110,'Path Traversal Attack (/../) or (/.../)','Path Traversal Attack (/../) or (/.../)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_URI|ARGS|REQUEST_HEADERS|!REQUEST_HEADERS:Referer|FILES|XML:/* "@rx (?:(?:^|[\\x5c/;])\\.{2,3}[\\x5c/;]|[\\x5c/;]\\.{2,3}(?:[\\x5c/;]|$))" "id:930110,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:removeNulls,t:cmdLine,msg:''Path Traversal Attack (/../) or (/.../)'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-lfi'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153/126'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',multiMatch,setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}'',setvar:''tx.lfi_score=+%{tx.critical_anomaly_score}''"'),
	 (930120,'OS File Access Attempt','OS File Access Attempt','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@pmFromFile lfi-os-files.data" "id:930120,phase:2,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:normalizePathWin,msg:''OS File Access Attempt'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-lfi'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153/126'',tag:''PCI/6.5.4'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.lfi_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (930130,'Restricted File Access Attempt','Restricted File Access Attempt','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_FILENAME "@pmFromFile restricted-files.data" "id:930130,phase:1,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:normalizePathWin,msg:''Restricted File Access Attempt'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-lfi'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/255/153/126'',tag:''PCI/6.5.4'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.lfi_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (930013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:930013,phase:1,pass,nolog,skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI"'),
	 (930014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:930014,phase:2,pass,nolog,skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI"'),
	 (950016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:950016,phase:4,pass,nolog,skipAfter:END-RESPONSE-950-DATA-LEAKAGES"'),
	 (930121,'OS File Access Attempt in REQUEST_HEADERS','OS File Access Attempt in REQUEST_HEADERS','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:Referer|REQUEST_HEADERS:User-Agent "@pmFromFile lfi-os-files.data" "id:930121,phase:1,block,capture,t:none,t:utf8toUnicode,t:urlDecodeUni,t:normalizePathWin,msg:''OS File Access Attempt in REQUEST_HEADERS'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-lfi'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/255/153/126'',tag:''PCI/6.5.4'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.lfi_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (930015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:930015,phase:1,pass,nolog,skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI"'),
	 (930016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:930016,phase:2,pass,nolog,skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI"'),
	 (930017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:930017,phase:1,pass,nolog,skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (930018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:930018,phase:2,pass,nolog,skipAfter:END-REQUEST-930-APPLICATION-ATTACK-LFI"'),
	 (931011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:931011,phase:1,pass,nolog,skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI"'),
	 (931012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:931012,phase:2,pass,nolog,skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI"'),
	 (931100,'Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address','Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS "@rx ^(?i:file|ftps?|https?)://(?:\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" "id:931100,phase:2,block,capture,t:none,msg:''Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-rfi'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/175/253'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rfi_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (931110,'Possible Remote File Inclusion (RFI) Attack: Common RFI Vulnerable Parameter Name used w/URL Payload','Possible Remote File Inclusion (RFI) Attack: Common RFI Vulnerable Parameter Name used w/URL Payload','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule QUERY_STRING|REQUEST_BODY "@rx (?i)(?:\\binclude\\s*\\([^)]*|mosConfig_absolute_path|_CONF\\[path\\]|_SERVER\\[DOCUMENT_ROOT\\]|GALLERY_BASEDIR|path\\[docroot\\]|appserv_root|config\\[root_dir\\])=(?:file|ftps?|https?)://" "id:931110,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Possible Remote File Inclusion (RFI) Attack: Common RFI Vulnerable Parameter Name used w/URL Payload'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-rfi'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/175/253'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rfi_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (931120,'Possible Remote File Inclusion (RFI) Attack: URL Payload Used w/Trailing Question Mark Character (?)','Possible Remote File Inclusion (RFI) Attack: URL Payload Used w/Trailing Question Mark Character (?)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS "@rx ^(?i:file|ftps?|https?).*?\\?+$" "id:931120,phase:2,block,capture,t:none,msg:''Possible Remote File Inclusion (RFI) Attack: URL Payload Used w/Trailing Question Mark Character (?)'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-rfi'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/175/253'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rfi_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (931013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:931013,phase:1,pass,nolog,skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI"'),
	 (931014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:931014,phase:2,pass,nolog,skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI"'),
	 (931130,'Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link','Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS "@rx (?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[^@]+@)?([^/]*)" "id:931130,phase:2,block,capture,t:none,msg:''Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-rfi'',tag:''OWASP_CRS'',tag:''capec/1000/152/175/253'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}'',chain"'),
	 (932171,'Remote Command Execution: Shellshock (CVE-2014-6271)','Remote Command Execution: Shellshock (CVE-2014-6271)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS_NAMES|ARGS|FILES_NAMES "@rx ^\\(\\s*\\)\\s+{" "id:932171,phase:2,block,capture,t:none,t:urlDecode,t:urlDecodeUni,msg:''Remote Command Execution: Shellshock (CVE-2014-6271)'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (931131,'Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link','Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_FILENAME "@rx (?i)(?:(?:url|jar):)?(?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[^@]+@)?([^/]*)" "id:931131,phase:1,block,capture,t:none,t:urlDecodeUni,msg:''Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-rfi'',tag:''OWASP_CRS'',tag:''capec/1000/152/175/253'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rfi_parameter_%{MATCHED_VAR_NAME}=.%{tx.1}'',chain"'),
	 (931015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:931015,phase:1,pass,nolog,skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI"'),
	 (931016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:931016,phase:2,pass,nolog,skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI"'),
	 (931017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:931017,phase:1,pass,nolog,skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI"'),
	 (931018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:931018,phase:2,pass,nolog,skipAfter:END-REQUEST-931-APPLICATION-ATTACK-RFI"'),
	 (932011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:932011,phase:1,pass,nolog,skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE"'),
	 (932012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:932012,phase:2,pass,nolog,skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE"'),
	 (932230,'Remote Command Execution: Unix Command Injection (2-3 chars)','Remote Command Execution: Unix Command Injection (2-3 chars)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)(?:t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?e|[\\n\\r;`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|\\{)|[<>]\\(|\\([\\s\\v]*\\))[\\s\\v]*(?:[\\$\\{]|(?:[\\s\\v]*\\(|!)[\\s\\v]*|[0-9A-Z_a-z]+=(?:[^\\s\\v]*|\\$(?:.*|.*)|[<>].*|''.*''|\\".*\\")[\\s\\v]+)*[\\s\\v]*[\\"'']*(?:[\\"''-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\"''\\x5c]*(?:7[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?z(?:[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[ar])?|a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:(?:[bt]|w[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[ks])[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?t|r[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[\\s\\v&,<>\\|].*|[jp])|s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[\\s\\v&,<>\\|].*|h))|(?:(?:b[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?z[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?z|h[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:d|u[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p)|n[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[cl]|e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?t|(?:p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)?m)|o[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?d|u[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?l)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?|v[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)?)[\\s\\v&,<>\\|].*|c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[8-9][\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?9|(?:[au][\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?t|[cp])[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p|s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?h)|d[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[du][\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?g|n[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?f)|e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:(?:[bdx]|n[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?v)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|q[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?n)|f[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:(?:c|t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|i|m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?t)|g[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:(?:c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[&,<>\\|]|(?:[\\--\\.0-9A-Z_a-z][\\"''\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)+[\\s\\v&,<>\\|])|(?:e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m|i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?t|o)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|]).*|d[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?b|[hr][\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?c)|i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:d[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|p|r[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?b)|j[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:j[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?s|q)|k[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?h|l[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:(?:d[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:d[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)?|(?:[npz]|u[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?a)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)[\\s\\v&,<>\\|].*|s)|m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:(?:a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?n|v)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?r)|p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:(?:(?:a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?x|f|h[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?|r[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:y[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)?)[\\s\\v&,<>\\|].*|d[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?b|(?:k[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)?g|i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:c|p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[&,<>\\|]|(?:[\\--\\.0-9A-Z_a-z][\\"''\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)+[\\s\\v&,<>\\|]).*)|s|t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?x|x[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?z)|r[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:(?:a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?r|c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p|(?:p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)?m)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:d[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|v))|s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p|(?:(?:e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[dt]|u)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?|s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:h[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)?)[\\s\\v&,<>\\|].*|[g-h]|v[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?n)|t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:c|r[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*)|b[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?l|e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[ex]|i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|o[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p)|w[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:3[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m|c|h[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?o)|x[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:x[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?d|z[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*)|y[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?u[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m|z[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p|s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?h))\\b" "id:932230,phase:2,block,capture,t:none,msg:''Remote Command Execution: Unix Command Injection (2-3 chars)'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (932235,'Remote Command Execution: Unix Command Injection (command without evasion)','Remote Command Execution: Unix Command Injection (command without evasion)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)(?:t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?e|[\\n\\r;`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|\\{)|[<>]\\(|\\([\\s\\v]*\\))[\\s\\v]*(?:[\\$\\{]|(?:[\\s\\v]*\\(|!)[\\s\\v]*|[0-9A-Z_a-z]+=(?:[^\\s\\v]*|\\$(?:.*|.*)|[<>].*|''.*''|\\".*\\")[\\s\\v]+)*[\\s\\v]*[\\"'']*(?:[\\"''-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\"''\\x5c]*(?:a(?:dduser|getty|l(?:ias|pine)[\\s\\v<>]|nsible-playbook|pt-get|r(?:ch[\\s\\v<>]|ia2c)|s(?:cii(?:-xfr|85)|pell)|tobm)|b(?:a(?:s(?:e(?:32|64|nc)|h)|tch[\\s\\v<>])|pftrace|r(?:eaksw|idge[\\s\\v<>])|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler[\\s\\v<>]|zip2)|s(?:ctl|ybox))|yebug|z(?:c(?:at|mp)|diff|e(?:grep|xe)|f?grep|ip2|less|more))|c(?:a(?:ncel|psh)[\\s\\v<>]|ertbot|h(?:attr|dir[\\s\\v<>]|eck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|flags|mod|o(?:om|wn)|root)|o(?:(?:b|pro)c|lumn[\\s\\v<>]|m(?:m(?:and[\\s\\v<>])?|p(?:oser|ress[\\s\\v<>]))|w(?:say|think))|p(?:an|io|ulimit)|r(?:ash[\\s\\v<>]|ontab)|s(?:plit|vtool)|u(?:psfilter|rl))|d(?:(?:a(?:sh|te)|i(?:alog|ff))[\\s\\v<>]|hclient|m(?:esg|idecode|setup)|o(?:as|(?:cker|ne)[\\s\\v<>]|sbox)|pkg|vips)|e(?:(?:asy_instal|va)l|cho[\\s\\v<>]|fax|grep|macs|n(?:d(?:if|sw)|v-update)|sac|x(?:ec[\\s\\v<>]|iftool|p(?:(?:and|(?:ec|or)t)[\\s\\v<>]|r)))|f(?:acter|(?:etch|lock)[\\s\\v<>]|grep|i(?:le(?:[\\s\\v<>]|test)|(?:n(?:d|ger)|sh)[\\s\\v<>])|o(?:ld[\\s\\v<>]|reach)|ping|tp(?:stats|who)|unction)|g(?:awk|core|e(?:ni(?:e[\\s\\v<>]|soimage)|tfacl[\\s\\v<>])|hci|i(?:mp[\\s\\v<>]|nsh)|rep[\\s\\v<>]|tester|unzip|z(?:cat|exe|ip))|h(?:e(?:ad[\\s\\v<>]|xdump)|i(?:ghlight|story)[\\s\\v<>]|ost(?:id|name)|ping3|t(?:digest|passwd))|i(?:conv|f(?:config|top)|nstall[\\s\\v<>]|onice|p(?:6?tables|config)|spell)|j(?:ava[\\s\\v<>]|exec|o(?:(?:bs|in)[\\s\\v<>]|urnalctl)|runscript)|k(?:ill(?:[\\s\\v<>]|all)|nife[\\s\\v<>]|sshell)|l(?:a(?:st(?:[\\s\\v<>]|comm|log(?:in)?)|tex[\\s\\v<>])|dconfig|ess(?:[\\s\\v<>]|echo|(?:fil|pip)e)|ftp(?:get)?|(?:inks|ynx)[\\s\\v<>]|o(?:(?:ca(?:l|te)|ok)[\\s\\v<>]|g(?:inctl|(?:nam|sav)e))|s(?:-F|b_release|cpu|hw|mod|of|pci|usb)|trace|ua(?:la)?tex|wp-(?:d(?:ownload|ump)|mirror|request)|z(?:c(?:at|mp)|diff|[e-f]?grep|less|m(?:a|ore)))|m(?:a(?:il(?:q|x[\\s\\v<>])?|ke[\\s\\v<>]|wk)|(?:kdir|utt)[\\s\\v<>]|locate|o(?:(?:re|unt)[\\s\\v<>]|squitto)|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:admin|dump(?:slow)?|hotcopy|show)?)|n(?:a(?:no[\\s\\v<>]|sm|wk)|c(?:\\.(?:openbsd|traditional)|at)|e(?:ofetch|t(?:(?:c|st)at|kit-ftp))|ice[\\s\\v<>]|map|o(?:de[\\s\\v<>]|hup)|ping|roff|s(?:enter|lookup|tat))|o(?:ctave[\\s\\v<>]|nintr|p(?:en(?:ssl|v(?:pn|t))|kg))|p(?:a(?:s(?:swd|te[\\s\\v<>])|tch[\\s\\v<>])|df(?:la)?tex|er(?:f|l(?:5|sh)?|ms)|(?:ft|gre)p|i(?:(?:co|ng)[\\s\\v<>]|dstat|gz)|k(?:exec|g_?info|ill)|opd|rint(?:env|f[\\s\\v<>])|s(?:ftp|ql)|tar(?:diff|grep)?|ython[^\\s\\v]|u(?:ppet[\\s\\v<>]|shd))|r(?:ak(?:e[\\s\\v<>]|u)|e(?:a(?:delf|lpath)|(?:dcarpet|name|p(?:eat|lace))[\\s\\v<>]|stic)|l(?:ogin|wrap)|m(?:dir[\\s\\v<>]|user)|nano|oute[\\s\\v<>]|pm(?:db|(?:quer|verif)y)|sync|u(?:by[^\\s\\v]|n-(?:mailcap|parts))|vi(?:ew|m))|s(?:(?:ash|nap|plit)[\\s\\v<>]|c(?:hed|r(?:een|ipt)[\\s\\v<>])|diff|e(?:ndmail|rvice[\\s\\v<>]|t(?:arch|env|facl[\\s\\v<>]|sid))|ftp|h(?:\\.distrib|ell|u(?:f|tdown[\\s\\v<>]))|l(?:eep[\\s\\v<>]|sh)|mbclient|o(?:cat|elim|(?:rt|urce)[\\s\\v<>])|qlite3|sh(?:-key(?:ge|sca)n|pass)|t(?:art-stop-daemon|dbuf|r(?:ace|ings))|udo|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:il[\\s\\v<>f]|sk(?:set)?)|c(?:l?sh|p(?:dump|ing|traceroute))|elnet|ftp|ime(?:(?:out)?[\\s\\v<>]|datectl)|mux|ouch[\\s\\v<>]|r(?:aceroute6?|off)|shark)|u(?:limit[\\s\\v<>]|n(?:ame|compress|expand|iq|l(?:ink[\\s\\v<>]|z(?:4|ma))|(?:pig|x)z|rar|s(?:et|hare)[\\s\\v<>]|z(?:ip|std))|pdate-alternatives|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:algrind|i(?:ew[\\s\\v<>]|gr|mdiff|pw|rsh)|olatility)|w(?:a(?:ll|tch)[\\s\\v<>]|get|h(?:iptail|o(?:ami|is))|i(?:reshark|sh[\\s\\v<>]))|x(?:args|e(?:la)?tex|mo(?:dmap|re)|pad|term|z(?:c(?:at|mp)|d(?:ec|iff)|[e-f]?grep|less|more))|y(?:arn|elp[\\s\\v<>])|z(?:athura|c(?:at|mp)|diff|[e-f]?grep|(?:ipdetail|les)s|more|run|s(?:oelim|td)|ypper))" "id:932235,phase:2,block,capture,t:none,msg:''Remote Command Execution: Unix Command Injection (command without evasion)'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (932115,'Remote Command Execution: Windows Command Injection','Remote Command Execution: Windows Command Injection','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)(?:t[\\"\\^]*i[\\"\\^]*m[\\"\\^]*e|[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\v]*[\\s\\v\\"''-\\(,@]*(?:[\\"''\\.-9A-Z_a-z]+/|(?:[\\"''\\x5c\\^]*[0-9A-Z_a-z][\\"''\\x5c\\^]*:.*|[ \\"''\\.-9A-Z\\x5c\\^-_a-z]*)\\x5c)?[\\"\\^]*(?:o[\\"\\^]*(?:d[\\"\\^]*b[\\"\\^]*c[\\"\\^]*(?:a[\\"\\^]*d[\\"\\^]*3[\\"\\^]*2|c[\\"\\^]*o[\\"\\^]*n[\\"\\^]*f)|p[\\"\\^]*e[\\"\\^]*n[\\"\\^]*f[\\"\\^]*i[\\"\\^]*l[\\"\\^]*e[\\"\\^]*s)|p[\\"\\^]*(?:a[\\"\\^]*t[\\"\\^]*h[\\"\\^]*(?:[\\s\\v,\\.-/;-<>].*|p[\\"\\^]*i[\\"\\^]*n[\\"\\^]*g)|e[\\"\\^]*r[\\"\\^]*(?:f[\\"\\^]*m[\\"\\^]*o[\\"\\^]*n|l(?:[\\"\\^]*(?:5|s[\\"\\^]*h))?)|h[\\"\\^]*p(?:[\\"\\^]*[57])?|i[\\"\\^]*n[\\"\\^]*g|k[\\"\\^]*g[\\"\\^]*m[\\"\\^]*g[\\"\\^]*r|o[\\"\\^]*(?:p[\\"\\^]*d|r[\\"\\^]*t[\\"\\^]*q[\\"\\^]*r[\\"\\^]*y|w[\\"\\^]*e[\\"\\^]*r[\\"\\^]*(?:c[\\"\\^]*f[\\"\\^]*g|s[\\"\\^]*h[\\"\\^]*e[\\"\\^]*l[\\"\\^]*l(?:[\\"\\^]*_[\\"\\^]*i[\\"\\^]*s[\\"\\^]*e)?))|r[\\"\\^]*(?:i[\\"\\^]*n[\\"\\^]*t[\\"\\^]*(?:[\\s\\v,\\.-/;-<>].*|b[\\"\\^]*r[\\"\\^]*m)|n[\\"\\^]*(?:c[\\"\\^]*n[\\"\\^]*f[\\"\\^]*g|m[\\"\\^]*n[\\"\\^]*g[\\"\\^]*r)|o[\\"\\^]*m[\\"\\^]*p[\\"\\^]*t)|s[\\"\\^]*(?:e[\\"\\^]*x[\\"\\^]*e[\\"\\^]*c|f[\\"\\^]*i[\\"\\^]*l[\\"\\^]*e|g[\\"\\^]*e[\\"\\^]*t[\\"\\^]*s[\\"\\^]*i[\\"\\^]*d|i[\\"\\^]*n[\\"\\^]*f[\\"\\^]*o|k[\\"\\^]*i[\\"\\^]*l[\\"\\^]*l|l[\\"\\^]*(?:i[\\"\\^]*s[\\"\\^]*t|o[\\"\\^]*g[\\"\\^]*(?:g[\\"\\^]*e[\\"\\^]*d[\\"\\^]*o[\\"\\^]*n|l[\\"\\^]*i[\\"\\^]*s[\\"\\^]*t))|p[\\"\\^]*(?:a[\\"\\^]*s[\\"\\^]*s[\\"\\^]*w[\\"\\^]*d|i[\\"\\^]*n[\\"\\^]*g)|s[\\"\\^]*(?:e[\\"\\^]*r[\\"\\^]*v[\\"\\^]*i[\\"\\^]*c[\\"\\^]*e|h[\\"\\^]*u[\\"\\^]*t[\\"\\^]*d[\\"\\^]*o[\\"\\^]*w[\\"\\^]*n|u[\\"\\^]*s[\\"\\^]*p[\\"\\^]*e[\\"\\^]*n[\\"\\^]*d))|u[\\"\\^]*s[\\"\\^]*h[\\"\\^]*d|y[\\"\\^]*t[\\"\\^]*h[\\"\\^]*o[\\"\\^]*n(?:[\\"\\^]*(?:2|3(?:[\\"\\^]*m)?))?)|q[\\"\\^]*(?:g[\\"\\^]*r[\\"\\^]*e[\\"\\^]*p|p[\\"\\^]*r[\\"\\^]*o[\\"\\^]*c[\\"\\^]*e[\\"\\^]*s[\\"\\^]*s|u[\\"\\^]*e[\\"\\^]*r[\\"\\^]*y[\\"\\^]*[\\s\\v,\\.-/;-<>].*|w[\\"\\^]*i[\\"\\^]*n[\\"\\^]*s[\\"\\^]*t[\\"\\^]*a)|r[\\"\\^]*(?:a[\\"\\^]*(?:r[\\"\\^]*[\\s\\v,\\.-/;-<>].*|s[\\"\\^]*(?:d[\\"\\^]*i[\\"\\^]*a[\\"\\^]*l|p[\\"\\^]*h[\\"\\^]*o[\\"\\^]*n[\\"\\^]*e))|d[\\"\\^]*[\\s\\v,\\.-/;-<>].*|e[\\"\\^]*(?:c[\\"\\^]*(?:d[\\"\\^]*i[\\"\\^]*s[\\"\\^]*c|o[\\"\\^]*v[\\"\\^]*e[\\"\\^]*r)|g[\\"\\^]*(?:[\\s\\v,\\.-/;-<>].*|e[\\"\\^]*d[\\"\\^]*i[\\"\\^]*t|i[\\"\\^]*n[\\"\\^]*i|s[\\"\\^]*v[\\"\\^]*r[\\"\\^]*3[\\"\\^]*2)|k[\\"\\^]*e[\\"\\^]*y[\\"\\^]*w[\\"\\^]*i[\\"\\^]*z|(?:n[\\"\\^]*(?:a[\\"\\^]*m[\\"\\^]*e[\\"\\^]*)?|(?:p[\\"\\^]*l[\\"\\^]*a[\\"\\^]*c[\\"\\^]*e|s[\\"\\^]*e[\\"\\^]*t)[\\"\\^]*)[\\s\\v,\\.-/;-<>].*)|m[\\"\\^]*(?:(?:d[\\"\\^]*i[\\"\\^]*r[\\"\\^]*)?[\\s\\v,\\.-/;-<>].*|t[\\"\\^]*s[\\"\\^]*h[\\"\\^]*a[\\"\\^]*r[\\"\\^]*e)|o[\\"\\^]*(?:b[\\"\\^]*o[\\"\\^]*c[\\"\\^]*o[\\"\\^]*p[\\"\\^]*y|u[\\"\\^]*t[\\"\\^]*e[\\"\\^]*[\\s\\v,\\.-/;-<>].*)|s[\\"\\^]*(?:t[\\"\\^]*r[\\"\\^]*u[\\"\\^]*i|y[\\"\\^]*n[\\"\\^]*c)|u[\\"\\^]*(?:b[\\"\\^]*y[\\"\\^]*(?:1(?:[\\"\\^]*[8-9])?|2[\\"\\^]*[0-2])|n[\\"\\^]*(?:a[\\"\\^]*s|d[\\"\\^]*l[\\"\\^]*l[\\"\\^]*3[\\"\\^]*2)))|s[\\"\\^]*(?:c[\\"\\^]*(?:h[\\"\\^]*t[\\"\\^]*a[\\"\\^]*s[\\"\\^]*k[\\"\\^]*s|l[\\"\\^]*i[\\"\\^]*s[\\"\\^]*t)|e[\\"\\^]*(?:c[\\"\\^]*p[\\"\\^]*o[\\"\\^]*l|l[\\"\\^]*e[\\"\\^]*c[\\"\\^]*t|t[\\"\\^]*(?:(?:x[\\"\\^]*)?[\\s\\v,\\.-/;-<>].*|l[\\"\\^]*o[\\"\\^]*c[\\"\\^]*a[\\"\\^]*l))|f[\\"\\^]*c|h[\\"\\^]*(?:a[\\"\\^]*r[\\"\\^]*e|e[\\"\\^]*l[\\"\\^]*l[\\"\\^]*r[\\"\\^]*u[\\"\\^]*n[\\"\\^]*a[\\"\\^]*s|i[\\"\\^]*f[\\"\\^]*t|o[\\"\\^]*(?:r[\\"\\^]*t[\\"\\^]*c[\\"\\^]*u[\\"\\^]*t|w[\\"\\^]*(?:g[\\"\\^]*r[\\"\\^]*p|m[\\"\\^]*b[\\"\\^]*r)[\\"\\^]*s)|r[\\"\\^]*p[\\"\\^]*u[\\"\\^]*b[\\"\\^]*w|u[\\"\\^]*t[\\"\\^]*d[\\"\\^]*o[\\"\\^]*w[\\"\\^]*n)|i[\\"\\^]*g[\\"\\^]*v[\\"\\^]*e[\\"\\^]*r[\\"\\^]*i[\\"\\^]*f|l[\\"\\^]*(?:e[\\"\\^]*e[\\"\\^]*p|m[\\"\\^]*g[\\"\\^]*r)|(?:o|t[\\"\\^]*a)[\\"\\^]*r[\\"\\^]*t[\\"\\^]*[\\s\\v,\\.-/;-<>].*|u[\\"\\^]*b[\\"\\^]*(?:i[\\"\\^]*n[\\"\\^]*a[\\"\\^]*c[\\"\\^]*l|s[\\"\\^]*t)|v[\\"\\^]*n|y[\\"\\^]*s[\\"\\^]*(?:d[\\"\\^]*m|k[\\"\\^]*e[\\"\\^]*y|t[\\"\\^]*e[\\"\\^]*m[\\"\\^]*(?:i[\\"\\^]*n[\\"\\^]*f[\\"\\^]*o|p[\\"\\^]*r[\\"\\^]*o[\\"\\^]*p[\\"\\^]*e[\\"\\^]*r[\\"\\^]*t[\\"\\^]*i[\\"\\^]*e[\\"\\^]*s[\\"\\^]*(?:a[\\"\\^]*d[\\"\\^]*v[\\"\\^]*a[\\"\\^]*n[\\"\\^]*c[\\"\\^]*e[\\"\\^]*d|d[\\"\\^]*a[\\"\\^]*t[\\"\\^]*a[\\"\\^]*e[\\"\\^]*x[\\"\\^]*e[\\"\\^]*c[\\"\\^]*u[\\"\\^]*t[\\"\\^]*i[\\"\\^]*o[\\"\\^]*n[\\"\\^]*p[\\"\\^]*r[\\"\\^]*e[\\"\\^]*v[\\"\\^]*e[\\"\\^]*n[\\"\\^]*t[\\"\\^]*i[\\"\\^]*o[\\"\\^]*n|(?:h[\\"\\^]*a[\\"\\^]*r[\\"\\^]*d[\\"\\^]*w[\\"\\^]*a[\\"\\^]*r|p[\\"\\^]*e[\\"\\^]*r[\\"\\^]*f[\\"\\^]*o[\\"\\^]*r[\\"\\^]*m[\\"\\^]*a[\\"\\^]*n[\\"\\^]*c)[\\"\\^]*e))))|t[\\"\\^]*(?:a[\\"\\^]*(?:k[\\"\\^]*e[\\"\\^]*o[\\"\\^]*w[\\"\\^]*n|s[\\"\\^]*k[\\"\\^]*(?:k[\\"\\^]*i[\\"\\^]*l[\\"\\^]*l|l[\\"\\^]*i[\\"\\^]*s[\\"\\^]*t|m[\\"\\^]*g[\\"\\^]*r|s[\\"\\^]*c[\\"\\^]*h[\\"\\^]*d))|(?:e[\\"\\^]*l[\\"\\^]*n[\\"\\^]*e|i[\\"\\^]*m[\\"\\^]*e[\\"\\^]*o[\\"\\^]*u|l[\\"\\^]*i[\\"\\^]*s|p[\\"\\^]*m[\\"\\^]*i[\\"\\^]*n[\\"\\^]*i)[\\"\\^]*t|r[\\"\\^]*(?:a[\\"\\^]*c[\\"\\^]*e[\\"\\^]*r[\\"\\^]*t|e[\\"\\^]*e)|s[\\"\\^]*(?:d[\\"\\^]*i[\\"\\^]*s[\\"\\^]*c[\\"\\^]*o|s[\\"\\^]*h[\\"\\^]*u[\\"\\^]*t[\\"\\^]*d)[\\"\\^]*n|y[\\"\\^]*p[\\"\\^]*e[\\"\\^]*(?:[\\s\\v,\\.-/;-<>].*|p[\\"\\^]*e[\\"\\^]*r[\\"\\^]*f))|u[\\"\\^]*(?:n[\\"\\^]*(?:r[\\"\\^]*a[\\"\\^]*r|z[\\"\\^]*i[\\"\\^]*p)|s[\\"\\^]*(?:e[\\"\\^]*r[\\"\\^]*a[\\"\\^]*c[\\"\\^]*c[\\"\\^]*o[\\"\\^]*u[\\"\\^]*n[\\"\\^]*t[\\"\\^]*c[\\"\\^]*o[\\"\\^]*n[\\"\\^]*t[\\"\\^]*r[\\"\\^]*o[\\"\\^]*l[\\"\\^]*s[\\"\\^]*e[\\"\\^]*t[\\"\\^]*t[\\"\\^]*i[\\"\\^]*n[\\"\\^]*g[\\"\\^]*s|r[\\"\\^]*s[\\"\\^]*t[\\"\\^]*a[\\"\\^]*t))|v[\\"\\^]*(?:e[\\"\\^]*r[\\"\\^]*i[\\"\\^]*f[\\"\\^]*y|o[\\"\\^]*l[\\"\\^]*[\\s\\v,\\.-/;-<>].*)|w[\\"\\^]*(?:a[\\"\\^]*i[\\"\\^]*t[\\"\\^]*f[\\"\\^]*o[\\"\\^]*r|e[\\"\\^]*v[\\"\\^]*t[\\"\\^]*u[\\"\\^]*t[\\"\\^]*i[\\"\\^]*l|g[\\"\\^]*e[\\"\\^]*t|h[\\"\\^]*o[\\"\\^]*a[\\"\\^]*m[\\"\\^]*i|i[\\"\\^]*n[\\"\\^]*(?:d[\\"\\^]*i[\\"\\^]*f[\\"\\^]*f|m[\\"\\^]*s[\\"\\^]*d[\\"\\^]*p|r[\\"\\^]*[ms]|v[\\"\\^]*a[\\"\\^]*r)|m[\\"\\^]*i[\\"\\^]*(?:c|m[\\"\\^]*g[\\"\\^]*m[\\"\\^]*t)|s[\\"\\^]*c[\\"\\^]*(?:r[\\"\\^]*i[\\"\\^]*p[\\"\\^]*t|u[\\"\\^]*i)|u[\\"\\^]*(?:a[\\"\\^]*(?:p[\\"\\^]*p|u[\\"\\^]*c[\\"\\^]*l[\\"\\^]*t)|s[\\"\\^]*a))|x[\\"\\^]*c[\\"\\^]*(?:a[\\"\\^]*c[\\"\\^]*l[\\"\\^]*s|o[\\"\\^]*p[\\"\\^]*y)|z[\\"\\^]*i[\\"\\^]*p[\\"\\^]*[\\s\\v,\\.-/;-<>].*)(?:\\.[\\"\\^]*[0-9A-Z_a-z]+)?\\b" "id:932115,phase:2,block,capture,t:none,msg:''Remote Command Execution: Windows Command Injection'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-windows'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (932120,'Remote Command Execution: Windows PowerShell Command Found','Remote Command Execution: Windows PowerShell Command Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@pmFromFile windows-powershell-commands.data" "id:932120,phase:2,block,capture,t:none,t:cmdLine,msg:''Remote Command Execution: Windows PowerShell Command Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''language-powershell'',tag:''platform-windows'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (932125,'Remote Command Execution: Windows Powershell Alias Command Injection','Remote Command Execution: Windows Powershell Alias Command Injection','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)(?:[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\v]*[\\s\\v\\"''-\\(,@]*(?:[\\"''\\.-9A-Z_a-z]+/|(?:[\\"''\\x5c\\^]*[0-9A-Z_a-z][\\"''\\x5c\\^]*:.*|[ \\"''\\.-9A-Z\\x5c\\^-_a-z]*)\\x5c)?[\\"\\^]*(?:(?:a[\\"\\^]*(?:c|s[\\"\\^]*n[\\"\\^]*p)|e[\\"\\^]*(?:b[\\"\\^]*p|p[\\"\\^]*(?:a[\\"\\^]*l|c[\\"\\^]*s[\\"\\^]*v|s[\\"\\^]*n)|[tx][\\"\\^]*s[\\"\\^]*n)|f[\\"\\^]*(?:[cltw]|o[\\"\\^]*r[\\"\\^]*e[\\"\\^]*a[\\"\\^]*c[\\"\\^]*h)|i[\\"\\^]*(?:[cr][\\"\\^]*m|e[\\"\\^]*x|h[\\"\\^]*y|i|p[\\"\\^]*(?:a[\\"\\^]*l|c[\\"\\^]*s[\\"\\^]*v|m[\\"\\^]*o|s[\\"\\^]*n)|s[\\"\\^]*e|w[\\"\\^]*(?:m[\\"\\^]*i|r))|m[\\"\\^]*(?:a[\\"\\^]*n|[dipv]|o[\\"\\^]*u[\\"\\^]*n[\\"\\^]*t)|o[\\"\\^]*g[\\"\\^]*v|p[\\"\\^]*(?:o[\\"\\^]*p|u[\\"\\^]*s[\\"\\^]*h)[\\"\\^]*d|t[\\"\\^]*r[\\"\\^]*c[\\"\\^]*m|w[\\"\\^]*j[\\"\\^]*b)[\\"\\^]*[\\s\\v,\\.-/;-<>].*|c[\\"\\^]*(?:(?:(?:d|h[\\"\\^]*d[\\"\\^]*i[\\"\\^]*r|v[\\"\\^]*p[\\"\\^]*a)[\\"\\^]*|p[\\"\\^]*(?:[ip][\\"\\^]*)?)[\\s\\v,\\.-/;-<>].*|l[\\"\\^]*(?:(?:[cipv]|h[\\"\\^]*y)[\\"\\^]*[\\s\\v,\\.-/;-<>].*|s)|n[\\"\\^]*s[\\"\\^]*n)|d[\\"\\^]*(?:(?:b[\\"\\^]*p|e[\\"\\^]*l|i[\\"\\^]*(?:f[\\"\\^]*f|r))[\\"\\^]*[\\s\\v,\\.-/;-<>].*|n[\\"\\^]*s[\\"\\^]*n)|g[\\"\\^]*(?:(?:(?:(?:a[\\"\\^]*)?l|b[\\"\\^]*p|d[\\"\\^]*r|h[\\"\\^]*y|(?:w[\\"\\^]*m[\\"\\^]*)?i|j[\\"\\^]*b|[u-v])[\\"\\^]*|c[\\"\\^]*(?:[ims][\\"\\^]*)?|m[\\"\\^]*(?:o[\\"\\^]*)?|s[\\"\\^]*(?:n[\\"\\^]*(?:p[\\"\\^]*)?|v[\\"\\^]*))[\\s\\v,\\.-/;-<>].*|e[\\"\\^]*r[\\"\\^]*r|p[\\"\\^]*(?:(?:s[\\"\\^]*)?[\\s\\v,\\.-/;-<>].*|v))|l[\\"\\^]*s|n[\\"\\^]*(?:(?:a[\\"\\^]*l|d[\\"\\^]*r|[iv]|m[\\"\\^]*o|s[\\"\\^]*n)[\\"\\^]*[\\s\\v,\\.-/;-<>].*|p[\\"\\^]*s[\\"\\^]*s[\\"\\^]*c)|r[\\"\\^]*(?:(?:(?:(?:b[\\"\\^]*)?p|e[\\"\\^]*n|(?:w[\\"\\^]*m[\\"\\^]*)?i|j[\\"\\^]*b|n[\\"\\^]*[ip])[\\"\\^]*|d[\\"\\^]*(?:r[\\"\\^]*)?|m[\\"\\^]*(?:(?:d[\\"\\^]*i[\\"\\^]*r|o)[\\"\\^]*)?|s[\\"\\^]*n[\\"\\^]*(?:p[\\"\\^]*)?|v[\\"\\^]*(?:p[\\"\\^]*a[\\"\\^]*)?)[\\s\\v,\\.-/;-<>].*|c[\\"\\^]*(?:j[\\"\\^]*b[\\"\\^]*[\\s\\v,\\.-/;-<>].*|s[\\"\\^]*n)|u[\\"\\^]*j[\\"\\^]*b)|s[\\"\\^]*(?:(?:(?:a[\\"\\^]*(?:j[\\"\\^]*b|l|p[\\"\\^]*s|s[\\"\\^]*v)|b[\\"\\^]*p|[civ]|w[\\"\\^]*m[\\"\\^]*i)[\\"\\^]*|l[\\"\\^]*(?:s[\\"\\^]*)?|p[\\"\\^]*(?:(?:j[\\"\\^]*b|p[\\"\\^]*s|s[\\"\\^]*v)[\\"\\^]*)?)[\\s\\v,\\.-/;-<>].*|h[\\"\\^]*c[\\"\\^]*m|u[\\"\\^]*j[\\"\\^]*b))(?:\\.[\\"\\^]*[0-9A-Z_a-z]+)?\\b" "id:932125,phase:2,block,capture,t:none,msg:''Remote Command Execution: Windows Powershell Alias Command Injection'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-windows'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (933017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:933017,phase:1,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"'),
	 (933018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:933018,phase:2,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"'),
	 (932130,'Remote Command Execution: Unix Shell Expression Found','Remote Command Execution: Unix Shell Expression Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx \\$(?:\\((?:.*|\\(.*\\))\\)|\\{.*\\})|[<>]\\(.*\\)|/[0-9A-Z_a-z]*\\[!?.+\\]" "id:932130,phase:2,block,capture,t:none,t:cmdLine,msg:''Remote Command Execution: Unix Shell Expression Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (932140,'Remote Command Execution: Windows FOR/IF Command Found','Remote Command Execution: Windows FOR/IF Command Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx \\b(?:for(?:/[dflr].*)? %+[^ ]+ in\\(.*\\)[\\s\\v]?do|if(?:/i)?(?: not)?(?: (?:e(?:xist|rrorlevel)|defined|cmdextversion)\\b|[ \\(].*(?:\\b(?:g(?:eq|tr)|equ|neq|l(?:eq|ss))\\b|==)))" "id:932140,phase:2,block,capture,t:none,t:cmdLine,msg:''Remote Command Execution: Windows FOR/IF Command Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-windows'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (932250,'Remote Command Execution: Direct Unix Command Execution','Remote Command Execution: Direct Unix Command Execution','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)(?:^|=)[\\s\\v]*(?:t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?e|[\\$\\{]|(?:[\\s\\v]*\\(|!)[\\s\\v]*|[0-9A-Z_a-z]+=(?:[^\\s\\v]*|\\$(?:.*|.*)|[<>].*|''.*''|\\".*\\")[\\s\\v]+)*[\\s\\v]*[\\"'']*(?:[\\"''-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\"''\\x5c]*(?:7[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?z(?:[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[ar])?|(?:(?:(?:b[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?z|x)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?z|e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?n[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?v|(?:h[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?u|r[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?c)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p|n[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?c)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|]|g[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[&,<>\\|]|(?:[\\--\\.0-9A-Z_a-z][\\"''\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)+[\\s\\v&,<>\\|])).*|c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?h)|i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?r[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?b|[kz][\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?h|l[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:s|z[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*)|p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:h[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|x[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?z)|s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p|(?:e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?d|s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?h)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|h|v[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?n)|w[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?3[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m)" "id:932250,phase:2,block,capture,t:none,msg:''Remote Command Execution: Direct Unix Command Execution'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (932260,'Remote Command Execution: Direct Unix Command Execution','Remote Command Execution: Direct Unix Command Execution','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)(?:^|=)[\\s\\v]*(?:t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?e|[\\$\\{]|(?:[\\s\\v]*\\(|!)[\\s\\v]*|[0-9A-Z_a-z]+=(?:[^\\s\\v]*|\\$(?:.*|.*)|[<>].*|''.*''|\\".*\\")[\\s\\v]+)*[\\s\\v]*[\\"'']*(?:[\\"''-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\"''\\x5c]*(?:b(?:as(?:e(?:32|64|nc)|h)|sd(?:cat|iff|tar)|u(?:iltin|nzip2|sybox)|z(?:c(?:at|mp)|diff|e(?:grep|xe)|f?grep|ip2|less|more))|c(?:o(?:mmand[\\s\\v<>]|proc)|url)|d(?:(?:ash|iff)[\\s\\v<>]|mesg|oas)|e(?:(?:cho|xec)[\\s\\v<>]|grep|val)|f(?:etch[\\s\\v<>]|grep|iletest|tp(?:stats|who))|g(?:rep[\\s\\v<>]|unzip|z(?:cat|exe|ip))|(?:head|java)[\\s\\v<>]|l(?:ast(?:comm|log(?:in)?)|ess(?:echo|(?:fil|pip)e)|ftp(?:get)?|s(?:-F|b_release|cpu|mod|of|pci|usb)|wp-download|ynx[\\s\\v<>]|z(?:c(?:at|mp)|diff|[e-f]?grep|less|m(?:a|ore)))|m(?:ailq|locate|ysql(?:admin|dump(?:slow)?|hotcopy|show))|n(?:c(?:\\.(?:openbsd|traditional)|at)|et(?:(?:c|st)at|kit-ftp)|ohup|ping|stat)|onintr|p(?:erl5?|(?:ft|gre)p|igz|k(?:exec|ill)|opd|rint(?:env|f[\\s\\v<>])|tar(?:diff|grep)?|ython[^\\s\\v])|r(?:e(?:alpath|(?:name|p(?:eat|lace))[\\s\\v<>])|m(?:dir[\\s\\v<>]|user)|nano|sync|uby[^\\s\\v])|s(?:ched|diff|e(?:ndmail|t(?:env|sid))|ftp|h(?:\\.distrib|ell)|o(?:cat|urce[\\s\\v<>])|trings|udo|ysctl)|t(?:ail[\\s\\v<>f]|c(?:p(?:ing|traceroute)|sh)|elnet|imeout[\\s\\v<>]|raceroute6?)|u(?:n(?:ame|compress|lz(?:4|ma)|(?:pig|x)z|rar|set[\\s\\v<>]|z(?:ip|std))|ser(?:(?:ad|mo)d|del))|vi(?:gr|pw)|w(?:get|hoami)|x(?:args|z(?:c(?:at|mp)|d(?:ec|iff)|[e-f]?grep|less|more))|z(?:c(?:at|mp)|diff|[e-f]?grep|(?:ipdetail|les)s|more|run|std))" "id:932260,phase:2,block,capture,t:none,msg:''Remote Command Execution: Direct Unix Command Execution'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (932330,'Remote Command Execution: Unix shell history invocation','Remote Command Execution: Unix shell history invocation','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx !-\\d" "id:932330,phase:2,block,capture,t:none,msg:''Remote Command Execution: Unix shell history invocation'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (932160,'Remote Command Execution: Unix Shell Code Found','Remote Command Execution: Unix Shell Code Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@pmFromFile unix-shell.data" "id:932160,phase:2,block,capture,t:none,t:cmdLine,t:normalizePath,msg:''Remote Command Execution: Unix Shell Code Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (932170,'Remote Command Execution: Shellshock (CVE-2014-6271)','Remote Command Execution: Shellshock (CVE-2014-6271)','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS|REQUEST_LINE "@rx ^\\(\\s*\\)\\s+{" "id:932170,phase:1,block,capture,t:none,t:urlDecode,msg:''Remote Command Execution: Shellshock (CVE-2014-6271)'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (934011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:934011,phase:1,pass,nolog,skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC"'),
	 (934012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:934012,phase:2,pass,nolog,skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC"'),
	 (932175,'Remote Command Execution: Unix shell alias invocation','Remote Command Execution: Unix shell alias invocation','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx \\ba[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?l[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?s\\b[\\s\\v]+[!-\\"%'',0-9@-Z_a-z]+=[^\\s\\v]" "id:932175,phase:2,block,capture,t:none,msg:''Remote Command Execution: Unix shell alias invocation'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (932180,'Restricted File Upload Attempt','Restricted File Upload Attempt','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X-File-Name "@pmFromFile restricted-upload.data" "id:932180,phase:2,block,capture,t:none,msg:''Restricted File Upload Attempt'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (932370,'Remote Command Execution: Windows Command Injection','Remote Command Execution: Windows Command Injection','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)(?:t[\\"\\^]*i[\\"\\^]*m[\\"\\^]*e|[\\n\\r;`\\{]|\\|\\|?|&&?)[\\s\\v]*[\\s\\v\\"''-\\(,@]*(?:[\\"''\\.-9A-Z_a-z]+/|(?:[\\"''\\x5c\\^]*[0-9A-Z_a-z][\\"''\\x5c\\^]*:.*|[ \\"''\\.-9A-Z\\x5c\\^-_a-z]*)\\x5c)?[\\"\\^]*(?:a[\\"\\^]*(?:c[\\"\\^]*c[\\"\\^]*c[\\"\\^]*h[\\"\\^]*e[\\"\\^]*c[\\"\\^]*k[\\"\\^]*c[\\"\\^]*o[\\"\\^]*n[\\"\\^]*s[\\"\\^]*o[\\"\\^]*l[\\"\\^]*e|d[\\"\\^]*(?:p[\\"\\^]*l[\\"\\^]*u[\\"\\^]*s|v[\\"\\^]*p[\\"\\^]*a[\\"\\^]*c[\\"\\^]*k)|(?:g[\\"\\^]*e[\\"\\^]*n[\\"\\^]*t[\\"\\^]*e[\\"\\^]*x[\\"\\^]*e[\\"\\^]*c[\\"\\^]*u[\\"\\^]*t[\\"\\^]*o|s[\\"\\^]*p[\\"\\^]*n[\\"\\^]*e[\\"\\^]*t[\\"\\^]*_[\\"\\^]*c[\\"\\^]*o[\\"\\^]*m[\\"\\^]*p[\\"\\^]*i[\\"\\^]*l[\\"\\^]*e)[\\"\\^]*r|p[\\"\\^]*p[\\"\\^]*(?:i[\\"\\^]*n[\\"\\^]*s[\\"\\^]*t[\\"\\^]*a[\\"\\^]*l[\\"\\^]*l[\\"\\^]*e[\\"\\^]*r|v[\\"\\^]*l[\\"\\^]*p)|t[\\"\\^]*(?:[\\s\\v,\\.-/;-<>].*|b[\\"\\^]*r[\\"\\^]*o[\\"\\^]*k[\\"\\^]*e[\\"\\^]*r))|b[\\"\\^]*(?:a[\\"\\^]*s[\\"\\^]*h|g[\\"\\^]*i[\\"\\^]*n[\\"\\^]*f[\\"\\^]*o|i[\\"\\^]*t[\\"\\^]*s[\\"\\^]*a[\\"\\^]*d[\\"\\^]*m[\\"\\^]*i[\\"\\^]*n)|c[\\"\\^]*(?:d[\\"\\^]*b|e[\\"\\^]*r[\\"\\^]*t[\\"\\^]*(?:o[\\"\\^]*c|r[\\"\\^]*e[\\"\\^]*q|u[\\"\\^]*t[\\"\\^]*i[\\"\\^]*l)|l[\\"\\^]*_[\\"\\^]*(?:i[\\"\\^]*n[\\"\\^]*v[\\"\\^]*o[\\"\\^]*c[\\"\\^]*a[\\"\\^]*t[\\"\\^]*i[\\"\\^]*o[\\"\\^]*n|l[\\"\\^]*o[\\"\\^]*a[\\"\\^]*d[\\"\\^]*a[\\"\\^]*s[\\"\\^]*s[\\"\\^]*e[\\"\\^]*m[\\"\\^]*b[\\"\\^]*l[\\"\\^]*y|m[\\"\\^]*u[\\"\\^]*t[\\"\\^]*e[\\"\\^]*x[\\"\\^]*v[\\"\\^]*e[\\"\\^]*r[\\"\\^]*i[\\"\\^]*f[\\"\\^]*i[\\"\\^]*e[\\"\\^]*r[\\"\\^]*s)|m[\\"\\^]*(?:d(?:[\\"\\^]*(?:k[\\"\\^]*e[\\"\\^]*y|l[\\"\\^]*3[\\"\\^]*2))?|s[\\"\\^]*t[\\"\\^]*p)|o[\\"\\^]*(?:m[\\"\\^]*s[\\"\\^]*v[\\"\\^]*c[\\"\\^]*s|n[\\"\\^]*(?:f[\\"\\^]*i[\\"\\^]*g[\\"\\^]*s[\\"\\^]*e[\\"\\^]*c[\\"\\^]*u[\\"\\^]*r[\\"\\^]*i[\\"\\^]*t[\\"\\^]*y[\\"\\^]*p[\\"\\^]*o[\\"\\^]*l[\\"\\^]*i[\\"\\^]*c[\\"\\^]*y|h[\\"\\^]*o[\\"\\^]*s[\\"\\^]*t|t[\\"\\^]*r[\\"\\^]*o[\\"\\^]*l)|r[\\"\\^]*e[\\"\\^]*g[\\"\\^]*e[\\"\\^]*n)|r[\\"\\^]*e[\\"\\^]*a[\\"\\^]*t[\\"\\^]*e[\\"\\^]*d[\\"\\^]*u[\\"\\^]*m[\\"\\^]*p|s[\\"\\^]*(?:c(?:[\\"\\^]*r[\\"\\^]*i[\\"\\^]*p[\\"\\^]*t)?|i)|u[\\"\\^]*s[\\"\\^]*t[\\"\\^]*o[\\"\\^]*m[\\"\\^]*s[\\"\\^]*h[\\"\\^]*e[\\"\\^]*l[\\"\\^]*l[\\"\\^]*h[\\"\\^]*o[\\"\\^]*s[\\"\\^]*t)|d[\\"\\^]*(?:a[\\"\\^]*t[\\"\\^]*a[\\"\\^]*s[\\"\\^]*v[\\"\\^]*c[\\"\\^]*u[\\"\\^]*t[\\"\\^]*i[\\"\\^]*l|e[\\"\\^]*(?:f[\\"\\^]*a[\\"\\^]*u[\\"\\^]*l[\\"\\^]*t[\\"\\^]*p[\\"\\^]*a[\\"\\^]*c[\\"\\^]*k|s[\\"\\^]*k(?:[\\"\\^]*t[\\"\\^]*o[\\"\\^]*p[\\"\\^]*i[\\"\\^]*m[\\"\\^]*g[\\"\\^]*d[\\"\\^]*o[\\"\\^]*w[\\"\\^]*n[\\"\\^]*l[\\"\\^]*d[\\"\\^]*r)?|v[\\"\\^]*(?:i[\\"\\^]*c[\\"\\^]*e[\\"\\^]*c[\\"\\^]*r[\\"\\^]*e[\\"\\^]*d[\\"\\^]*e[\\"\\^]*n[\\"\\^]*t[\\"\\^]*i[\\"\\^]*a[\\"\\^]*l[\\"\\^]*d[\\"\\^]*e[\\"\\^]*p[\\"\\^]*l[\\"\\^]*o[\\"\\^]*y[\\"\\^]*m[\\"\\^]*e[\\"\\^]*n[\\"\\^]*t|t[\\"\\^]*o[\\"\\^]*o[\\"\\^]*l[\\"\\^]*s[\\"\\^]*l[\\"\\^]*a[\\"\\^]*u[\\"\\^]*n[\\"\\^]*c[\\"\\^]*h[\\"\\^]*e[\\"\\^]*r))|f[\\"\\^]*s[\\"\\^]*(?:h[\\"\\^]*i[\\"\\^]*m|v[\\"\\^]*c)|i[\\"\\^]*(?:a[\\"\\^]*n[\\"\\^]*t[\\"\\^]*z|s[\\"\\^]*k[\\"\\^]*s[\\"\\^]*h[\\"\\^]*a[\\"\\^]*d[\\"\\^]*o[\\"\\^]*w)|n[\\"\\^]*(?:s[\\"\\^]*c[\\"\\^]*m[\\"\\^]*d|x)|o[\\"\\^]*t[\\"\\^]*n[\\"\\^]*e[\\"\\^]*t|u[\\"\\^]*m[\\"\\^]*p[\\"\\^]*6[\\"\\^]*4|x[\\"\\^]*c[\\"\\^]*a[\\"\\^]*p)|e[\\"\\^]*(?:s[\\"\\^]*e[\\"\\^]*n[\\"\\^]*t[\\"\\^]*u[\\"\\^]*t[\\"\\^]*l|v[\\"\\^]*e[\\"\\^]*n[\\"\\^]*t[\\"\\^]*v[\\"\\^]*w[\\"\\^]*r|x[\\"\\^]*(?:c[\\"\\^]*e[\\"\\^]*l|p[\\"\\^]*(?:a[\\"\\^]*n[\\"\\^]*d|l[\\"\\^]*o[\\"\\^]*r[\\"\\^]*e[\\"\\^]*r)|t[\\"\\^]*(?:e[\\"\\^]*x[\\"\\^]*p[\\"\\^]*o[\\"\\^]*r[\\"\\^]*t|r[\\"\\^]*a[\\"\\^]*c[\\"\\^]*3[\\"\\^]*2)))|f[\\"\\^]*(?:i[\\"\\^]*n[\\"\\^]*(?:d[\\"\\^]*s[\\"\\^]*t|g[\\"\\^]*e)[\\"\\^]*r|l[\\"\\^]*t[\\"\\^]*m[\\"\\^]*c|o[\\"\\^]*r[\\"\\^]*f[\\"\\^]*i[\\"\\^]*l[\\"\\^]*e[\\"\\^]*s|s[\\"\\^]*(?:i(?:[\\"\\^]*a[\\"\\^]*n[\\"\\^]*y[\\"\\^]*c[\\"\\^]*p[\\"\\^]*u)?|u[\\"\\^]*t[\\"\\^]*i[\\"\\^]*l)|t[\\"\\^]*p)|g[\\"\\^]*(?:f[\\"\\^]*x[\\"\\^]*d[\\"\\^]*o[\\"\\^]*w[\\"\\^]*n[\\"\\^]*l[\\"\\^]*o[\\"\\^]*a[\\"\\^]*d[\\"\\^]*w[\\"\\^]*r[\\"\\^]*a[\\"\\^]*p[\\"\\^]*p[\\"\\^]*e[\\"\\^]*r|p[\\"\\^]*s[\\"\\^]*c[\\"\\^]*r[\\"\\^]*i[\\"\\^]*p[\\"\\^]*t)|h[\\"\\^]*h|i[\\"\\^]*(?:e[\\"\\^]*(?:4[\\"\\^]*u[\\"\\^]*i[\\"\\^]*n[\\"\\^]*i[\\"\\^]*t|a[\\"\\^]*d[\\"\\^]*v[\\"\\^]*p[\\"\\^]*a[\\"\\^]*c[\\"\\^]*k|e[\\"\\^]*x[\\"\\^]*e[\\"\\^]*c|f[\\"\\^]*r[\\"\\^]*a[\\"\\^]*m[\\"\\^]*e)|l[\\"\\^]*a[\\"\\^]*s[\\"\\^]*m|m[\\"\\^]*e[\\"\\^]*w[\\"\\^]*d[\\"\\^]*b[\\"\\^]*l[\\"\\^]*d|n[\\"\\^]*(?:f[\\"\\^]*d[\\"\\^]*e[\\"\\^]*f[\\"\\^]*a[\\"\\^]*u[\\"\\^]*l[\\"\\^]*t[\\"\\^]*i[\\"\\^]*n[\\"\\^]*s[\\"\\^]*t[\\"\\^]*a[\\"\\^]*l|s[\\"\\^]*t[\\"\\^]*a[\\"\\^]*l[\\"\\^]*l[\\"\\^]*u[\\"\\^]*t[\\"\\^]*i)[\\"\\^]*l)|j[\\"\\^]*s[\\"\\^]*c|l[\\"\\^]*(?:a[\\"\\^]*u[\\"\\^]*n[\\"\\^]*c[\\"\\^]*h[\\"\\^]*-[\\"\\^]*v[\\"\\^]*s[\\"\\^]*d[\\"\\^]*e[\\"\\^]*v[\\"\\^]*s[\\"\\^]*h[\\"\\^]*e[\\"\\^]*l[\\"\\^]*l|d[\\"\\^]*i[\\"\\^]*f[\\"\\^]*d[\\"\\^]*e)|m[\\"\\^]*(?:a[\\"\\^]*(?:k[\\"\\^]*e[\\"\\^]*c[\\"\\^]*a[\\"\\^]*b|n[\\"\\^]*a[\\"\\^]*g[\\"\\^]*e[\\"\\^]*-[\\"\\^]*b[\\"\\^]*d[\\"\\^]*e|v[\\"\\^]*i[\\"\\^]*n[\\"\\^]*j[\\"\\^]*e[\\"\\^]*c[\\"\\^]*t)|f[\\"\\^]*t[\\"\\^]*r[\\"\\^]*a[\\"\\^]*c[\\"\\^]*e|i[\\"\\^]*c[\\"\\^]*r[\\"\\^]*o[\\"\\^]*s[\\"\\^]*o[\\"\\^]*f[\\"\\^]*t|m[\\"\\^]*c|p[\\"\\^]*c[\\"\\^]*m[\\"\\^]*d[\\"\\^]*r[\\"\\^]*u[\\"\\^]*n|s[\\"\\^]*(?:(?:b[\\"\\^]*u[\\"\\^]*i[\\"\\^]*l|o[\\"\\^]*h[\\"\\^]*t[\\"\\^]*m[\\"\\^]*e)[\\"\\^]*d|c[\\"\\^]*o[\\"\\^]*n[\\"\\^]*f[\\"\\^]*i[\\"\\^]*g|d[\\"\\^]*(?:e[\\"\\^]*p[\\"\\^]*l[\\"\\^]*o[\\"\\^]*y|t)|h[\\"\\^]*t[\\"\\^]*(?:a|m[\\"\\^]*l)|i[\\"\\^]*e[\\"\\^]*x[\\"\\^]*e[\\"\\^]*c|p[\\"\\^]*u[\\"\\^]*b|x[\\"\\^]*s[\\"\\^]*l))|n[\\"\\^]*(?:e[\\"\\^]*t[\\"\\^]*s[\\"\\^]*h|t[\\"\\^]*d[\\"\\^]*s[\\"\\^]*u[\\"\\^]*t[\\"\\^]*i[\\"\\^]*l)|o[\\"\\^]*(?:d[\\"\\^]*b[\\"\\^]*c[\\"\\^]*c[\\"\\^]*o[\\"\\^]*n[\\"\\^]*f|f[\\"\\^]*f[\\"\\^]*l[\\"\\^]*i[\\"\\^]*n[\\"\\^]*e[\\"\\^]*s[\\"\\^]*c[\\"\\^]*a[\\"\\^]*n[\\"\\^]*n[\\"\\^]*e[\\"\\^]*r[\\"\\^]*s[\\"\\^]*h[\\"\\^]*e[\\"\\^]*l[\\"\\^]*l|n[\\"\\^]*e[\\"\\^]*d[\\"\\^]*r[\\"\\^]*i[\\"\\^]*v[\\"\\^]*e[\\"\\^]*s[\\"\\^]*t[\\"\\^]*a[\\"\\^]*n[\\"\\^]*d[\\"\\^]*a[\\"\\^]*l[\\"\\^]*o[\\"\\^]*n[\\"\\^]*e[\\"\\^]*u[\\"\\^]*p[\\"\\^]*d[\\"\\^]*a[\\"\\^]*t[\\"\\^]*e[\\"\\^]*r|p[\\"\\^]*e[\\"\\^]*n[\\"\\^]*c[\\"\\^]*o[\\"\\^]*n[\\"\\^]*s[\\"\\^]*o[\\"\\^]*l[\\"\\^]*e)|p[\\"\\^]*(?:c[\\"\\^]*(?:a[\\"\\^]*l[\\"\\^]*u[\\"\\^]*a|w[\\"\\^]*(?:r[\\"\\^]*u[\\"\\^]*n|u[\\"\\^]*t[\\"\\^]*l))|(?:e[\\"\\^]*s[\\"\\^]*t[\\"\\^]*e|s)[\\"\\^]*r|(?:k[\\"\\^]*t[\\"\\^]*m[\\"\\^]*o|u[\\"\\^]*b[\\"\\^]*p[\\"\\^]*r)[\\"\\^]*n|n[\\"\\^]*p[\\"\\^]*u[\\"\\^]*t[\\"\\^]*i[\\"\\^]*l|o[\\"\\^]*w[\\"\\^]*e[\\"\\^]*r[\\"\\^]*p[\\"\\^]*n[\\"\\^]*t|r[\\"\\^]*(?:e[\\"\\^]*s[\\"\\^]*e[\\"\\^]*n[\\"\\^]*t[\\"\\^]*a[\\"\\^]*t[\\"\\^]*i[\\"\\^]*o[\\"\\^]*n[\\"\\^]*h[\\"\\^]*o[\\"\\^]*s[\\"\\^]*t|i[\\"\\^]*n[\\"\\^]*t(?:[\\"\\^]*b[\\"\\^]*r[\\"\\^]*m)?|o[\\"\\^]*(?:c[\\"\\^]*d[\\"\\^]*u[\\"\\^]*m[\\"\\^]*p|t[\\"\\^]*o[\\"\\^]*c[\\"\\^]*o[\\"\\^]*l[\\"\\^]*h[\\"\\^]*a[\\"\\^]*n[\\"\\^]*d[\\"\\^]*l[\\"\\^]*e[\\"\\^]*r)))|r[\\"\\^]*(?:a[\\"\\^]*s[\\"\\^]*a[\\"\\^]*u[\\"\\^]*t[\\"\\^]*o[\\"\\^]*u|c[\\"\\^]*s[\\"\\^]*i|(?:d[\\"\\^]*r[\\"\\^]*l[\\"\\^]*e[\\"\\^]*a[\\"\\^]*k[\\"\\^]*d[\\"\\^]*i[\\"\\^]*a|p[\\"\\^]*c[\\"\\^]*p[\\"\\^]*i[\\"\\^]*n)[\\"\\^]*g|e[\\"\\^]*(?:g(?:[\\"\\^]*(?:a[\\"\\^]*s[\\"\\^]*m|e[\\"\\^]*d[\\"\\^]*i[\\"\\^]*t|i[\\"\\^]*(?:n[\\"\\^]*i|s[\\"\\^]*t[\\"\\^]*e[\\"\\^]*r[\\"\\^]*-[\\"\\^]*c[\\"\\^]*i[\\"\\^]*m[\\"\\^]*p[\\"\\^]*r[\\"\\^]*o[\\"\\^]*v[\\"\\^]*i[\\"\\^]*d[\\"\\^]*e[\\"\\^]*r)|s[\\"\\^]*v[\\"\\^]*(?:c[\\"\\^]*s|r[\\"\\^]*3[\\"\\^]*2)))?|(?:m[\\"\\^]*o[\\"\\^]*t|p[\\"\\^]*l[\\"\\^]*a[\\"\\^]*c)[\\"\\^]*e)|u[\\"\\^]*n[\\"\\^]*(?:d[\\"\\^]*l[\\"\\^]*l[\\"\\^]*3[\\"\\^]*2|(?:e[\\"\\^]*x[\\"\\^]*e|s[\\"\\^]*c[\\"\\^]*r[\\"\\^]*i[\\"\\^]*p[\\"\\^]*t)[\\"\\^]*h[\\"\\^]*e[\\"\\^]*l[\\"\\^]*p[\\"\\^]*e[\\"\\^]*r|o[\\"\\^]*n[\\"\\^]*c[\\"\\^]*e))|s[\\"\\^]*(?:c[\\"\\^]*(?:[\\s\\v,\\.-/;-<>].*|h[\\"\\^]*t[\\"\\^]*a[\\"\\^]*s[\\"\\^]*k[\\"\\^]*s|r[\\"\\^]*i[\\"\\^]*p[\\"\\^]*t[\\"\\^]*r[\\"\\^]*u[\\"\\^]*n[\\"\\^]*n[\\"\\^]*e[\\"\\^]*r)|e[\\"\\^]*t[\\"\\^]*(?:r[\\"\\^]*e[\\"\\^]*s|t[\\"\\^]*i[\\"\\^]*n[\\"\\^]*g[\\"\\^]*s[\\"\\^]*y[\\"\\^]*n[\\"\\^]*c[\\"\\^]*h[\\"\\^]*o[\\"\\^]*s[\\"\\^]*t|u[\\"\\^]*p[\\"\\^]*a[\\"\\^]*p[\\"\\^]*i)|h[\\"\\^]*(?:d[\\"\\^]*o[\\"\\^]*c[\\"\\^]*v[\\"\\^]*w|e[\\"\\^]*l[\\"\\^]*l[\\"\\^]*3[\\"\\^]*2)|q[\\"\\^]*(?:l[\\"\\^]*(?:d[\\"\\^]*u[\\"\\^]*m[\\"\\^]*p[\\"\\^]*e[\\"\\^]*r|(?:t[\\"\\^]*o[\\"\\^]*o[\\"\\^]*l[\\"\\^]*s[\\"\\^]*)?p[\\"\\^]*s)|u[\\"\\^]*i[\\"\\^]*r[\\"\\^]*r[\\"\\^]*e[\\"\\^]*l)|s[\\"\\^]*h|t[\\"\\^]*o[\\"\\^]*r[\\"\\^]*d[\\"\\^]*i[\\"\\^]*a[\\"\\^]*g|y[\\"\\^]*(?:n[\\"\\^]*c[\\"\\^]*a[\\"\\^]*p[\\"\\^]*p[\\"\\^]*v[\\"\\^]*p[\\"\\^]*u[\\"\\^]*b[\\"\\^]*l[\\"\\^]*i[\\"\\^]*s[\\"\\^]*h[\\"\\^]*i[\\"\\^]*n[\\"\\^]*g[\\"\\^]*s[\\"\\^]*e[\\"\\^]*r[\\"\\^]*v[\\"\\^]*e[\\"\\^]*r|s[\\"\\^]*s[\\"\\^]*e[\\"\\^]*t[\\"\\^]*u[\\"\\^]*p))|t[\\"\\^]*(?:e[\\"\\^]*[\\s\\v,\\.-/;-<>].*|r[\\"\\^]*a[\\"\\^]*c[\\"\\^]*k[\\"\\^]*e[\\"\\^]*r|t[\\"\\^]*(?:d[\\"\\^]*i[\\"\\^]*n[\\"\\^]*j[\\"\\^]*e[\\"\\^]*c[\\"\\^]*t|t[\\"\\^]*r[\\"\\^]*a[\\"\\^]*c[\\"\\^]*e[\\"\\^]*r))|u[\\"\\^]*(?:n[\\"\\^]*r[\\"\\^]*e[\\"\\^]*g[\\"\\^]*m[\\"\\^]*p[\\"\\^]*2|p[\\"\\^]*d[\\"\\^]*a[\\"\\^]*t[\\"\\^]*e|r[\\"\\^]*l|t[\\"\\^]*i[\\"\\^]*l[\\"\\^]*i[\\"\\^]*t[\\"\\^]*y[\\"\\^]*f[\\"\\^]*u[\\"\\^]*n[\\"\\^]*c[\\"\\^]*t[\\"\\^]*i[\\"\\^]*o[\\"\\^]*n[\\"\\^]*s)|v[\\"\\^]*(?:b[\\"\\^]*c|e[\\"\\^]*r[\\"\\^]*c[\\"\\^]*l[\\"\\^]*s[\\"\\^]*i[\\"\\^]*d|i[\\"\\^]*s[\\"\\^]*u[\\"\\^]*a[\\"\\^]*l[\\"\\^]*u[\\"\\^]*i[\\"\\^]*a[\\"\\^]*v[\\"\\^]*e[\\"\\^]*r[\\"\\^]*i[\\"\\^]*f[\\"\\^]*y[\\"\\^]*n[\\"\\^]*a[\\"\\^]*t[\\"\\^]*i[\\"\\^]*v[\\"\\^]*e|s[\\"\\^]*(?:i[\\"\\^]*i[\\"\\^]*s[\\"\\^]*e[\\"\\^]*x[\\"\\^]*e[\\"\\^]*l[\\"\\^]*a[\\"\\^]*u[\\"\\^]*n[\\"\\^]*c[\\"\\^]*h|j[\\"\\^]*i[\\"\\^]*t[\\"\\^]*d[\\"\\^]*e[\\"\\^]*b[\\"\\^]*u[\\"\\^]*g[\\"\\^]*g)[\\"\\^]*e[\\"\\^]*r)|w[\\"\\^]*(?:a[\\"\\^]*b|(?:f|m[\\"\\^]*i)[\\"\\^]*c|i[\\"\\^]*n[\\"\\^]*(?:g[\\"\\^]*e[\\"\\^]*t|r[\\"\\^]*m|w[\\"\\^]*o[\\"\\^]*r[\\"\\^]*d)|l[\\"\\^]*r[\\"\\^]*m[\\"\\^]*d[\\"\\^]*r|o[\\"\\^]*r[\\"\\^]*k[\\"\\^]*f[\\"\\^]*o[\\"\\^]*l[\\"\\^]*d[\\"\\^]*e[\\"\\^]*r[\\"\\^]*s|s[\\"\\^]*(?:(?:c[\\"\\^]*r[\\"\\^]*i[\\"\\^]*p|r[\\"\\^]*e[\\"\\^]*s[\\"\\^]*e)[\\"\\^]*t|l)|t[\\"\\^]*[\\s\\v,\\.-/;-<>].*|u[\\"\\^]*a[\\"\\^]*u[\\"\\^]*c[\\"\\^]*l[\\"\\^]*t)|x[\\"\\^]*w[\\"\\^]*i[\\"\\^]*z[\\"\\^]*a[\\"\\^]*r[\\"\\^]*d|z[\\"\\^]*i[\\"\\^]*p[\\"\\^]*f[\\"\\^]*l[\\"\\^]*d[\\"\\^]*r)(?:\\.[\\"\\^]*[0-9A-Z_a-z]+)?\\b" "id:932370,phase:2,block,capture,t:none,msg:''Remote Command Execution: Windows Command Injection'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-windows'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (932013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:932013,phase:1,pass,nolog,skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE"'),
	 (932014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:932014,phase:2,pass,nolog,skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE"'),
	 (932231,'Remote Command Execution: Unix Command Injection','Remote Command Execution: Unix Command Injection','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?:t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?e|[\\n\\r;`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|\\{)|[<>]\\(|\\([\\s\\v]*\\))[\\s\\v]*(?:[\\$\\{]|(?:[\\s\\v]*\\(|!)[\\s\\v]*|[0-9A-Z_a-z]+=(?:[^\\s\\v]*|\\$(?:.*|.*)|[<>].*|''.*''|\\".*\\")[\\s\\v]+)*[\\s\\v]*[\\"'']*(?:[\\"''-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\"''\\x5c]*\\.[\\s\\v].*\\b" "id:932231,phase:2,block,capture,t:none,msg:''Remote Command Execution: Unix Command Injection'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (932131,'Remote Command Execution: Unix Shell Expression Found','Remote Command Execution: Unix Shell Expression Found','critical',0,0,300,1,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer "@rx (?:\\$(?:\\((?:\\(.*\\)|.*)\\)|\\{.*})|[<>]\\(.*\\)|\\[!?.+\\])" "id:932131,phase:1,block,capture,t:none,t:cmdLine,msg:''Remote Command Execution: Unix Shell Expression Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (932200,'RCE Bypass Technique','RCE Bypass Technique','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS:Referer|REQUEST_HEADERS:User-Agent|ARGS_NAMES|ARGS|XML:/* "@rx (?:[*?`\\x5c''][^/\\n]+/|\\$[({\\[#@!?*\\-_$a-zA-Z0-9]|/[^/]+?[*?`\\x5c''])" "id:932200,phase:2,block,capture,t:none,t:lowercase,t:urlDecodeUni,msg:''RCE Bypass Technique'',logdata:''Matched Data: %{TX.0} found within %{TX.932200_MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.932200_matched_var_name=%{matched_var_name}'',chain"'),
	 (932220,'Remote Command Execution: Unix Command Injection with pipe','Remote Command Execution: Unix Command Injection with pipe','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i).\\|(?:[\\s\\v]*|t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?e|[\\n\\r;`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|\\{)|[<>]\\(|\\([\\s\\v]*\\))[\\s\\v]*(?:[\\$\\{]|(?:[\\s\\v]*\\(|!)[\\s\\v]*|[0-9A-Z_a-z]+=(?:[^\\s\\v]*|\\$(?:.*|.*)|[<>].*|''.*''|\\".*\\")[\\s\\v]+)*[\\s\\v]*[\\"'']*(?:[\\"''-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\"''\\x5c]*(?:7[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?z(?:[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[ar])?|a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:b|(?:p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)?t|r(?:[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[jp])?|s(?:[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?h)?|w[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[ks])|b[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?z[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?z|c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[8-9][\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?9|[au][\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?t|c|(?:m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)?p|s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?h)|d[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[du]|i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?g|n[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?f)|e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[bdx]|n[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?v|q[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?n)|f[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[ci]|m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?t|t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p)|g[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[chr][\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?c|d[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?b|e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m|i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?t|o)|h[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:d|u[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p)|i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[dp]|r[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?b)|j[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:j[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?s|q)|k[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?h|l[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:d(?:[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?d)?|[npsz]|u[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?a)|m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?n|t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?r|v)|n[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[cl]|e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?t|(?:p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)?m)|o[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?d|p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:[at][\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?x|d[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?b|[fs]|(?:k[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)?g|h[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p|i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[cp]|r(?:[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?y)?|x[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?z)|r[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?r|c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p|e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[dv]|(?:p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?)?m)|s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p|e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[dt]|[g-hu]|s(?:[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?h)?|v[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?n)|t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[cr]|b[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?l|e[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[ex]|i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?c|o[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p)|u[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?l|v[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i(?:[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m)?|w[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:3[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m|c|h[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?o)|x[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:x[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?d|z)|y[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?u[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m|z[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p|s[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?h))" "id:932220,phase:2,block,capture,t:none,msg:''Remote Command Execution: Unix Command Injection with pipe'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (934014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:934014,phase:2,pass,nolog,skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC"'),
	 (934120,'Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address','Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@rx (?i)((?:a(?:cap|f[ps]|ttachment)|b(?:eshare|itcoin|lob)|c(?:a(?:llto|p)|id|vs|ompress.(?:zlib|bzip2))|d(?:a(?:v|ta)|ict|n(?:s|tp))|e(?:d2k|xpect)|f(?:(?:ee)?d|i(?:le|nger|sh)|tps?)|g(?:it|o(?:pher)?|lob)|h(?:323|ttps?)|i(?:ax|cap|(?:ma|p)ps?|rc[6s]?)|ja(?:bbe)?r|l(?:dap[is]?|ocal_file)|m(?:a(?:ilto|ven)|ms|umble)|n(?:e(?:tdoc|ws)|fs|ntps?)|ogg|p(?:aparazzi|h(?:ar|p)|op(?:2|3s?)|r(?:es|oxy)|syc)|r(?:mi|sync|tm(?:f?p)?|ar)|s(?:3|ftp|ips?|m(?:[bs]|tps?)|n(?:ews|mp)|sh(?:2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?)?|vn(?:\\+ssh)?)|t(?:e(?:amspeak|lnet)|ftp|urns?)|u(?:dp|nreal|t2004)|v(?:entrilo|iew-source|nc)|w(?:ebcal|ss?)|x(?:mpp|ri)|zip)://(?:[0-9]{10}|(?:0x[0-9a-f]{2}\\.){3}0x[0-9a-f]{2}|0x(?:[0-9a-f]{8}|[0-9a-f]{16})|(?:0{1,4}[0-9]{1,3}\\.){3}0{1,4}[0-9]{1,3}|[0-9]{1,3}\\.(?:[0-9]{1,3}\\.[0-9]{5}|[0-9]{8})|(?:\\x5c\\x5c[\\-0-9a-z]\\.?_?)+|\\[[0-:a-f]+(?:[\\.0-9]+|%[0-9A-Z_a-z]+)?\\]|[a-z][\\--\\.0-9A-Z_a-z]{1,255}:[0-9]{1,5}(?:#?[\\s\\v]*&?@(?:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}|[a-z][\\--\\.0-9A-Z_a-z]{1,255}):[0-9]{1,5}/?)+|[\\.0-9]{0,11}(?:\\xe2(?:\\x91[\\xa0-\\xbf]|\\x92[\\x80-\\xbf]|\\x93[\\x80-\\xa9\\xab-\\xbf])|\\xe3\\x80\\x82)+))" "id:934120,phase:2,block,capture,t:none,msg:''Possible Server Side Request Forgery (SSRF) Attack: URL Parameter using IP Address'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-ssrf'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/225/664'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (950017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:950017,phase:3,pass,nolog,skipAfter:END-RESPONSE-950-DATA-LEAKAGES"'),
	 (932240,'Remote Command Execution: Unix Command Injection evasion attempt detected','Remote Command Execution: Unix Command Injection evasion attempt detected','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS|XML:/* "@rx (?i)[\\-0-9_a-z]+(?:[\\"''\\[-\\]]+|\\$+[!#\\*\\-0-9\\?-@\\x5c_a-\\{]+|``|[\\$<>]\\(\\))[\\s\\v]*[\\-0-9_a-z]+" "id:932240,phase:2,block,capture,t:none,msg:''Remote Command Execution: Unix Command Injection evasion attempt detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (932210,'Remote Command Execution: SQLite System Command Execution','Remote Command Execution: SQLite System Command Execution','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx ;[\\s\\v]*\\.[\\s\\v]*[\\"'']?(?:a(?:rchive|uth)|b(?:a(?:ckup|il)|inary)|c(?:d|h(?:anges|eck)|lone|onnection)|d(?:atabases|b(?:config|info)|ump)|e(?:cho|qp|x(?:cel|it|p(?:ert|lain)))|f(?:ilectrl|ullschema)|he(?:aders|lp)|i(?:mpo(?:rt|ster)|ndexes|otrace)|l(?:i(?:mi|n)t|o(?:ad|g))|(?:mod|n(?:onc|ullvalu)|unmodul)e|o(?:nce|pen|utput)|p(?:arameter|r(?:int|o(?:gress|mpt)))|quit|re(?:ad|cover|store)|s(?:ave|c(?:anstats|hema)|e(?:lftest|parator|ssion)|h(?:a3sum|ell|ow)?|tats|ystem)|t(?:ables|estc(?:ase|trl)|ime(?:out|r)|race)|vfs(?:info|list|name)|width)" "id:932210,phase:2,block,t:none,t:escapeSeqDecode,t:compressWhitespace,msg:''Remote Command Execution: SQLite System Command Execution'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (932300,'Remote Command Execution: SMTP Command Execution','Remote Command Execution: SMTP Command Execution','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx \\r\\n(?s:.)*?\\b(?:(?i:E)(?:HLO [\\--\\.A-Za-z\\x17f\\x212a]{1,255}|XPN .{1,64})|HELO [\\--\\.A-Za-z\\x17f\\x212a]{1,255}|MAIL FROM:<.{1,64}(?i:@).{1,255}(?i:>)|(?i:R)(?:CPT TO:(?:(?i:<).{1,64}(?i:@).{1,255}(?i:>)|(?i: ))?(?i:<).{1,64}(?i:>)|SET\\b)|VRFY .{1,64}(?: <.{1,64}(?i:@).{1,255}(?i:>)|(?i:@).{1,255})|AUTH [\\-0-9A-Z_a-z\\x17f\\x212a]{1,20}(?i: )(?:(?:[\\+/-9A-Z_a-z\\x17f\\x212a]{4})*(?:[\\+/-9A-Z_a-z\\x17f\\x212a]{2}(?i:=)|[\\+/-9A-Z_a-z\\x17f\\x212a]{3}))?(?i:=)|STARTTLS\\b|NOOP\\b(?:(?i: ).{1,255})?)" "id:932300,phase:2,block,t:none,t:escapeSeqDecode,msg:''Remote Command Execution: SMTP Command Execution'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/137/134'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (932310,'Remote Command Execution: IMAP Command Execution','Remote Command Execution: IMAP Command Execution','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?is)\\r\\n[0-9A-Z_a-z]{1,50}\\b (?:A(?:PPEND (?:[\\"-#%-&\\*\\--9A-Z\\x5c_a-z]+)?(?: \\([ \\x5ca-z]+\\))?(?: \\"?[0-9]{1,2}-[0-9A-Z_a-z]{3}-[0-9]{4} [0-9]{2}:[0-9]{2}:[0-9]{2} [\\+\\-][0-9]{4}\\"?)? \\{[0-9]{1,20}\\+?\\}|UTHENTICATE [\\-0-9_a-z]{1,20}\\r\\n)|L(?:SUB (?:[\\"-#\\*\\.-9A-Z_a-z~]+)? (?:[\\"%-&\\*\\.-9A-Z\\x5c_a-z]+)?|ISTRIGHTS (?:[\\"%-&\\*\\--9A-Z\\x5c_a-z]+)?)|S(?:TATUS (?:[\\"%-&\\*\\--9A-Z\\x5c_a-z]+)? \\((?:U(?:NSEEN|IDNEXT)|MESSAGES|UIDVALIDITY|RECENT| )+\\)|ETACL (?:[\\"%-&\\*\\--9A-Z\\x5c_a-z]+)? [\\+\\-][ac-eik-lpr-tw-x]+?)|UID (?:COPY|FETCH|STORE) (?:[\\*,0-:]+)?|(?:(?:DELETE|GET)ACL|MYRIGHTS) (?:[\\"%-&\\*\\--9A-Z\\x5c_a-z]+)?)" "id:932310,phase:2,block,t:none,t:escapeSeqDecode,msg:''Remote Command Execution: IMAP Command Execution'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/137/134'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (932320,'Remote Command Execution: POP3 Command Execution','Remote Command Execution: POP3 Command Execution','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?is)\\r\\n.*?\\b(?:(?:LIST|TOP [0-9]+)(?: [0-9]+)?|U(?:SER .+?|IDL(?: [0-9]+)?)|PASS .+?|(?:RETR|DELE) [0-9]+?|A(?:POP [0-9A-Z_a-z]+ [0-9a-f]{32}|UTH [\\-0-9A-Z_]{1,20} (?:(?:[\\+/-9A-Z_a-z]{4})*(?:[\\+/-9A-Z_a-z]{2}=|[\\+/-9A-Z_a-z]{3}))?=))" "id:932320,phase:2,block,t:none,t:escapeSeqDecode,msg:''Remote Command Execution: POP3 Command Execution'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/137/134'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (932236,'Remote Command Execution: Unix Command Injection (command without evasion)','Remote Command Execution: Unix Command Injection (command without evasion)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/*|REQUEST_HEADERS:Referer|REQUEST_HEADERS:User-Agent "@rx (?i)(?:(?:^|=)[\\s\\v]*(?:t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?e|[\\$\\{]|(?:[\\s\\v]*\\(|!)[\\s\\v]*|[0-9A-Z_a-z]+=(?:[^\\s\\v]*|\\$(?:.*|.*)|[<>].*|''.*''|\\".*\\")[\\s\\v]+)*|(?:t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?e|[\\n\\r;`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|\\{)|[<>]\\(|\\([\\s\\v]*\\))[\\s\\v]*(?:[\\$\\{]|(?:[\\s\\v]*\\(|!)[\\s\\v]*|[0-9A-Z_a-z]+=(?:[^\\s\\v]*|\\$(?:.*|.*)|[<>].*|''.*''|\\".*\\")[\\s\\v]+)*)[\\s\\v]*[\\"'']*(?:[\\"''-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\"''\\x5c]*(?:7z[ar]?|a(?:(?:b|w[ks])[\\s\\v&<>\\|]|pt(?:-get)?|r(?:[\\s\\v&<>jp\\|]|ch[\\s\\v<>]|ia2c)|s(?:[\\s\\v&<>h\\|]|cii(?:-xfr|85)|pell)|t(?:[\\s\\v&<>\\|]|obm)|dduser|getty|l(?:ias|pine)[\\s\\v<>]|nsible-playbook)|b(?:z(?:z[\\s\\v&<>\\|]|c(?:at|mp)|diff|e(?:grep|xe)|f?grep|ip2|less|more)|a(?:s(?:e(?:32|64|nc)|h)|tch[\\s\\v<>])|pftrace|r(?:eaksw|idge[\\s\\v<>])|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler[\\s\\v<>]|zip2)|s(?:ctl|ybox))|yebug)|c(?:[8-9]9|a(?:t[\\s\\v&<>\\|]|(?:ncel|psh)[\\s\\v<>])|c[\\s\\v&<>\\|]|mp|p(?:[\\s\\v&<>\\|]|an|io|ulimit)|s(?:h|plit|vtool)|u(?:t[\\s\\v&<>\\|]|psfilter|rl)|ertbot|h(?:attr|dir[\\s\\v<>]|eck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|flags|mod|o(?:om|wn)|root)|o(?:(?:b|pro)c|lumn[\\s\\v<>]|m(?:m(?:and[\\s\\v<>])?|p(?:oser|ress[\\s\\v<>]))|w(?:say|think))|r(?:ash[\\s\\v<>]|ontab))|d(?:[du][\\s\\v&<>\\|]|i(?:g|(?:alog|ff)[\\s\\v<>])|nf|a(?:sh|te)[\\s\\v<>]|hclient|m(?:esg|idecode|setup)|o(?:as|(?:cker|ne)[\\s\\v<>]|sbox)|pkg|vips)|e(?:[bd][\\s\\v&<>\\|]|n(?:v(?:[\\s\\v&<>\\|]|-update)|d(?:if|sw))|qn|x(?:[\\s\\v&<>\\|]|ec[\\s\\v<>]|iftool|p(?:(?:and|(?:ec|or)t)[\\s\\v<>]|r))|(?:asy_instal|va)l|cho[\\s\\v<>]|fax|grep|macs|sac)|f(?:c[\\s\\v&<>\\|]|i(?:le(?:[\\s\\v<>]|test)|(?:n(?:d|ger)|sh)[\\s\\v<>])?|mt|tp(?:[\\s\\v&<>\\|]|stats|who)|acter|(?:etch|lock)[\\s\\v<>]|grep|o(?:ld[\\s\\v<>]|reach)|ping|unction)|g(?:c(?:c[^\\s\\v]|ore)|db|e(?:m[\\s\\v&<>\\|]|ni(?:e[\\s\\v<>]|soimage)|tfacl[\\s\\v<>])|hci?|i(?:t[\\s\\v&<>\\|]|mp[\\s\\v<>]|nsh)|o[\\s\\v&<>\\|]|r(?:c|ep[\\s\\v<>])|awk|tester|unzip|z(?:cat|exe|ip))|h(?:(?:d|up)[\\s\\v&<>\\|]|e(?:ad[\\s\\v<>]|xdump)|i(?:ghlight|story)[\\s\\v<>]|ost(?:id|name)|ping3|t(?:digest|passwd))|i(?:d[\\s\\v&<>\\|]|p(?:6?tables|config)?|rb|conv|f(?:config|top)|nstall[\\s\\v<>]|onice|spell)|j(?:js|q|ava[\\s\\v<>]|exec|o(?:(?:bs|in)[\\s\\v<>]|urnalctl)|runscript)|k(?:s(?:h|shell)|ill(?:[\\s\\v<>]|all)|nife[\\s\\v<>])|l(?:d(?:d?[\\s\\v&<>\\|]|config)|[np][\\s\\v&<>\\|]|s(?:-F|b_release|cpu|hw|mod|of|pci|usb)?|ua(?:[\\s\\v&<>\\|]|(?:la)?tex)|z(?:[\\s\\v&<>\\|]|c(?:at|mp)|diff|[e-f]?grep|less|m(?:a|ore))|a(?:st(?:[\\s\\v<>]|comm|log(?:in)?)|tex[\\s\\v<>])|ess(?:[\\s\\v<>]|echo|(?:fil|pip)e)|ftp(?:get)?|(?:inks|ynx)[\\s\\v<>]|o(?:(?:ca(?:l|te)|ok)[\\s\\v<>]|g(?:inctl|(?:nam|sav)e))|trace|wp-(?:d(?:ownload|ump)|mirror|request))|m(?:a(?:n[\\s\\v&<>\\|]|il(?:q|x[\\s\\v<>])?|ke[\\s\\v<>]|wk)|tr|v[\\s\\v&<>\\|]|(?:kdir|utt)[\\s\\v<>]|locate|o(?:(?:re|unt)[\\s\\v<>]|squitto)|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:admin|dump(?:slow)?|hotcopy|show)?)|n(?:c(?:[\\s\\v&<>\\|]|\\.(?:openbsd|traditional)|at)|e(?:t(?:[\\s\\v&<>\\|]|(?:c|st)at|kit-ftp)|ofetch)|l[\\s\\v&<>\\|]|m(?:[\\s\\v&<>\\|]|ap)|p(?:m[\\s\\v&<>\\|]|ing)|a(?:no[\\s\\v<>]|sm|wk)|ice[\\s\\v<>]|o(?:de[\\s\\v<>]|hup)|roff|s(?:enter|lookup|tat))|o(?:d[\\s\\v&<>\\|]|ctave[\\s\\v<>]|nintr|p(?:en(?:ssl|v(?:pn|t))|kg))|p(?:a(?:x[\\s\\v&<>\\|]|s(?:swd|te[\\s\\v<>])|tch[\\s\\v<>])|d(?:b|f(?:la)?tex)|f(?:[\\s\\v&<>\\|]|tp)|g(?:rep)?|hp[\\s\\v&<>\\|]|i(?:c(?:o[\\s\\v<>])?|p[^\\s\\v]|dstat|gz|ng[\\s\\v<>])|k(?:g(?:_?info)?|exec|ill)|r(?:y?[\\s\\v&<>\\|]|int(?:env|f[\\s\\v<>]))|s(?:ftp|ql)?|t(?:x|ar(?:diff|grep)?)|xz|er(?:f|l(?:5|sh)?|ms)|opd|ython[^\\s\\v]|u(?:ppet[\\s\\v<>]|shd))|r(?:a(?:r[\\s\\v&<>\\|]|k(?:e[\\s\\v<>]|u))|cp[\\s\\v&<>\\|]|e(?:d(?:[\\s\\v&<>\\|]|carpet[\\s\\v<>])|v|a(?:delf|lpath)|(?:name|p(?:eat|lace))[\\s\\v<>]|stic)|m(?:[\\s\\v&<>\\|]|dir[\\s\\v<>]|user)|pm(?:[\\s\\v&<>\\|]|db|(?:quer|verif)y)|l(?:ogin|wrap)|nano|oute[\\s\\v<>]|sync|u(?:by[^\\s\\v]|n-(?:mailcap|parts))|vi(?:ew|m))|s(?:c(?:p|hed|r(?:een|ipt)[\\s\\v<>])|e(?:d[\\s\\v&<>\\|]|t(?:[\\s\\v&<>\\|]|arch|env|facl[\\s\\v<>]|sid)|ndmail|rvice[\\s\\v<>])|g|h(?:\\.distrib|ell|u(?:f|tdown[\\s\\v<>]))?|s(?:[\\s\\v&<>\\|]|h(?:[\\s\\v&<>\\|]|-key(?:ge|sca)n|pass))|u(?:[\\s\\v&<>\\|]|do)|vn|(?:ash|nap|plit)[\\s\\v<>]|diff|ftp|l(?:eep[\\s\\v<>]|sh)|mbclient|o(?:cat|elim|(?:rt|urce)[\\s\\v<>])|qlite3|t(?:art-stop-daemon|dbuf|r(?:ace|ings))|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:c|r[\\s\\v&<>\\|]|il[\\s\\v<>f]|sk(?:set)?)|bl|e(?:e|x[\\s\\v&<>\\|]|lnet)|i(?:c[\\s\\v&<>\\|]|me(?:(?:out)?[\\s\\v<>]|datectl))|o(?:p|uch[\\s\\v<>])|c(?:l?sh|p(?:dump|ing|traceroute))|ftp|mux|r(?:aceroute6?|off)|shark)|u(?:l(?:[\\s\\v&<>\\|]|imit[\\s\\v<>])|n(?:ame|compress|expand|iq|l(?:ink[\\s\\v<>]|z(?:4|ma))|(?:pig|x)z|rar|s(?:et|hare)[\\s\\v<>]|z(?:ip|std))|pdate-alternatives|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:i(?:[\\s\\v&<>\\|]|m(?:[\\s\\v&<>\\|]|diff)|ew[\\s\\v<>]|gr|pw|rsh)|algrind|olatility)|w(?:3m|c|h(?:o(?:ami|is)?|iptail)|a(?:ll|tch)[\\s\\v<>]|get|i(?:reshark|sh[\\s\\v<>]))|x(?:(?:x|pa)d|z(?:[\\s\\v&<>\\|]|c(?:at|mp)|d(?:ec|iff)|[e-f]?grep|less|more)|args|e(?:la)?tex|mo(?:dmap|re)|term)|y(?:um|arn|elp[\\s\\v<>])|z(?:ip(?:details)?|s(?:h|oelim|td)|athura|c(?:at|mp)|diff|[e-f]?grep|less|more|run|ypper))" "id:932236,phase:2,block,capture,t:none,msg:''Remote Command Execution: Unix Command Injection (command without evasion)'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (932161,'Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS','Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer "@pmFromFile unix-shell.data" "id:932161,phase:2,block,capture,t:none,t:cmdLine,t:normalizePath,msg:''Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (932015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:932015,phase:1,pass,nolog,skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE"'),
	 (932016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:932016,phase:2,pass,nolog,skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE"'),
	 (949053,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 2" "id:949053,phase:1,pass,t:none,nolog,setvar:''tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}''"'),
	 (932232,'Remote Command Execution: Unix Command Injection','Remote Command Execution: Unix Command Injection','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?:t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?e|[\\n\\r;`\\{]|\\|\\|?|&&?|\\$(?:\\(\\(?|\\{)|[<>]\\(|\\([\\s\\v]*\\))[\\s\\v]*(?:[\\$\\{]|(?:[\\s\\v]*\\(|!)[\\s\\v]*|[0-9A-Z_a-z]+=(?:[^\\s\\v]*|\\$(?:.*|.*)|[<>].*|''.*''|\\".*\\")[\\s\\v]+)*[\\s\\v]*[\\"'']*(?:[\\"''-\\+\\--9\\?A-\\]_a-z\\|]+/)?[\\"''\\x5c]*(?:(?:v[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i|(?:a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?i[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?t[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?u[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?d|u[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?2[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?d[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?t)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?e|d[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?n[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?f)[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*|p[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:s|w[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?d|a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?c[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?m[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?a[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?n[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?[\\s\\v&,<>\\|].*)|w[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?(?:h[\\"''\\)\\[-\\x5c]*(?:(?:(?:\\|\\||&&)[\\s\\v]*)?\\$[!#\\(\\*\\-0-9\\?-@_a-\\{]*)?\\x5c?o|[\\s\\v&,<>\\|].*))\\b" "id:932232,phase:2,block,capture,t:none,msg:''Remote Command Execution: Unix Command Injection'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (932237,'Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS','Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_HEADERS:User-Agent|REQUEST_HEADERS:Referer "@rx (?i)\\b(?:7z[ar]?|a(?:b|pt(?:-get)?|r(?:[jp]|ch[\\s\\v<>]|ia2c)?|s(?:h|cii(?:-xfr|85)|pell)?|t(?:obm)?|w[ks]|dduser|getty|l(?:ias|pine)[\\s\\v<>]|nsible-playbook)|b(?:z(?:z|c(?:at|mp)|diff|e(?:grep|xe)|f?grep|ip2|less|more)|a(?:s(?:e(?:32|64|nc)|h)|tch[\\s\\v<>])|pftrace|r(?:eaksw|idge[\\s\\v<>])|sd(?:cat|iff|tar)|u(?:iltin|n(?:dler[\\s\\v<>]|zip2)|s(?:ctl|ybox))|yebug)|c(?:[8-9]9|a(?:t|(?:ncel|psh)[\\s\\v<>])|c|mp|p(?:an|io|ulimit)?|s(?:h|plit|vtool)|u(?:t|psfilter|rl)|ertbot|h(?:attr|dir[\\s\\v<>]|eck_(?:by_ssh|cups|log|memory|raid|s(?:sl_cert|tatusfile))|flags|mod|o(?:om|wn)|root)|o(?:(?:b|pro)c|lumn[\\s\\v<>]|m(?:m(?:and[\\s\\v<>])?|p(?:oser|ress[\\s\\v<>]))|w(?:say|think))|r(?:ash[\\s\\v<>]|ontab))|d(?:[du]|i(?:g|(?:alog|ff)[\\s\\v<>])|nf|a(?:sh|te)[\\s\\v<>]|hclient|m(?:esg|idecode|setup)|o(?:as|(?:cker|ne)[\\s\\v<>]|sbox)|pkg|vips)|e(?:[bd]|n(?:v(?:-update)?|d(?:if|sw))|qn|x(?:ec[\\s\\v<>]|iftool|p(?:(?:and|(?:ec|or)t)[\\s\\v<>]|r))?|(?:asy_instal|va)l|cho[\\s\\v<>]|fax|grep|macs|sac)|f(?:c|i(?:le(?:[\\s\\v<>]|test)|(?:n(?:d|ger)|sh)[\\s\\v<>])?|mt|tp(?:stats|who)?|acter|(?:etch|lock)[\\s\\v<>]|grep|o(?:ld[\\s\\v<>]|reach)|ping|unction)|g(?:c(?:c|ore)|db|e(?:m|ni(?:e[\\s\\v<>]|soimage)|tfacl[\\s\\v<>])|hci?|i(?:t|mp[\\s\\v<>]|nsh)|o|r(?:c|ep[\\s\\v<>])|awk|tester|unzip|z(?:cat|exe|ip))|h(?:d|up|e(?:ad[\\s\\v<>]|xdump)|i(?:ghlight|story)[\\s\\v<>]|ost(?:id|name)|ping3|t(?:digest|passwd))|i(?:d|p(?:6?tables|config)?|rb|conv|f(?:config|top)|nstall[\\s\\v<>]|onice|spell)|j(?:js|q|ava[\\s\\v<>]|exec|o(?:(?:bs|in)[\\s\\v<>]|urnalctl)|runscript)|k(?:s(?:h|shell)|ill(?:[\\s\\v<>]|all)|nife[\\s\\v<>])|l(?:d(?:d|config)?|[np]|s(?:-F|b_release|cpu|hw|mod|of|pci|usb)?|ua(?:(?:la)?tex)?|z(?:c(?:at|mp)|diff|[e-f]?grep|less|m(?:a|ore))?|a(?:st(?:[\\s\\v<>]|comm|log(?:in)?)|tex[\\s\\v<>])|ess(?:[\\s\\v<>]|echo|(?:fil|pip)e)|ftp(?:get)?|(?:inks|ynx)[\\s\\v<>]|o(?:(?:ca(?:l|te)|ok)[\\s\\v<>]|g(?:inctl|(?:nam|sav)e))|trace|wp-(?:d(?:ownload|ump)|mirror|request))|m(?:a(?:n|il(?:q|x[\\s\\v<>])?|ke[\\s\\v<>]|wk)|tr|v|(?:kdir|utt)[\\s\\v<>]|locate|o(?:(?:re|unt)[\\s\\v<>]|squitto)|sg(?:attrib|c(?:at|onv)|filter|merge|uniq)|ysql(?:admin|dump(?:slow)?|hotcopy|show)?)|n(?:c(?:\\.(?:openbsd|traditional)|at)?|e(?:t(?:(?:c|st)at|kit-ftp)?|ofetch)|l|m(?:ap)?|p(?:m|ing)|a(?:no[\\s\\v<>]|sm|wk)|ice[\\s\\v<>]|o(?:de[\\s\\v<>]|hup)|roff|s(?:enter|lookup|tat))|o(?:d|ctave[\\s\\v<>]|nintr|p(?:en(?:ssl|v(?:pn|t))|kg))|p(?:a(?:x|s(?:swd|te[\\s\\v<>])|tch[\\s\\v<>])|d(?:b|f(?:la)?tex)|f(?:tp)?|g(?:rep)?|hp|i(?:c(?:o[\\s\\v<>])?|p|dstat|gz|ng[\\s\\v<>])|k(?:g(?:_?info)?|exec|ill)|r(?:y|int(?:env|f[\\s\\v<>]))?|s(?:ftp|ql)?|t(?:x|ar(?:diff|grep)?)|xz|er(?:f|l(?:5|sh)?|ms)|opd|ython[^\\s\\v]|u(?:ppet[\\s\\v<>]|shd))|r(?:a(?:r|k(?:e[\\s\\v<>]|u))|cp|e(?:d(?:carpet[\\s\\v<>])?|v|a(?:delf|lpath)|(?:name|p(?:eat|lace))[\\s\\v<>]|stic)|m(?:dir[\\s\\v<>]|user)?|pm(?:db|(?:quer|verif)y)?|l(?:ogin|wrap)|nano|oute[\\s\\v<>]|sync|u(?:by[^\\s\\v]|n-(?:mailcap|parts))|vi(?:ew|m))|s(?:c(?:p|hed|r(?:een|ipt)[\\s\\v<>])|e(?:d|t(?:arch|env|facl[\\s\\v<>]|sid)?|ndmail|rvice[\\s\\v<>])|g|h(?:\\.distrib|ell|u(?:f|tdown[\\s\\v<>]))?|s(?:h(?:-key(?:ge|sca)n|pass)?)?|u(?:do)?|vn|(?:ash|nap|plit)[\\s\\v<>]|diff|ftp|l(?:eep[\\s\\v<>]|sh)|mbclient|o(?:cat|elim|(?:rt|urce)[\\s\\v<>])|qlite3|t(?:art-stop-daemon|dbuf|r(?:ace|ings))|ys(?:ctl|tem(?:ctl|d-resolve)))|t(?:a(?:[cr]|il[\\s\\v<>f]|sk(?:set)?)|bl|e(?:[ex]|lnet)|i(?:c|me(?:(?:out)?[\\s\\v<>]|datectl))|o(?:p|uch[\\s\\v<>])|c(?:l?sh|p(?:dump|ing|traceroute))|ftp|mux|r(?:aceroute6?|off)|shark)|u(?:l(?:imit[\\s\\v<>])?|n(?:ame|compress|expand|iq|l(?:ink[\\s\\v<>]|z(?:4|ma))|(?:pig|x)z|rar|s(?:et|hare)[\\s\\v<>]|z(?:ip|std))|pdate-alternatives|ser(?:(?:ad|mo)d|del)|u(?:de|en)code)|v(?:i(?:m(?:diff)?|ew[\\s\\v<>]|gr|pw|rsh)?|algrind|olatility)|w(?:3m|c|h(?:o(?:ami|is)?|iptail)|a(?:ll|tch)[\\s\\v<>]|get|i(?:reshark|sh[\\s\\v<>]))|x(?:(?:x|pa)d|z(?:c(?:at|mp)|d(?:ec|iff)|[e-f]?grep|less|more)?|args|e(?:la)?tex|mo(?:dmap|re)|term)|y(?:um|arn|elp[\\s\\v<>])|z(?:ip(?:details)?|s(?:h|oelim|td)|athura|c(?:at|mp)|diff|[e-f]?grep|less|more|run|ypper))\\b" "id:932237,phase:2,block,capture,t:none,t:cmdLine,t:normalizePath,msg:''Remote Command Execution: Unix Shell Code Found in REQUEST_HEADERS'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/3'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (932190,'Remote Command Execution: Wildcard bypass technique attempt','Remote Command Execution: Wildcard bypass technique attempt','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS "@rx /(?:[?*]+[a-z/]+|[a-z/]+[?*]+)" "id:932190,phase:2,block,capture,t:none,t:urlDecode,t:urlDecodeUni,t:normalizePath,t:cmdLine,msg:''Remote Command Execution: Wildcard bypass technique attempt'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (932301,'Remote Command Execution: SMTP Command Execution','Remote Command Execution: SMTP Command Execution','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx \\r\\n(?s:.)*?\\b(?:DATA|QUIT|HELP(?: .{1,255})?)" "id:932301,phase:2,block,t:none,t:escapeSeqDecode,msg:''Remote Command Execution: SMTP Command Execution'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/3'',tag:''OWASP_CRS'',tag:''capec/137/134'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (932311,'Remote Command Execution: IMAP Command Execution','Remote Command Execution: IMAP Command Execution','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?is)\\r\\n[0-9A-Z_a-z]{1,50}\\b (?:C(?:(?:REATE|OPY [\\*,0-:]+) [\\"-#%-&\\*\\--9A-Z\\x5c_a-z]+|APABILITY|HECK|LOSE)|DELETE [\\"-#%-&\\*\\--\\.0-9A-Z\\x5c_a-z]+|EX(?:AMINE [\\"-#%-&\\*\\--\\.0-9A-Z\\x5c_a-z]+|PUNGE)|FETCH [\\*,0-:]+|L(?:IST [\\"-#\\*\\--9A-Z\\x5c_a-z~]+? [\\"-#%-&\\*\\--9A-Z\\x5c_a-z]+|OG(?:IN [\\--\\.0-9@_a-z]{1,40} .*?|OUT))|RENAME [\\"-#%-&\\*\\--9A-Z\\x5c_a-z]+? [\\"-#%-&\\*\\--9A-Z\\x5c_a-z]+|S(?:E(?:LECT [\\"-#%-&\\*\\--9A-Z\\x5c_a-z]+|ARCH(?: CHARSET [\\--\\.0-9A-Z_a-z]{1,40})? (?:(KEYWORD \\x5c)?(?:A(?:LL|NSWERED)|BCC|D(?:ELETED|RAFT)|(?:FLAGGE|OL)D|RECENT|SEEN|UN(?:(?:ANSWER|FLAGG)ED|D(?:ELETED|RAFT)|SEEN)|NEW)|(?:BODY|CC|FROM|HEADER .{1,100}|NOT|OR .{1,255}|T(?:EXT|O)) .{1,255}|LARGER [0-9]{1,20}|[\\*,0-:]+|(?:BEFORE|ON|S(?:ENT(?:(?:BEFOR|SINC)E|ON)|INCE)) \\"?[0-9]{1,2}-[0-9A-Z_a-z]{3}-[0-9]{4}\\"?|S(?:MALLER [0-9]{1,20}|UBJECT .{1,255})|U(?:ID [\\*,0-:]+?|NKEYWORD \\x5c(Seen|(?:Answer|Flagg)ed|D(?:eleted|raft)|Recent))))|T(?:ORE [\\*,0-:]+? [\\+\\-]?FLAGS(?:\\.SILENT)? (?:\\(\\x5c[a-z]{1,20}\\))?|ARTTLS)|UBSCRIBE [\\"-#%-&\\*\\--9A-Z\\x5c_a-z]+)|UN(?:SUBSCRIBE [\\"-#%-&\\*\\--9A-Z\\x5c_a-z]+|AUTHENTICATE)|NOOP)" "id:932311,phase:2,block,t:none,t:escapeSeqDecode,msg:''Remote Command Execution: IMAP Command Execution'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/3'',tag:''OWASP_CRS'',tag:''capec/137/134'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (932321,'Remote Command Execution: POP3 Command Execution','Remote Command Execution: POP3 Command Execution','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx \\r\\n(?s:.)*?\\b(?:(?:QUI|STA|RSE)(?i:T)|NOOP|CAPA)" "id:932321,phase:2,block,t:none,t:escapeSeqDecode,msg:''Remote Command Execution: POP3 Command Execution'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/3'',tag:''OWASP_CRS'',tag:''capec/137/134'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (932331,'Remote Command Execution: Unix shell history invocation','Remote Command Execution: Unix shell history invocation','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx !(?:\\d|!)" "id:932331,phase:2,block,t:none,msg:''Remote Command Execution: Unix shell history invocation'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-shell'',tag:''platform-unix'',tag:''attack-rce'',tag:''paranoia-level/3'',tag:''OWASP_CRS'',tag:''capec/1000/152/248/88'',tag:''PCI/6.5.2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (932017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:932017,phase:1,pass,nolog,skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE"'),
	 (932018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:932018,phase:2,pass,nolog,skipAfter:END-REQUEST-932-APPLICATION-ATTACK-RCE"'),
	 (933011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:933011,phase:1,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"'),
	 (933012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:933012,phase:2,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"'),
	 (949153,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 2" "id:949153,phase:1,pass,t:none,nolog,setvar:''tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}''"'),
	 (933100,'PHP Injection Attack: PHP Open Tag Found','PHP Injection Attack: PHP Open Tag Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?:<\\?(?:[^x]|x[^m]|xm[^l]|xml[^\\s]|xml$|$)|<\\?php|\\[(?:/|\\x5c)?php\\])" "id:933100,phase:2,block,capture,t:none,t:lowercase,msg:''PHP Injection Attack: PHP Open Tag Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (933110,'PHP Injection Attack: PHP Script File Upload Found','PHP Injection Attack: PHP Script File Upload Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X.Filename|REQUEST_HEADERS:X-File-Name "@rx .*\\.ph(?:p\\d*|tml|ar|ps|t|pt)\\.*$" "id:933110,phase:2,block,capture,t:none,t:lowercase,msg:''PHP Injection Attack: PHP Script File Upload Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (933120,'PHP Injection Attack: Configuration Directive Found','PHP Injection Attack: Configuration Directive Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@pmFromFile php-config-directives.data" "id:933120,phase:2,block,capture,t:none,t:normalisePath,msg:''PHP Injection Attack: Configuration Directive Found'',logdata:''Matched Data: %{TX.933120_TX_0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.933120_tx_0=%{tx.0}'',chain"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (933130,'PHP Injection Attack: Variables Found','PHP Injection Attack: Variables Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@pmFromFile php-variables.data" "id:933130,phase:2,block,capture,t:none,t:normalisePath,t:urlDecodeUni,msg:''PHP Injection Attack: Variables Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (933140,'PHP Injection Attack: I/O Stream Found','PHP Injection Attack: I/O Stream Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)php://(?:std(?:in|out|err)|(?:in|out)put|fd|memory|temp|filter)" "id:933140,phase:2,block,capture,t:none,msg:''PHP Injection Attack: I/O Stream Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (933200,'PHP Injection Attack: Wrapper scheme detected','PHP Injection Attack: Wrapper scheme detected','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?:bzip2|expect|glob|ogg|(?:ph|r)ar|ssh2(?:.(?:s(?:hell|(?:ft|c)p)|exec|tunnel))?|z(?:ip|lib))://" "id:933200,phase:2,block,t:none,t:utf8toUnicode,t:urlDecodeUni,t:removeNulls,t:cmdLine,msg:''PHP Injection Attack: Wrapper scheme detected'',logdata:''Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (933150,'PHP Injection Attack: High-Risk PHP Function Name Found','PHP Injection Attack: High-Risk PHP Function Name Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@pmFromFile php-function-names-933150.data" "id:933150,phase:2,block,capture,t:none,msg:''PHP Injection Attack: High-Risk PHP Function Name Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (933160,'PHP Injection Attack: High-Risk PHP Function Call Found','PHP Injection Attack: High-Risk PHP Function Call Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\b\\(?[\\"'']*(?:a(?:rray_(?:(?:diff|intersect)_u(?:assoc|key)|filter|map|reduce|u(?:diff|intersect)(?:_u?assoc)?)|ssert(?:_options)?)|b(?:(?:ase64_en|son_(?:de|en))code|zopen)|c(?:hr|onvert_uuencode|reate_function|url_(?:exec|file_create|init))|(?:debug_backtrac|json_(?:de|en)cod|tmpfil)e|e(?:rror_reporting|scapeshell(?:arg|cmd)|val|x(?:ec|if_(?:imagetype|read_data|t(?:agname|humbnail))))|f(?:i(?:le(?:(?:_exist|perm)s|(?:[acm]tim|inod)e|group)?|nfo_open)|open|(?:pu|unction_exis)ts|tp_(?:connec|ge|nb_(?:ge|pu)|pu)t|write)|g(?:et(?:_(?:c(?:fg_va|urrent_use)r|meta_tags)|(?:cw|lastmo)d|env|imagesize|my(?:[gpu]id|inode))|lob|z(?:compress|(?:(?:defla|wri)t|encod|fil)e|open|read))|h(?:(?:ash_(?:(?:hmac|update)_)?|ighlight_)file|e(?:ader_register_callback|x2bin)|tml(?:_entity_decode|entities|specialchars(?:_decode)?))|i(?:mage(?:2?wbmp|createfrom(?:gif|(?:jpe|pn)g|wbmp|x[bp]m)|g(?:d2?|if)|(?:jpe|pn)g|xbm)|ni_(?:get(?:_all)?|set)|ptcembed|s_(?:dir|(?:(?:execut|read|write?)ab|fi)le)|terator_apply)|m(?:b_(?:ereg(?:_(?:match|replace(?:_callback)?)|i(?:_replace)?)?|parse_str)|(?:d5|ove_uploaded)_file|ethod_exists|kdir|ysql_query)|o(?:b_(?:clean|end_(?:clean|flush)|flush|get_(?:c(?:lean|ontents)|flush)|start)|dbc_(?:connect|exec(?:ute)?|result(?:_all)?)|pendir)|p(?:a(?:rse_(?:ini_file|str)|ssthru)|g_(?:connect|(?:execut|prepar)e|query)|hp(?:_(?:strip_whitespac|unam)e|info|version)|o(?:pen|six_(?:get(?:(?:e[gu]|g)id|login|pwnam)|kill|mk(?:fifo|nod)|ttyname))|r(?:eg_(?:match(?:_all)?|replace(?:_callback(?:_array)?)?|split)|int_r|oc_(?:(?:clos|nic|terminat)e|get_status|open))|utenv)|r(?:awurl(?:de|en)code|e(?:ad(?:_exif_data|dir|(?:gz)?file)|(?:gister_(?:shutdown|tick)|name)_function)|unkit_(?:constant_(?:add|redefine)|(?:function|method)_(?:add|copy|re(?:defin|nam)e)))|s(?:e(?:ssion_s(?:et_save_handler|tart)|t(?:_(?:e(?:rror|xception)_handler|include_path|magic_quotes_runtime)|defaultstub))|h(?:a1_fil|ow_sourc)e|implexml_load_(?:file|string)|ocket_c(?:onnect|reate)|pl_autoload_register|qlite_(?:(?:(?:array|single|unbuffered)_)?query|create_(?:aggregate|function)|exec|p?open)|tr(?:eam_(?:context_create|socket_client)|ipc?slashes|rev)|ystem)|u(?:[ak]?sort|n(?:pack|serialize)|rl(?:de|en)code)|var_dump)(?:/(?:\\*.*\\*/|/.*)|#.*[\\s\\v]|\\")*[\\"'']*\\)?[\\s\\v]*\\(.*\\)" "id:933160,phase:2,block,capture,t:none,msg:''PHP Injection Attack: High-Risk PHP Function Call Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (933170,'PHP Injection Attack: Serialized Object Injection','PHP Injection Attack: Serialized Object Injection','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|ARGS_NAMES|ARGS|XML:/* "@rx [oOcC]:\\d+:\\".+?\\":\\d+:{.*}" "id:933170,phase:2,block,capture,t:none,msg:''PHP Injection Attack: Serialized Object Injection'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (949054,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 3" "id:949054,phase:1,pass,t:none,nolog,setvar:''tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}''"'),
	 (949154,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 3" "id:949154,phase:1,pass,t:none,nolog,setvar:''tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}''"'),
	 (933180,'PHP Injection Attack: Variable Function Call Found','PHP Injection Attack: Variable Function Call Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@rx \\$+(?:[a-zA-Z_\\x7f-\\xff][a-zA-Z0-9_\\x7f-\\xff]*|\\s*{.+})(?:\\s|\\[.+\\]|{.+}|/\\*.*\\*/|//.*|#.*)*\\(.*\\)" "id:933180,phase:2,block,capture,t:none,msg:''PHP Injection Attack: Variable Function Call Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (933210,'PHP Injection Attack: Variable Function Call Found','PHP Injection Attack: Variable Function Call Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@rx (?:\\((?:.+\\)(?:[\\"''][\\-0-9A-Z_a-z]+[\\"''])?\\(.+|[^\\)]*string[^\\)]*\\)[\\s\\v\\"''\\--\\.0-9A-\\[\\]_a-\\{\\}]+\\([^\\)]*)|(?:\\[[0-9]+\\]|\\{[0-9]+\\}|\\$[^\\(-\\),\\.-/;\\x5c]+|[\\"''][\\-0-9A-Z\\x5c_a-z]+[\\"''])\\(.+)\\);" "id:933210,phase:2,block,capture,t:none,t:urlDecode,t:replaceComments,t:removeWhitespace,msg:''PHP Injection Attack: Variable Function Call Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (933013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:933013,phase:1,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"'),
	 (933014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:933014,phase:2,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"'),
	 (933151,'PHP Injection Attack: Medium-Risk PHP Function Name Found','PHP Injection Attack: Medium-Risk PHP Function Name Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@pmFromFile php-function-names-933151.data" "id:933151,phase:2,block,capture,t:none,msg:''PHP Injection Attack: Medium-Risk PHP Function Name Found'',logdata:''Matched Data: %{TX.933151_TX_0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.933151_tx_0=%{tx.0}'',chain"'),
	 (933015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:933015,phase:1,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"'),
	 (933016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:933016,phase:2,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"'),
	 (933131,'PHP Injection Attack: Variables Found','PHP Injection Attack: Variables Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx AUTH_TYPE|HTTP_(?:ACCEPT(?:_(?:CHARSET|ENCODING|LANGUAGE))?|CONNECTION|(?:HOS|USER_AGEN)T|KEEP_ALIVE|(?:REFERE|X_FORWARDED_FO)R)|ORIG_PATH_INFO|PATH_(?:INFO|TRANSLATED)|QUERY_STRING|REQUEST_URI" "id:933131,phase:2,block,capture,t:none,t:normalisePath,t:urlDecodeUni,msg:''PHP Injection Attack: Variables Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (933161,'PHP Injection Attack: Low-Value PHP Function Call Found','PHP Injection Attack: Low-Value PHP Function Call Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\\b(?:a(?:bs|cosh?|r(?:ray|sort)|s(?:inh?|(?:o|se)rt)|tan[2h]?)|b(?:asename|indec)|c(?:eil|h(?:dir|eckdate|mod|o(?:p|wn)|root)|lose(?:dir|log)|o(?:(?:mpac|(?:nsta|u)n)t|py|sh?)|(?:ryp|urren)t)|d(?:ate|e(?:coct|fined?)|i(?:(?:skfreespac)?e|r(?:name)?)|(?:oubleva)?l)|e(?:a(?:ch|ster_da(?:te|ys))|cho|mpty|nd|r(?:egi?|ror_log)|x(?:(?:i|trac)t|p(?:lode)?))|f(?:close|eof|gets|ile(?:owner|pro|(?:siz|typ)e)|l(?:o(?:atval|ck|or)|ush)|(?:mo|rea)d|stat|t(?:ell|ok)|unction)|g(?:et(?:date|t(?:ext|ype))|mdate)|h(?:ash|e(?:ader(?:s_(?:lis|sen)t)?|brev)|ypot)|i(?:conv|(?:dat|mplod)e|n(?:(?:clud|vok)e|t(?:div|val))|s(?:_(?:a(?:rray)?|bool|(?:calla|dou)ble|f(?:inite|loat)|in(?:finite|t(?:eger)?)|l(?:ink|ong)|n(?:an|u(?:ll|meric))|object|re(?:al|source)|s(?:calar|tring))|set))|join|k(?:ey|sort)|l(?:(?:cfirs|sta)t|evenshtein|i(?:nk(?:info)?|st)|o(?:caltime|g(?:1[0p])?)|trim)|m(?:a(?:i[ln]|x)|b(?:ereg|split)|etaphone|hash|i(?:crotime|n)|y?sql)|n(?:atsor|ex)t|o(?:ctdec|penlog|rd)|p(?:a(?:ck|thinfo)|close|i|o[sw]|r(?:ev|intf?))|quotemeta|r(?:an(?:d|ge)|e(?:adlin[ek]|(?:cod|nam|quir)e|set|wind)|ound|sort|trim)|s(?:(?:candi|ubst)r|(?:e(?:rializ|ttyp)|huffl)e|i(?:milar_text|nh?|zeof)|leep|o(?:rt|undex)|p(?:liti?|rintf)|qrt|rand|t(?:at|r(?:coll|(?:le|sp)n))|y(?:mlink|slog))|t(?:a(?:int|nh?)|e(?:mpnam|xtdomain)|ime|ouch|rim)|u(?:cfirst|mask|n(?:iqid|link|(?:se|tain)t)|s(?:leep|ort))|virtual|wordwrap)(?:[\\s\\v]|/(?:\\*.*\\*/|/.*)|#.*)*\\(.*\\)" "id:933161,phase:2,block,capture,t:none,msg:''PHP Injection Attack: Low-Value PHP Function Call Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (933111,'PHP Injection Attack: PHP Script File Upload Found','PHP Injection Attack: PHP Script File Upload Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X.Filename|REQUEST_HEADERS:X-File-Name "@rx .*\\.(?:php\\d*|phtml)\\..*$" "id:933111,phase:2,block,capture,t:none,t:lowercase,msg:''PHP Injection Attack: PHP Script File Upload Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (933190,'PHP Injection Attack: PHP Closing Tag Found','PHP Injection Attack: PHP Closing Tag Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@pm ?>" "id:933190,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''PHP Injection Attack: PHP Closing Tag Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (933211,'PHP Injection Attack: Variable Function Call Found','PHP Injection Attack: Variable Function Call Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@rx (?:\\((?:.+\\)(?:[\\"''][\\-0-9A-Z_a-z]+[\\"''])?\\(.+|[^\\)]*string[^\\)]*\\)[\\s\\v\\"''\\--\\.0-9A-\\[\\]_a-\\{\\}]+\\([^\\)]*)|(?:\\[[0-9]+\\]|\\{[0-9]+\\}|\\$[^\\(-\\),\\.-/;\\x5c]+|[\\"''][\\-0-9A-Z\\x5c_a-z]+[\\"''])\\(.+)\\)(?:;|$)?" "id:933211,phase:2,block,capture,t:none,t:urlDecode,t:replaceComments,t:removeWhitespace,msg:''PHP Injection Attack: Variable Function Call Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-injection-php'',tag:''paranoia-level/3'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.php_injection_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (934100,'Node.js Injection Attack 1/2','Node.js Injection Attack 1/2','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_FILENAME|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx _(?:\\$\\$ND_FUNC\\$\\$_|_js_function)|(?:\\beval|new[\\s\\v]+Function[\\s\\v]*)\\(|String\\.fromCharCode|function\\(\\)\\{|this\\.constructor|module\\.exports=|\\([\\s\\v]*[^0-9A-Z_a-z]child_process[^0-9A-Z_a-z][\\s\\v]*\\)|process(?:\\.(?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?(?:\\.call)?\\(|binding|constructor|env|global|main(?:Module)?|process|require)|\\[[\\"''`](?:(?:a(?:ccess|ppendfile|rgv|vailability)|c(?:aveats|h(?:mod|own)|(?:los|opyfil)e|p|reate(?:read|write)stream)|ex(?:ec(?:file)?|ists)|f(?:ch(?:mod|own)|data(?:sync)?|s(?:tat|ync)|utimes)|inodes|l(?:chmod|ink|stat|utimes)|mkd(?:ir|temp)|open(?:dir)?|r(?:e(?:ad(?:dir|file|link|v)?|name)|m)|s(?:pawn(?:file)?|tat|ymlink)|truncate|u(?:n(?:link|watchfile)|times)|w(?:atchfile|rite(?:file|v)?))(?:sync)?|binding|constructor|env|global|main(?:Module)?|process|require)[\\"''`]\\])|(?:binding|constructor|env|global|main(?:Module)?|process|require)\\[|console(?:\\.(?:debug|error|info|trace|warn)(?:\\.call)?\\(|\\[[\\"''`](?:debug|error|info|trace|warn)[\\"''`]\\])|require(?:\\.(?:resolve(?:\\.call)?\\(|main|extensions|cache)|\\[[\\"''`](?:(?:resolv|cach)e|main|extensions)[\\"''`]\\])" "id:934100,phase:2,block,capture,t:none,t:urlDecodeUni,t:jsDecode,t:removeWhitespace,t:base64Decode,msg:''Node.js Injection Attack 1/2'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-javascript'',tag:''platform-multi'',tag:''attack-rce'',tag:''attack-injection-generic'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',multiMatch,setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (934101,'Node.js Injection Attack 2/2','Node.js Injection Attack 2/2','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_FILENAME|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?:close|exists|fork|(?:ope|spaw)n|re(?:ad|quire)|w(?:atch|rite))[\\s\\v]*\\(" "id:934101,phase:2,block,capture,t:none,t:urlDecodeUni,t:base64Decode,msg:''Node.js Injection Attack 2/2'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-javascript'',tag:''platform-multi'',tag:''attack-rce'',tag:''attack-injection-generic'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',multiMatch,setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (934110,'Possible Server Side Request Forgery (SSRF) Attack: Cloud provider metadata URL in Parameter','Possible Server Side Request Forgery (SSRF) Attack: Cloud provider metadata URL in Parameter','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@pmFromFile ssrf.data" "id:934110,phase:2,block,capture,t:none,msg:''Possible Server Side Request Forgery (SSRF) Attack: Cloud provider metadata URL in Parameter'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-ssrf'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/664'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (934130,'JavaScript Prototype Pollution','JavaScript Prototype Pollution','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?:__proto__|constructor\\s*(?:\\.|\\[)\\s*prototype)" "id:934130,phase:2,block,capture,t:none,t:urlDecodeUni,t:base64Decode,msg:''JavaScript Prototype Pollution'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-javascript'',tag:''platform-multi'',tag:''attack-rce'',tag:''attack-injection-generic'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1/180/77'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',multiMatch,setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (934150,'Ruby Injection Attack','Ruby Injection Attack','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx Process[\\s\\v]*\\.[\\s\\v]*spawn[\\s\\v]*\\(" "id:934150,phase:2,block,capture,t:none,msg:''Ruby Injection Attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-ruby'',tag:''platform-multi'',tag:''attack-rce'',tag:''attack-injection-generic'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (934160,'Node.js DoS attack','Node.js DoS attack','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_FILENAME|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx while[\\s\\v]*\\([\\s\\v\\(]*(?:!+(?:false|null|undefined|NaN|[\\+\\-]?0|\\"{2}|''{2}|`{2})|(?:!!)*(?:(?:t(?:rue|his)|[\\+\\-]?(?:Infinity|[1-9][0-9]*)|new [A-Za-z][0-9A-Z_a-z]*|window|String|(?:Boolea|Functio)n|Object|Array)\\b|\\{.*\\}|\\[.*\\]|\\"[^\\"]+\\"|''[^'']+''|`[^`]+`)).*\\)" "id:934160,phase:2,block,capture,t:none,t:urlDecodeUni,t:base64Decode,t:replaceComments,msg:''Node.js DoS attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-javascript'',tag:''platform-multi'',tag:''attack-rce'',tag:''attack-injection-generic'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',multiMatch,setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (934170,'PHP data scheme attack','PHP data scheme attack','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_FILENAME|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx ^data:(?:(?:\\*|[^!-\\"\\(-\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!-\\"\\(-\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\v]*;[\\s\\v]*(?:charset[\\s\\v]*=[\\s\\v]*\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\"?|(?:[^\\s\\v -\\"\\(-\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]e\\{\\}]|e[^!-\\"\\(-\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!-\\"\\(-\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\v]*=[\\s\\v]*[^!\\(-\\),/:-\\?\\[-\\]\\{\\}]+);?)*(?:[\\s\\v]*,[\\s\\v]*(?:(?:\\*|[^!-\\"\\(-\\),/:-\\?\\[-\\]\\{\\}]+)/(?:\\*|[^!-\\"\\(-\\),/:-\\?\\[-\\]\\{\\}]+)|\\*)(?:[\\s\\v]*;[\\s\\v]*(?:charset[\\s\\v]*=[\\s\\v]*\\"?(?:iso-8859-15?|utf-8|windows-1252)\\b\\"?|(?:[^\\s\\v -\\"\\(-\\),/:-\\?\\[-\\]c\\{\\}]|c(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]h\\{\\}]|h(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]a\\{\\}]|a(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]r\\{\\}]|r(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]s\\{\\}]|s(?:[^!-\\"\\(-\\),/:-\\?\\[-\\]e\\{\\}]|e[^!-\\"\\(-\\),/:-\\?\\[-\\]t\\{\\}]))))))[^!-\\"\\(-\\),/:-\\?\\[-\\]\\{\\}]*[\\s\\v]*=[\\s\\v]*[^!\\(-\\),/:-\\?\\[-\\]\\{\\}]+);?)*)*" "id:934170,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''PHP data scheme attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-ssrf'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (934013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:934013,phase:1,pass,nolog,skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC"'),
	 (934131,'JavaScript Prototype Pollution','JavaScript Prototype Pollution','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx \\[\\s*constructor\\s*\\]" "id:934131,phase:2,block,capture,t:none,t:urlDecodeUni,t:base64Decode,msg:''JavaScript Prototype Pollution'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-javascript'',tag:''platform-multi'',tag:''attack-rce'',tag:''attack-injection-generic'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',multiMatch,setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (934140,'Perl Injection Attack','Perl Injection Attack','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx @\\{.*\\}" "id:934140,phase:2,block,capture,t:none,msg:''Perl Injection Attack'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-perl'',tag:''platform-multi'',tag:''attack-rce'',tag:''attack-injection-generic'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (934015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:934015,phase:1,pass,nolog,skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC"'),
	 (934016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:934016,phase:2,pass,nolog,skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC"'),
	 (934017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:934017,phase:1,pass,nolog,skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC"'),
	 (934018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:934018,phase:2,pass,nolog,skipAfter:END-REQUEST-934-APPLICATION-ATTACK-GENERIC"'),
	 (943011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:943011,phase:1,pass,nolog,skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"'),
	 (943012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:943012,phase:2,pass,nolog,skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"'),
	 (943100,'Possible Session Fixation Attack: Setting Cookie Values in HTML','Possible Session Fixation Attack: Setting Cookie Values in HTML','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i:\\.cookie\\b.*?;\\W*?(?:expires|domain)\\W*?=|\\bhttp-equiv\\W+set-cookie\\b)" "id:943100,phase:2,block,capture,t:none,t:urlDecodeUni,msg:''Possible Session Fixation Attack: Setting Cookie Values in HTML'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-fixation'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/21/593/61'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.session_fixation_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (943110,'Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer','Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS_NAMES "@rx ^(?:jsessionid|aspsessionid|asp\\.net_sessionid|phpsession|phpsessid|weblogicsession|session_id|session-id|cfid|cftoken|cfsid|jservsession|jwsession)$" "id:943110,phase:2,block,capture,t:none,t:lowercase,msg:''Possible Session Fixation Attack: SessionID Parameter Name with Off-Domain Referer'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-fixation'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/21/593/61'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (943120,'Possible Session Fixation Attack: SessionID Parameter Name with No Referer','Possible Session Fixation Attack: SessionID Parameter Name with No Referer','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS_NAMES "@rx ^(?:jsessionid|aspsessionid|asp\\.net_sessionid|phpsession|phpsessid|weblogicsession|session_id|session-id|cfid|cftoken|cfsid|jservsession|jwsession)$" "id:943120,phase:2,block,capture,t:none,t:lowercase,msg:''Possible Session Fixation Attack: SessionID Parameter Name with No Referer'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-fixation'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/21/593/61'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (943013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:943013,phase:1,pass,nolog,skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (943014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:943014,phase:2,pass,nolog,skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"'),
	 (943015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:943015,phase:1,pass,nolog,skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"'),
	 (943016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:943016,phase:2,pass,nolog,skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"'),
	 (943017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:943017,phase:1,pass,nolog,skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"'),
	 (943018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:943018,phase:2,pass,nolog,skipAfter:END-REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION"'),
	 (944011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:944011,phase:1,pass,nolog,skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA"'),
	 (944012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:944012,phase:2,pass,nolog,skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA"'),
	 (944100,'Remote Command Execution: Suspicious Java class detected','Remote Command Execution: Suspicious Java class detected','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* "@rx java\\.lang\\.(?:runtime|processbuilder)" "id:944100,phase:2,block,t:none,t:lowercase,msg:''Remote Command Execution: Suspicious Java class detected'',logdata:''Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/137/6'',tag:''PCI/6.5.2'',tag:''paranoia-level/1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (944110,'Remote Command Execution: Java process spawn (CVE-2017-9805)','Remote Command Execution: Java process spawn (CVE-2017-9805)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* "@rx (?:runtime|processbuilder)" "id:944110,phase:2,block,t:none,t:lowercase,msg:''Remote Command Execution: Java process spawn (CVE-2017-9805)'',logdata:''Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/248'',tag:''PCI/6.5.2'',tag:''paranoia-level/1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"'),
	 (944120,'Remote Command Execution: Java serialization (CVE-2015-4852)','Remote Command Execution: Java serialization (CVE-2015-4852)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* "@rx (?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)" "id:944120,phase:2,block,t:none,t:lowercase,msg:''Remote Command Execution: Java serialization (CVE-2015-4852)'',logdata:''Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/248'',tag:''PCI/6.5.2'',tag:''paranoia-level/1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',chain"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (944130,'Suspicious Java class detected','Suspicious Java class detected','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_FILENAME|REQUEST_HEADERS|XML:/*|XML://@* "@pmFromFile java-classes.data" "id:944130,phase:2,block,t:none,msg:''Suspicious Java class detected'',logdata:''Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/248'',tag:''PCI/6.5.2'',tag:''paranoia-level/1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (944140,'Java Injection Attack: Java Script File Upload Found','Java Injection Attack: Java Script File Upload Found','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X.Filename|REQUEST_HEADERS:X-File-Name "@rx .*\\.(?:jsp|jspx)\\.*$" "id:944140,phase:2,block,capture,t:none,t:lowercase,msg:''Java Injection Attack: Java Script File Upload Found'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-injection-java'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/152/242'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (944150,'Potential Remote Command Execution: Log4j / Log4shell','Potential Remote Command Execution: Log4j / Log4shell','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_LINE|ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|XML:/*|XML://@* "@rx (?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]{0,15}(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)" "id:944150,phase:2,block,t:none,t:urlDecodeUni,t:jsDecode,t:htmlEntityDecode,log,msg:''Potential Remote Command Execution: Log4j / Log4shell'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/137/6'',tag:''PCI/6.5.2'',tag:''paranoia-level/1'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (944013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:944013,phase:1,pass,nolog,skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA"'),
	 (944014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:944014,phase:2,pass,nolog,skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA"'),
	 (944151,'Potential Remote Command Execution: Log4j / Log4shell','Potential Remote Command Execution: Log4j / Log4shell','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_LINE|ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|XML:/*|XML://@* "@rx (?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)(?:[^\\}]*(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)|jndi|ctx)" "id:944151,phase:2,block,t:none,t:urlDecodeUni,t:jsDecode,t:htmlEntityDecode,log,msg:''Potential Remote Command Execution: Log4j / Log4shell'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/137/6'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (944200,'Magic bytes Detected, probable java serialization in use','Magic bytes Detected, probable java serialization in use','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* "@rx \\xac\\xed\\x00\\x05" "id:944200,phase:2,block,msg:''Magic bytes Detected, probable java serialization in use'',logdata:''Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/248'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (949055,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 4" "id:949055,phase:1,pass,t:none,nolog,setvar:''tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}''"'),
	 (944210,'Magic bytes Detected Base64 Encoded, probable java serialization in use','Magic bytes Detected Base64 Encoded, probable java serialization in use','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* "@rx (?:rO0ABQ|KztAAU|Cs7QAF)" "id:944210,phase:2,block,msg:''Magic bytes Detected Base64 Encoded, probable java serialization in use'',logdata:''Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/248'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (944240,'Remote Command Execution: Java serialization (CVE-2015-4852)','Remote Command Execution: Java serialization (CVE-2015-4852)','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* "@rx (?:clonetransformer|forclosure|instantiatefactory|instantiatetransformer|invokertransformer|prototypeclonefactory|prototypeserializationfactory|whileclosure|getproperty|filewriter|xmldecoder)" "id:944240,phase:2,block,t:none,t:lowercase,msg:''Remote Command Execution: Java serialization (CVE-2015-4852)'',logdata:''Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/248'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (944250,'Remote Command Execution: Suspicious Java method detected','Remote Command Execution: Suspicious Java method detected','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* "@rx java\\b.+(?:runtime|processbuilder)" "id:944250,phase:2,block,t:lowercase,msg:''Remote Command Execution: Suspicious Java method detected'',logdata:''Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/248'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (944260,'Remote Command Execution: Malicious class-loading payload','Remote Command Execution: Malicious class-loading payload','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* "@rx (?:class\\.module\\.classLoader\\.resources\\.context\\.parent\\.pipeline|springframework\\.context\\.support\\.FileSystemXmlApplicationContext)" "id:944260,phase:2,block,t:urlDecodeUni,msg:''Remote Command Execution: Malicious class-loading payload'',logdata:''Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/248'',tag:''PCI/6.5.2'',tag:''paranoia-level/2'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (944015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:944015,phase:1,pass,nolog,skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA"'),
	 (944016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:944016,phase:2,pass,nolog,skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA"'),
	 (944300,'Base64 encoded string matched suspicious keyword','Base64 encoded string matched suspicious keyword','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_BODY|REQUEST_HEADERS|XML:/*|XML://@* "@rx (?:cnVudGltZQ|HJ1bnRpbWU|BydW50aW1l|cHJvY2Vzc2J1aWxkZXI|HByb2Nlc3NidWlsZGVy|Bwcm9jZXNzYnVpbGRlcg|Y2xvbmV0cmFuc2Zvcm1lcg|GNsb25ldHJhbnNmb3JtZXI|BjbG9uZXRyYW5zZm9ybWVy|Zm9yY2xvc3VyZQ|GZvcmNsb3N1cmU|Bmb3JjbG9zdXJl|aW5zdGFudGlhdGVmYWN0b3J5|Gluc3RhbnRpYXRlZmFjdG9yeQ|BpbnN0YW50aWF0ZWZhY3Rvcnk|aW5zdGFudGlhdGV0cmFuc2Zvcm1lcg|Gluc3RhbnRpYXRldHJhbnNmb3JtZXI|BpbnN0YW50aWF0ZXRyYW5zZm9ybWVy|aW52b2tlcnRyYW5zZm9ybWVy|Gludm9rZXJ0cmFuc2Zvcm1lcg|BpbnZva2VydHJhbnNmb3JtZXI|cHJvdG90eXBlY2xvbmVmYWN0b3J5|HByb3RvdHlwZWNsb25lZmFjdG9yeQ|Bwcm90b3R5cGVjbG9uZWZhY3Rvcnk|cHJvdG90eXBlc2VyaWFsaXphdGlvbmZhY3Rvcnk|HByb3RvdHlwZXNlcmlhbGl6YXRpb25mYWN0b3J5|Bwcm90b3R5cGVzZXJpYWxpemF0aW9uZmFjdG9yeQ|d2hpbGVjbG9zdXJl|HdoaWxlY2xvc3VyZQ|B3aGlsZWNsb3N1cmU)" "id:944300,phase:2,block,t:none,msg:''Base64 encoded string matched suspicious keyword'',logdata:''Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/248'',tag:''PCI/6.5.2'',tag:''paranoia-level/3'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl3=+%{tx.critical_anomaly_score}''"'),
	 (944017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:944017,phase:1,pass,nolog,skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA"'),
	 (944018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:944018,phase:2,pass,nolog,skipAfter:END-REQUEST-944-APPLICATION-ATTACK-JAVA"'),
	 (944152,'Potential Remote Command Execution: Log4j / Log4shell','Potential Remote Command Execution: Log4j / Log4shell','critical',0,0,300,2,100,true,0,1742288288,0,'SecRule REQUEST_LINE|ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|XML:/*|XML://@* "@rx (?i)(?:\\$|&dollar;?)(?:\\{|&l(?:brace|cub);?)" "id:944152,phase:2,block,t:none,t:urlDecodeUni,t:jsDecode,t:htmlEntityDecode,log,msg:''Potential Remote Command Execution: Log4j / Log4shell'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-rce'',tag:''OWASP_CRS'',tag:''capec/1000/152/137/6'',tag:''PCI/6.5.2'',tag:''paranoia-level/4'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.rce_score=+%{tx.critical_anomaly_score}'',setvar:''tx.inbound_anomaly_score_pl4=+%{tx.critical_anomaly_score}''"'),
	 (949052,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 1" "id:949052,phase:1,pass,t:none,nolog,setvar:''tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}''"'),
	 (949152,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 1" "id:949152,phase:1,pass,t:none,nolog,setvar:''tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl1}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (949161,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 2" "id:949161,phase:2,pass,t:none,nolog,setvar:''tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl2}''"'),
	 (949062,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 3" "id:949062,phase:2,pass,t:none,nolog,setvar:''tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}''"'),
	 (949162,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 3" "id:949162,phase:2,pass,t:none,nolog,setvar:''tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl3}''"'),
	 (949063,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 4" "id:949063,phase:2,pass,t:none,nolog,setvar:''tx.blocking_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}''"'),
	 (949163,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 4" "id:949163,phase:2,pass,t:none,nolog,setvar:''tx.detection_inbound_anomaly_score=+%{tx.inbound_anomaly_score_pl4}''"'),
	 (949111,'Inbound Anomaly Score Exceeded in phase 1 (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})','Inbound Anomaly Score Exceeded in phase 1 (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:BLOCKING_INBOUND_ANOMALY_SCORE "@ge %{tx.inbound_anomaly_score_threshold}" "id:949111,phase:1,deny,t:none,msg:''Inbound Anomaly Score Exceeded in phase 1 (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})'',tag:''anomaly-evaluation'',ver:''OWASP_CRS/4.0.0-rc1'',chain"'),
	 (949110,'Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})','Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:BLOCKING_INBOUND_ANOMALY_SCORE "@ge %{tx.inbound_anomaly_score_threshold}" "id:949110,phase:2,deny,t:none,msg:''Inbound Anomaly Score Exceeded (Total Score: %{TX.BLOCKING_INBOUND_ANOMALY_SCORE})'',tag:''anomaly-evaluation'',ver:''OWASP_CRS/4.0.0-rc1''"'),
	 (949011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:949011,phase:1,pass,nolog,skipAfter:END-REQUEST-949-BLOCKING-EVALUATION"'),
	 (949012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:949012,phase:2,pass,nolog,skipAfter:END-REQUEST-949-BLOCKING-EVALUATION"'),
	 (949013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:949013,phase:1,pass,nolog,skipAfter:END-REQUEST-949-BLOCKING-EVALUATION"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (949014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:949014,phase:2,pass,nolog,skipAfter:END-REQUEST-949-BLOCKING-EVALUATION"'),
	 (949015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:949015,phase:1,pass,nolog,skipAfter:END-REQUEST-949-BLOCKING-EVALUATION"'),
	 (949016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:949016,phase:2,pass,nolog,skipAfter:END-REQUEST-949-BLOCKING-EVALUATION"'),
	 (949017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:949017,phase:1,pass,nolog,skipAfter:END-REQUEST-949-BLOCKING-EVALUATION"'),
	 (949018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:949018,phase:2,pass,nolog,skipAfter:END-REQUEST-949-BLOCKING-EVALUATION"'),
	 (950020,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:950020,phase:3,pass,nolog,skipAfter:END-RESPONSE-950-DATA-LEAKAGES"'),
	 (950021,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:950021,phase:4,pass,nolog,skipAfter:END-RESPONSE-950-DATA-LEAKAGES"'),
	 (950130,'Directory Listing','Directory Listing','error',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?:<(?:TITLE>Index of.*?<H|title>Index of.*?<h)1>Index of|>\\[To Parent Directory\\]</[Aa]><br>)" "id:950130,phase:4,block,capture,t:none,msg:''Directory Listing'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116/54/127'',tag:''PCI/6.5.6'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''ERROR'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}''"'),
	 (950140,'CGI source code leakage','CGI source code leakage','error',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx ^#\\!\\s?/" "id:950140,phase:4,block,capture,t:none,msg:''CGI source code leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116'',tag:''PCI/6.5.6'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''ERROR'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}''"'),
	 (950013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:950013,phase:3,pass,nolog,skipAfter:END-RESPONSE-950-DATA-LEAKAGES"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (950014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:950014,phase:4,pass,nolog,skipAfter:END-RESPONSE-950-DATA-LEAKAGES"'),
	 (950100,'The Application Returned a 500-Level Status Code','The Application Returned a 500-Level Status Code','error',0,0,300,3,400,true,0,1742288288,0,'SecRule RESPONSE_STATUS "@rx ^5\\d{2}$" "id:950100,phase:3,block,capture,t:none,msg:''The Application Returned a 500-Level Status Code'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-multi'',tag:''attack-disclosure'',tag:''PCI/6.5.6'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/152'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''ERROR'',setvar:''tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}''"'),
	 (950015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:950015,phase:3,pass,nolog,skipAfter:END-RESPONSE-950-DATA-LEAKAGES"'),
	 (952011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:952011,phase:3,pass,nolog,skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA"'),
	 (952012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:952012,phase:4,pass,nolog,skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA"'),
	 (952100,'Java Source Code Leakage','Java Source Code Leakage','error',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@pmFromFile java-code-leakages.data" "id:952100,phase:4,block,capture,t:none,msg:''Java Source Code Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116'',tag:''PCI/6.5.6'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''ERROR'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}''"'),
	 (952110,'Java Errors','Java Errors','error',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@pmFromFile java-errors.data" "id:952110,phase:4,block,capture,t:none,msg:''Java Errors'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-java'',tag:''platform-multi'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116'',tag:''PCI/6.5.6'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''ERROR'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}''"'),
	 (952013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:952013,phase:3,pass,nolog,skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA"'),
	 (952014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:952014,phase:4,pass,nolog,skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA"'),
	 (952015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:952015,phase:3,pass,nolog,skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (952016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:952016,phase:4,pass,nolog,skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA"'),
	 (952017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:952017,phase:3,pass,nolog,skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA"'),
	 (952018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:952018,phase:4,pass,nolog,skipAfter:END-RESPONSE-952-DATA-LEAKAGES-JAVA"'),
	 (953011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:953011,phase:3,pass,nolog,skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP"'),
	 (953012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:953012,phase:4,pass,nolog,skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP"'),
	 (953100,'PHP Information Leakage','PHP Information Leakage','error',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@pmFromFile php-errors.data" "id:953100,phase:4,block,capture,t:none,msg:''PHP Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116'',tag:''PCI/6.5.6'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''ERROR'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}''"'),
	 (953110,'PHP source code leakage','PHP source code leakage','error',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?:\\b(?:f(?:tp_(?:nb_)?f?(?:ge|pu)t|get(?:s?s|c)|scanf|write|open|read)|gz(?:(?:encod|writ)e|compress|open|read)|s(?:ession_start|candir)|read(?:(?:gz)?file|dir)|move_uploaded_file|(?:proc_|bz)open|call_user_func)|\\$_(?:(?:pos|ge)t|session))\\b" "id:953110,phase:4,block,capture,t:none,msg:''PHP source code leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116'',tag:''PCI/6.5.6'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''ERROR'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}''"'),
	 (953120,'PHP source code leakage','PHP source code leakage','error',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?i)<\\?(?:=|php)?\\s+" "id:953120,phase:4,block,capture,t:none,msg:''PHP source code leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116'',tag:''PCI/6.5.6'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''ERROR'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}''"'),
	 (953013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:953013,phase:3,pass,nolog,skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP"'),
	 (953014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:953014,phase:4,pass,nolog,skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (953101,'PHP Information Leakage','PHP Information Leakage','error',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@pmFromFile php-errors-pl2.data" "id:953101,phase:4,block,capture,t:none,msg:''PHP Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-php'',tag:''platform-multi'',tag:''attack-disclosure'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/118/116'',tag:''PCI/6.5.6'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''ERROR'',setvar:''tx.outbound_anomaly_score_pl2=+%{tx.error_anomaly_score}''"'),
	 (953015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:953015,phase:3,pass,nolog,skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP"'),
	 (953016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:953016,phase:4,pass,nolog,skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP"'),
	 (953017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:953017,phase:3,pass,nolog,skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP"'),
	 (953018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:953018,phase:4,pass,nolog,skipAfter:END-RESPONSE-953-DATA-LEAKAGES-PHP"'),
	 (954011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:954011,phase:3,pass,nolog,skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS"'),
	 (954012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:954012,phase:4,pass,nolog,skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS"'),
	 (954100,'Disclosure of IIS install location','Disclosure of IIS install location','error',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx [a-z]:\\x5cinetpub\\b" "id:954100,phase:4,block,capture,t:none,t:lowercase,msg:''Disclosure of IIS install location'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-iis'',tag:''platform-windows'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''ERROR'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}''"'),
	 (954110,'Application Availability Error','Application Availability Error','error',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (?:Microsoft OLE DB Provider for SQL Server(?:</font>.{1,20}?error ''800(?:04005|40e31)''.{1,40}?Timeout expired| \\(0x80040e31\\)<br>Timeout expired<br>)|<h1>internal server error</h1>.*?<h2>part of the server has crashed or it has a configuration error\\.</h2>|cannot connect to the server: timed out)" "id:954110,phase:4,block,capture,t:none,msg:''Application Availability Error'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-iis'',tag:''platform-windows'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''PCI/6.5.6'',tag:''OWASP_CRS'',tag:''capec/1000/118/116'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''ERROR'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}''"'),
	 (954120,'IIS Information Leakage','IIS Information Leakage','error',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@pmFromFile iis-errors.data" "id:954120,phase:4,block,capture,t:none,msg:''IIS Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-iis'',tag:''platform-windows'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116'',tag:''PCI/6.5.6'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''ERROR'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.error_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (954130,'IIS Information Leakage','IIS Information Leakage','error',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_STATUS "!@rx ^404$" "id:954130,phase:4,block,capture,t:none,msg:''IIS Information Leakage'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''application-multi'',tag:''language-multi'',tag:''platform-iis'',tag:''platform-windows'',tag:''attack-disclosure'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/118/116'',tag:''PCI/6.5.6'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''ERROR'',chain"'),
	 (954013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:954013,phase:3,pass,nolog,skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS"'),
	 (954014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:954014,phase:4,pass,nolog,skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS"'),
	 (954015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:954015,phase:3,pass,nolog,skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS"'),
	 (954016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:954016,phase:4,pass,nolog,skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS"'),
	 (954017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:954017,phase:3,pass,nolog,skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS"'),
	 (954018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:954018,phase:4,pass,nolog,skipAfter:END-RESPONSE-954-DATA-LEAKAGES-IIS"'),
	 (955011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:955011,phase:3,pass,nolog,skipAfter:END-RESPONSE-955-WEB-SHELLS"'),
	 (955012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:955012,phase:4,pass,nolog,skipAfter:END-RESPONSE-955-WEB-SHELLS"'),
	 (955100,'Web shell detected','Web shell detected','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@pmFromFile web-shells-php.data" "id:955100,phase:4,block,capture,t:none,msg:''Web shell detected'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (955110,'r57 web shell','r57 web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx (<title>r57 Shell Version [0-9.]+</title>|<title>r57 shell</title>)" "id:955110,phase:4,block,capture,t:none,msg:''r57 web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955120,'WSO web shell','WSO web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx ^<html><head><meta http-equiv=''Content-Type'' content=''text/html; charset=Windows-1251''><title>.*? - WSO [0-9.]+</title>" "id:955120,phase:4,block,capture,t:none,msg:''WSO web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955130,'b4tm4n web shell','b4tm4n web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx B4TM4N SH3LL</title>.*<meta name=''author'' content=''k4mpr3t''/>" "id:955130,phase:4,block,capture,t:none,msg:''b4tm4n web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955140,'Mini Shell web shell','Mini Shell web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx <title>Mini Shell</title>.*Developed By LameHacker" "id:955140,phase:4,block,capture,t:none,msg:''Mini Shell web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955150,'Ashiyane web shell','Ashiyane web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx <title>\\.:: .* ~ Ashiyane V [0-9.]+ ::\\.</title>" "id:955150,phase:4,block,capture,t:none,msg:''Ashiyane web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955160,'Symlink_Sa web shell','Symlink_Sa web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx <title>Symlink_Sa [0-9.]+</title>" "id:955160,phase:4,block,capture,t:none,msg:''Symlink_Sa web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955170,'CasuS web shell','CasuS web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx <title>CasuS [0-9.]+ by MafiABoY</title>" "id:955170,phase:4,block,capture,t:none,msg:''CasuS web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955180,'GRP WebShell','GRP WebShell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx ^<html>\\r\\n<head>\\r\\n<title>GRP WebShell [0-9.]+ " "id:955180,phase:4,block,capture,t:none,msg:''GRP WebShell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955190,'NGHshell web shell','NGHshell web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx <small>NGHshell [0-9.]+ by Cr4sh</body></html>\\n$" "id:955190,phase:4,block,capture,t:none,msg:''NGHshell web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955200,'SimAttacker web shell','SimAttacker web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx <title>SimAttacker - (?:Version|Vrsion) : [0-9.]+ - " "id:955200,phase:4,block,capture,t:none,msg:''SimAttacker web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (955210,'Unknown web shell','Unknown web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx ^<!DOCTYPE html>\\n<html>\\n<!-- By Artyum .*<title>Web Shell</title>" "id:955210,phase:4,block,capture,t:none,msg:''Unknown web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955220,'lama\\''s\\''hell web shell','lama\\''s\\''hell web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx <title>lama''s''hell v. [0-9.]+</title>" "id:955220,phase:4,block,capture,t:none,msg:''lama\\''s\\''hell web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955230,'lostDC web shell','lostDC web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx ^ *<html>\\n[ ]+<head>\\n[ ]+<title>lostDC - " "id:955230,phase:4,block,capture,t:none,msg:''lostDC web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955240,'Unknown web shell','Unknown web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx ^<title>PHP Web Shell</title>\\r\\n<html>\\r\\n<body>\\r\\n    <!-- Replaces command with Base64-encoded Data -->" "id:955240,phase:4,block,capture,t:none,msg:''Unknown web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955250,'Unknown web shell','Unknown web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx ^<html>\\n<head>\\n<div align=\\"left\\"><font size=\\"1\\">Input command :</font></div>\\n<form name=\\"cmd\\" method=\\"POST\\" enctype=\\"multipart/form-data\\">" "id:955250,phase:4,block,capture,t:none,msg:''Unknown web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955260,'Ru24PostWebShell web shell','Ru24PostWebShell web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx ^<html>\\n<head>\\n<title>Ru24PostWebShell - " "id:955260,phase:4,block,capture,t:none,msg:''Ru24PostWebShell web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955270,'s72 Shell web shell','s72 Shell web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx <title>s72 Shell v[0-9.]+ Codinf by Cr@zy_King</title>" "id:955270,phase:4,block,capture,t:none,msg:''s72 Shell web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955280,'PhpSpy web shell','PhpSpy web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx ^<html>\\r\\n<head>\\r\\n<meta http-equiv=\\"Content-Type\\" content=\\"text/html; charset=gb2312\\">\\r\\n<title>PhpSpy Ver [0-9]+</title>" "id:955280,phase:4,block,capture,t:none,msg:''PhpSpy web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955290,'g00nshell web shell','g00nshell web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx ^ <html>\\n\\n<head>\\n\\n<title>g00nshell v[0-9.]+ " "id:955290,phase:4,block,capture,t:none,msg:''g00nshell web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955300,'PuNkHoLic shell web shell','PuNkHoLic shell web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@contains <title>punkholicshell</title>" "id:955300,phase:4,block,capture,t:none,t:removeWhitespace,t:lowercase,msg:''PuNkHoLic shell web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (955310,'azrail web shell','azrail web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx ^<html>\\n      <head>\\n             <title>azrail [0-9.]+ by C-W-M</title>" "id:955310,phase:4,block,capture,t:none,msg:''azrail web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955320,'SmEvK_PaThAn Shell web shell','SmEvK_PaThAn Shell web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx >SmEvK_PaThAn Shell v[0-9]+ coded by <a href=" "id:955320,phase:4,block,capture,t:none,msg:''SmEvK_PaThAn Shell web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955330,'Shell I web shell','Shell I web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx ^<html>\\n<title>.*? ~ Shell I</title>\\n<head>\\n<style>" "id:955330,phase:4,block,capture,t:none,msg:''Shell I web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955340,'b374k m1n1 web shell','b374k m1n1 web shell','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@rx ^ <html><head><title>:: b374k m1n1 [0-9.]+ ::</title>" "id:955340,phase:4,block,capture,t:none,msg:''b374k m1n1 web shell'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/1'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl1=+%{tx.critical_anomaly_score}''"'),
	 (955013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:955013,phase:3,pass,nolog,skipAfter:END-RESPONSE-955-WEB-SHELLS"'),
	 (955014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:955014,phase:4,pass,nolog,skipAfter:END-RESPONSE-955-WEB-SHELLS"'),
	 (955350,'webadmin.php file manager','webadmin.php file manager','critical',0,0,300,4,400,true,0,1742288288,0,'SecRule RESPONSE_BODY "@contains <h1 style=\\"margin-bottom: 0\\">webadmin.php</h1>" "id:955350,phase:4,block,capture,t:none,msg:''webadmin.php file manager'',logdata:''Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}'',tag:''language-php'',tag:''platform-multi'',tag:''attack-rce'',tag:''paranoia-level/2'',tag:''OWASP_CRS'',tag:''capec/1000/225/122/17/650'',ver:''OWASP_CRS/4.0.0-rc1'',severity:''CRITICAL'',setvar:''tx.outbound_anomaly_score_pl2=+%{tx.critical_anomaly_score}''"'),
	 (955015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:955015,phase:3,pass,nolog,skipAfter:END-RESPONSE-955-WEB-SHELLS"'),
	 (955016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:955016,phase:4,pass,nolog,skipAfter:END-RESPONSE-955-WEB-SHELLS"'),
	 (955017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:955017,phase:3,pass,nolog,skipAfter:END-RESPONSE-955-WEB-SHELLS"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (955018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:955018,phase:4,pass,nolog,skipAfter:END-RESPONSE-955-WEB-SHELLS"'),
	 (959052,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 1" "id:959052,phase:3,pass,t:none,nolog,setvar:''tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}''"'),
	 (959152,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 1" "id:959152,phase:3,pass,t:none,nolog,setvar:''tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}''"'),
	 (959053,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 2" "id:959053,phase:3,pass,t:none,nolog,setvar:''tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}''"'),
	 (959153,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 2" "id:959153,phase:3,pass,t:none,nolog,setvar:''tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}''"'),
	 (959054,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 3" "id:959054,phase:3,pass,t:none,nolog,setvar:''tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}''"'),
	 (959154,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 3" "id:959154,phase:3,pass,t:none,nolog,setvar:''tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}''"'),
	 (959055,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 4" "id:959055,phase:3,pass,t:none,nolog,setvar:''tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}''"'),
	 (959155,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 4" "id:959155,phase:3,pass,t:none,nolog,setvar:''tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}''"'),
	 (959059,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecAction "id:959059,phase:4,pass,t:none,nolog,setvar:''tx.blocking_outbound_anomaly_score=0''"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (959159,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecAction "id:959159,phase:4,pass,t:none,nolog,setvar:''tx.detection_outbound_anomaly_score=0''"'),
	 (959060,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 1" "id:959060,phase:4,pass,t:none,nolog,setvar:''tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}''"'),
	 (959160,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 1" "id:959160,phase:4,pass,t:none,nolog,setvar:''tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl1}''"'),
	 (959061,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 2" "id:959061,phase:4,pass,t:none,nolog,setvar:''tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}''"'),
	 (959161,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 2" "id:959161,phase:4,pass,t:none,nolog,setvar:''tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl2}''"'),
	 (959062,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 3" "id:959062,phase:4,pass,t:none,nolog,setvar:''tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}''"'),
	 (959162,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 3" "id:959162,phase:4,pass,t:none,nolog,setvar:''tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl3}''"'),
	 (959063,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:BLOCKING_PARANOIA_LEVEL "@ge 4" "id:959063,phase:4,pass,t:none,nolog,setvar:''tx.blocking_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}''"'),
	 (959163,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@ge 4" "id:959163,phase:4,pass,t:none,nolog,setvar:''tx.detection_outbound_anomaly_score=+%{tx.outbound_anomaly_score_pl4}''"'),
	 (959101,'Outbound Anomaly Score Exceeded in phase 3 (Total Score: %{tx.blocking_outbound_anomaly_score})','Outbound Anomaly Score Exceeded in phase 3 (Total Score: %{tx.blocking_outbound_anomaly_score})','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:BLOCKING_OUTBOUND_ANOMALY_SCORE "@ge %{tx.outbound_anomaly_score_threshold}" "id:959101,phase:3,deny,t:none,msg:''Outbound Anomaly Score Exceeded in phase 3 (Total Score: %{tx.blocking_outbound_anomaly_score})'',tag:''anomaly-evaluation'',ver:''OWASP_CRS/4.0.0-rc1'',chain"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (959100,'Outbound Anomaly Score Exceeded (Total Score: %{tx.blocking_outbound_anomaly_score})','Outbound Anomaly Score Exceeded (Total Score: %{tx.blocking_outbound_anomaly_score})','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:BLOCKING_OUTBOUND_ANOMALY_SCORE "@ge %{tx.outbound_anomaly_score_threshold}" "id:959100,phase:4,deny,t:none,msg:''Outbound Anomaly Score Exceeded (Total Score: %{tx.blocking_outbound_anomaly_score})'',tag:''anomaly-evaluation'',ver:''OWASP_CRS/4.0.0-rc1''"'),
	 (959011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:959011,phase:3,pass,nolog,skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION"'),
	 (959012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:959012,phase:4,pass,nolog,skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION"'),
	 (959013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:959013,phase:3,pass,nolog,skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION"'),
	 (959014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:959014,phase:4,pass,nolog,skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION"'),
	 (959015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:959015,phase:3,pass,nolog,skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION"'),
	 (959016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:959016,phase:4,pass,nolog,skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION"'),
	 (959017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,3,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:959017,phase:3,pass,nolog,skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION"'),
	 (959018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,4,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:959018,phase:4,pass,nolog,skipAfter:END-RESPONSE-959-BLOCKING-EVALUATION"'),
	 (1952661584305242112,'','cc规则辅助waf规则 验证码','',1949777497425301504,1,1,68719476736,300,true,1925392944145367040,1754385775,0,'');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (980099,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,5,400,true,0,1742288288,0,'SecAction "id:980099,phase:5,pass,t:none,nolog,noauditlog,ver:''OWASP_CRS/4.0.0-rc1'',setvar:''tx.blocking_anomaly_score=%{tx.blocking_inbound_anomaly_score}'',setvar:''tx.blocking_anomaly_score=+%{tx.blocking_outbound_anomaly_score}'',setvar:''tx.detection_anomaly_score=%{tx.detection_inbound_anomaly_score}'',setvar:''tx.detection_anomaly_score=+%{tx.detection_outbound_anomaly_score}'',setvar:''tx.anomaly_score=%{tx.blocking_inbound_anomaly_score}'',setvar:''tx.anomaly_score=+%{tx.blocking_outbound_anomaly_score}''"'),
	 (980041,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,5,400,true,0,1742288288,0,'SecRule TX:REPORTING_LEVEL "@eq 0" "id:980041,phase:5,pass,nolog,skipAfter:END-REPORTING"'),
	 (980042,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,5,400,true,0,1742288288,0,'SecRule TX:REPORTING_LEVEL "@ge 5" "id:980042,phase:5,pass,nolog,skipAfter:LOG-REPORTING"'),
	 (980043,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,5,400,true,0,1742288288,0,'SecRule TX:DETECTION_ANOMALY_SCORE "@eq 0" "id:980043,phase:5,pass,nolog,skipAfter:END-REPORTING"'),
	 (980044,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,5,400,true,0,1742288288,0,'SecRule TX:BLOCKING_INBOUND_ANOMALY_SCORE "@ge %{tx.inbound_anomaly_score_threshold}" "id:980044,phase:5,pass,nolog,skipAfter:LOG-REPORTING"'),
	 (980045,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,5,400,true,0,1742288288,0,'SecRule TX:BLOCKING_OUTBOUND_ANOMALY_SCORE "@ge %{tx.outbound_anomaly_score_threshold}" "id:980045,phase:5,pass,nolog,skipAfter:LOG-REPORTING"'),
	 (980046,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,5,400,true,0,1742288288,0,'SecRule TX:REPORTING_LEVEL "@lt 2" "id:980046,phase:5,pass,nolog,skipAfter:END-REPORTING"'),
	 (980047,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,5,400,true,0,1742288288,0,'SecRule TX:DETECTION_INBOUND_ANOMALY_SCORE "@ge %{tx.inbound_anomaly_score_threshold}" "id:980047,phase:5,pass,nolog,skipAfter:LOG-REPORTING"'),
	 (980048,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,5,400,true,0,1742288288,0,'SecRule TX:DETECTION_OUTBOUND_ANOMALY_SCORE "@ge %{tx.outbound_anomaly_score_threshold}" "id:980048,phase:5,pass,nolog,skipAfter:LOG-REPORTING"'),
	 (980049,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,5,400,true,0,1742288288,0,'SecRule TX:REPORTING_LEVEL "@lt 3" "id:980049,phase:5,pass,nolog,skipAfter:END-REPORTING"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (980050,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,5,400,true,0,1742288288,0,'SecRule TX:BLOCKING_ANOMALY_SCORE "@gt 0" "id:980050,phase:5,pass,nolog,skipAfter:LOG-REPORTING"'),
	 (980051,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,5,400,true,0,1742288288,0,'SecRule TX:REPORTING_LEVEL "@lt 4" "id:980051,phase:5,pass,nolog,skipAfter:END-REPORTING"'),
	 (980170,'Anomaly Scores: (Inbound Scores: blocking=%{tx.blocking_inbound_anomaly_score}, detection=%{tx.detection_inbound_anomaly_score}, per_pl=%{tx.inbound_anomaly_score_pl1}-%{tx.inbound_anomaly_score_pl2}-%{tx.inbound_anomaly_score_pl3}-%{tx.inbound_anomaly_sco','Anomaly Scores: (Inbound Scores: blocking=%{tx.blocking_inbound_anomaly_score}, detection=%{tx.detection_inbound_anomaly_score}, per_pl=%{tx.inbound_anomaly_score_pl1}-%{tx.inbound_anomaly_score_pl2}-%{tx.inbound_anomaly_score_pl3}-%{tx.inbound_anomaly_score_pl4}, threshold=%{tx.inbound_anomaly_score_threshold}) - (Outbound Scores: blocking=%{tx.blocking_outbound_anomaly_score}, detection=%{tx.detection_outbound_anomaly_score}, per_pl=%{tx.outbound_anomaly_score_pl1}-%{tx.outbound_anomaly_score_pl2}-%{tx.outbound_anomaly_score_pl3}-%{tx.outbound_anomaly_score_pl4}, threshold=%{tx.outbound_anomaly_score_threshold}) - (SQLI=%{tx.sql_injection_score}, XSS=%{tx.xss_score}, RFI=%{tx.rfi_score}, LFI=%{tx.lfi_score}, RCE=%{tx.rce_score}, PHPI=%{tx.php_injection_score}, HTTP=%{tx.http_violation_score}, SESS=%{tx.session_fixation_score}, COMBINED_SCORE=%{tx.anomaly_score})','emergency',0,0,300,5,400,true,0,1742288288,0,'SecAction "id:980170,phase:5,pass,t:none,noauditlog,msg:''Anomaly Scores: (Inbound Scores: blocking=%{tx.blocking_inbound_anomaly_score}, detection=%{tx.detection_inbound_anomaly_score}, per_pl=%{tx.inbound_anomaly_score_pl1}-%{tx.inbound_anomaly_score_pl2}-%{tx.inbound_anomaly_score_pl3}-%{tx.inbound_anomaly_score_pl4}, threshold=%{tx.inbound_anomaly_score_threshold}) - (Outbound Scores: blocking=%{tx.blocking_outbound_anomaly_score}, detection=%{tx.detection_outbound_anomaly_score}, per_pl=%{tx.outbound_anomaly_score_pl1}-%{tx.outbound_anomaly_score_pl2}-%{tx.outbound_anomaly_score_pl3}-%{tx.outbound_anomaly_score_pl4}, threshold=%{tx.outbound_anomaly_score_threshold}) - (SQLI=%{tx.sql_injection_score}, XSS=%{tx.xss_score}, RFI=%{tx.rfi_score}, LFI=%{tx.lfi_score}, RCE=%{tx.rce_score}, PHPI=%{tx.php_injection_score}, HTTP=%{tx.http_violation_score}, SESS=%{tx.session_fixation_score}, COMBINED_SCORE=%{tx.anomaly_score})'',tag:''reporting'',ver:''OWASP_CRS/4.0.0-rc1''"'),
	 (980011,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:980011,phase:1,pass,nolog,skipAfter:END-RESPONSE-980-CORRELATION"'),
	 (980012,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 1" "id:980012,phase:2,pass,nolog,skipAfter:END-RESPONSE-980-CORRELATION"'),
	 (980013,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:980013,phase:1,pass,nolog,skipAfter:END-RESPONSE-980-CORRELATION"'),
	 (980014,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 2" "id:980014,phase:2,pass,nolog,skipAfter:END-RESPONSE-980-CORRELATION"'),
	 (980015,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:980015,phase:1,pass,nolog,skipAfter:END-RESPONSE-980-CORRELATION"'),
	 (980016,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 3" "id:980016,phase:2,pass,nolog,skipAfter:END-RESPONSE-980-CORRELATION"'),
	 (980017,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,1,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:980017,phase:1,pass,nolog,skipAfter:END-RESPONSE-980-CORRELATION"');
INSERT INTO waf_default_rules (id,name,description,level,app_id,rule_type,vuln_id,hit_value,action,is_enabled,user_id,update_time,category,raw) VALUES
	 (980018,'SQL ATTACK','SQL ATTACK','emergency',0,0,300,2,400,true,0,1742288288,0,'SecRule TX:DETECTION_PARANOIA_LEVEL "@lt 4" "id:980018,phase:2,pass,nolog,skipAfter:END-RESPONSE-980-CORRELATION"');
UNLOCK TABLES;


/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2025-04-12 11:50:54
